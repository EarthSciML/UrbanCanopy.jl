<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Hydrology · UrbanCanopy.jl</title><meta name="title" content="Hydrology · UrbanCanopy.jl"/><meta property="og:title" content="Hydrology · UrbanCanopy.jl"/><meta property="twitter:title" content="Hydrology · UrbanCanopy.jl"/><meta name="description" content="Documentation for UrbanCanopy.jl."/><meta property="og:description" content="Documentation for UrbanCanopy.jl."/><meta property="twitter:description" content="Documentation for UrbanCanopy.jl."/><meta property="og:url" content="https://urbancanopy.earthsci.dev/hydrology/"/><meta property="twitter:url" content="https://urbancanopy.earthsci.dev/hydrology/"/><link rel="canonical" href="https://urbancanopy.earthsci.dev/hydrology/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">UrbanCanopy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../clmu_introduction/">CLMU Introduction</a></li><li><a class="tocitem" href="../offline_mode/">Offline Mode</a></li><li><a class="tocitem" href="../albedos_radiative_fluxes/">Albedos and Radiative Fluxes</a></li><li><a class="tocitem" href="../heat_momentum_fluxes/">Heat and Momentum Fluxes</a></li><li><a class="tocitem" href="../roof_wall_road_snow_temperatures/">Roof, Wall, Road, Snow Temperatures</a></li><li class="is-active"><a class="tocitem" href>Hydrology</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Hydrology</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Hydrology</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/main/docs/src/hydrology.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Hydrology"><a class="docs-heading-anchor" href="#Hydrology">Hydrology</a><a id="Hydrology-1"></a><a class="docs-heading-anchor-permalink" href="#Hydrology" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>Chapter 5 of the CLMU technical note describes the hydrological processes simulated for the pervious road, roof, and impervious road surfaces. The hydrology for the pervious road follows CLM4 for bare soil surfaces and includes:</p><ul><li>Snow accumulation and melt, water transfer between snow layers</li><li>Infiltration, evaporation, surface runoff</li><li>Sub-surface drainage, redistribution within the soil column</li><li>Groundwater discharge and recharge</li></ul><p>The roof and impervious road are hydrologically inactive except for their limited capacity to intercept, store (1 kg m<span>$^{-2}$</span>), and evaporate liquid precipitation and snow. Sunlit and shaded walls are hydrologically inactive.</p><p>The implementation is split into modular components covering: snow density, ice/water content in snow, snow compaction, snow layer combination, soil hydraulic properties, surface runoff and infiltration, soil water flux, equilibrium soil moisture, groundwater drainage, water table depth, aquifer water balance, snow capping runoff, surface layer updates, and water balance equations for pervious and impervious surfaces.</p><p><strong>Reference</strong>: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp. Chapter 5: Hydrology (pp. 110-146).</p><article><details class="docstring" open="true"><summary id="UrbanCanopy.SnowDensity"><a class="docstring-binding" href="#UrbanCanopy.SnowDensity"><code>UrbanCanopy.SnowDensity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SnowDensity(; name=:SnowDensity)</code></pre><p>Computes the bulk density of newly fallen snow as a function of atmospheric temperature, following Anderson (1976) as parameterized in Eq. 5.10 of Oleson et al. (2010).</p><p>The density depends on the atmospheric temperature relative to freezing:</p><ul><li>When T<em>atm &gt; T</em>f + 2 K: ρ_sno = 50 + 1.7(17)^1.5</li><li>When T<em>f - 15 &lt; T</em>atm ≤ T<em>f + 2: ρ</em>sno = 50 + 1.7(T<em>atm - T</em>f + 15)^1.5</li><li>When T<em>atm ≤ T</em>f - 15: ρ_sno = 50</li></ul><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Eq. 5.10, p. 115.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L11-L24">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SnowIceContent"><a class="docstring-binding" href="#UrbanCanopy.SnowIceContent"><code>UrbanCanopy.SnowIceContent</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SnowIceContent(; name=:SnowIceContent)</code></pre><p>Computes the conservation of ice mass in snow layers and new snowfall accumulation, following Section 5.1.1 of Oleson et al. (2010).</p><p>This component handles:</p><ul><li>New snow depth rate from solid precipitation and snow density (derived from Eq. 5.9)</li><li>Top layer ice content update from precipitation and frost/sublimation (Eqs. 5.12, 5.14)</li></ul><p>The paper&#39;s Eq. 5.9 is Δz<em>sno = q</em>grnd,ice·Δt / ρ<em>sno, which is a per-timestep increment. For continuous modeling we express this as a rate: dz</em>sno/dt = q<em>grnd,ice / ρ</em>sno [m/s].</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.1.1, Eqs. 5.6–5.14, pp. 114–115.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L64-L78">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SnowWaterContent"><a class="docstring-binding" href="#UrbanCanopy.SnowWaterContent"><code>UrbanCanopy.SnowWaterContent</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SnowWaterContent(; name=:SnowWaterContent)</code></pre><p>Computes the flow of liquid water through snow layers, following Section 5.1.2 of Oleson et al. (2010).</p><p>The water flow between layers (Eq. 5.18) depends on the volumetric water and ice contents, with an irreducible water saturation S_r = 0.033 representing capillary retention. The flow is limited by the effective porosity of the underlying layer (Eq. 5.21).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.1.2, Eqs. 5.15–5.22, pp. 116–117.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L106-L118">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SnowCompaction"><a class="docstring-binding" href="#UrbanCanopy.SnowCompaction"><code>UrbanCanopy.SnowCompaction</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SnowCompaction(; name=:SnowCompaction)</code></pre><p>Computes the total fractional compaction rate of snow layers, following Section 5.1.4 of Oleson et al. (2010).</p><p>Snow compaction includes three processes:</p><ol><li>Destructive metamorphism (Eq. 5.26) - temperature dependent crystal breakdown</li><li>Overburden pressure (Eq. 5.28) - compression from weight of overlying snow</li><li>Melt-induced compaction (Eq. 5.31) - changes due to melt-freeze cycles</li></ol><p>Compaction is not allowed if the layer is saturated (Eq. 5.25) or if ice content is below a minimum value (w_ice,i ≤ 0.1 kg/m²).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.1.4, Eqs. 5.24–5.33, pp. 118–120.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L158-L173">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SnowLayerCombination"><a class="docstring-binding" href="#UrbanCanopy.SnowLayerCombination"><code>UrbanCanopy.SnowLayerCombination</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SnowLayerCombination(; name=:SnowLayerCombination)</code></pre><p>Computes the combined properties when two snow layers are merged, following Section 5.1.5.1 of Oleson et al. (2010).</p><p>When two snow layers are combined, their thicknesses, water contents, and temperatures are merged according to conservation principles (Eqs. 5.38–5.42).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.1.5.1, Eqs. 5.38–5.42, pp. 122.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L242-L252">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SoilHydraulicProperties"><a class="docstring-binding" href="#UrbanCanopy.SoilHydraulicProperties"><code>UrbanCanopy.SoilHydraulicProperties</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SoilHydraulicProperties(; name=:SoilHydraulicProperties)</code></pre><p>Computes the hydraulic properties of soil layers for the pervious road, following Section 5.3.1 of Oleson et al. (2010).</p><p>Properties computed based on Clapp and Hornberger (1978) and Cosby et al. (1984):</p><ul><li>Saturated hydraulic conductivity k_sat (Eq. 5.70)</li><li>Porosity θ_sat (Eq. 5.71)</li><li>Clapp-Hornberger exponent B (Eq. 5.72)</li><li>Soil matric potential ψ (Eq. 5.73)</li><li>Saturated soil matric potential ψ_sat (Eq. 5.74)</li></ul><p>Urban soils are assumed to have no organic matter, so simplified forms are used. All values converted to SI units (m, m/s) from the paper&#39;s mm units.</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.3.1, Eqs. 5.69–5.74, pp. 131.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L304-L321">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SurfaceRunoffInfiltration"><a class="docstring-binding" href="#UrbanCanopy.SurfaceRunoffInfiltration"><code>UrbanCanopy.SurfaceRunoffInfiltration</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SurfaceRunoffInfiltration(; name=:SurfaceRunoffInfiltration)</code></pre><p>Computes surface runoff and infiltration for the pervious road, following Section 5.2 of Oleson et al. (2010).</p><p>Implements the SIMTOP-based (Niu et al., 2005) runoff model (Eq. 5.49), fractional saturated area (Eq. 5.50), impermeable fraction from frozen soil (Eq. 5.51), and maximum infiltration capacity (Eq. 5.52).</p><p>All hydraulic properties are in SI units (m, m/s). The conversion between kg/(m²·s) water flux and m/s uses ρ<em>liq: 1 kg/(m²·s) = 1/ρ</em>liq m/s.</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.2, Eqs. 5.47–5.58, pp. 124–128.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L369-L383">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SoilWaterFlux"><a class="docstring-binding" href="#UrbanCanopy.SoilWaterFlux"><code>UrbanCanopy.SoilWaterFlux</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SoilWaterFlux(; name=:SoilWaterFlux)</code></pre><p>Computes the soil water flux between two adjacent soil layers using the modified Darcy&#39;s law following Zeng and Decker (2009), as described in Section 5.3.2 of Oleson et al. (2010).</p><p>The flux is computed as Eq. 5.67:   q = -k[z<em>h] * [(ψ</em>i - ψ<em>{i+1}) + (ψ</em>{E,i+1} - ψ<em>{E,i})] / (z</em>{i+1} - z_i)</p><p>All lengths and hydraulic properties in SI units (m, m/s).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.3.2, Eqs. 5.87–5.88, p. 135.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L457-L470">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SoilWaterEquilibrium"><a class="docstring-binding" href="#UrbanCanopy.SoilWaterEquilibrium"><code>UrbanCanopy.SoilWaterEquilibrium</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SoilWaterEquilibrium(; name=:SoilWaterEquilibrium)</code></pre><p>Computes the equilibrium soil matric potential and volumetric water content following Section 5.3.2.1 of Oleson et al. (2010).</p><p>The equilibrium state represents the hydrostatic distribution of soil moisture above the water table (Eqs. 5.98–5.106).</p><p>All lengths in SI units (m).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.3.2.1, Eqs. 5.98–5.106, pp. 136–138.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L496-L508">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.RichardsEquation"><a class="docstring-binding" href="#UrbanCanopy.RichardsEquation"><code>UrbanCanopy.RichardsEquation</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">RichardsEquation(; name=:RichardsEquation, N_layers=10, Δz_total=2.0, pct_sand=50.0, pct_clay=20.0, θ_top_val=0.2, θ_bottom_val=0.2, θ_init_val=0.2)</code></pre><p>Implements Richards&#39; equation (Eq. 5.59) for vertical soil water movement using MethodOfLines.jl for automatic spatial discretization.</p><p>The governing PDE is (Eq. 5.68), written in diffusivity form:     ∂θ/∂t = ∂/∂z [D(θ) ∂θ/∂z] + ∂K(θ)/∂z</p><p>where D(θ) = K(θ)|dψ/dθ| is the soil water diffusivity combining the Clapp-Hornberger hydraulic conductivity (Eq. 5.69) and matric potential (Eq. 5.73), and ∂K/∂z is the gravity drainage term. Here z is positive downward (depth into soil).</p><p>Soil hydraulic properties follow Clapp and Hornberger (1978):</p><ul><li>K(θ) = k<em>sat · (θ/θ</em>sat)^(2B+3)   (Eq. 5.69)</li><li>ψ(θ) = ψ<em>sat · (θ/θ</em>sat)^(-B)      (Eq. 5.73)</li></ul><p>The diffusivity simplifies to:     D(θ) = k<em>sat · B · |ψ</em>sat| / θ<em>sat · (θ/θ</em>sat)^(B+2)</p><p>Boundary conditions:</p><ul><li>Top (z=0): Dirichlet BC θ = θ_top (surface water content)</li><li>Bottom (z=Δz<em>total): Dirichlet BC θ = θ</em>bottom (deep soil water content)</li></ul><p>Returns a named tuple <code>(; prob, θ, t_pde, z_var, k_sat_val, θ_sat_val, B_val, ψ_sat_val)</code> containing the discretized ODE problem and symbolic variables.</p><p>Note: This function does not use <code>@component</code> because MethodOfLines.jl&#39;s <code>discretize()</code> returns an <code>ODEProblem</code> rather than a ModelingToolkit <code>System</code>. The PDE discretization paradigm requires working directly with the generated ODE problem.</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Eqs. 5.59, 5.68–5.74, pp. 127–138.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L562-L596">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.GroundwaterDrainage"><a class="docstring-binding" href="#UrbanCanopy.GroundwaterDrainage"><code>UrbanCanopy.GroundwaterDrainage</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">GroundwaterDrainage(; name=:GroundwaterDrainage)</code></pre><p>Computes sub-surface drainage for the pervious road based on the SIMTOP scheme, following Section 5.4 of Oleson et al. (2010).</p><p>Drainage is computed as an exponential function of water table depth (Eq. 5.140), modified by a frozen soil impermeable fraction (Eq. 5.141). Drainage is restricted in frozen soils where ice content exceeds liquid water content (Eq. 5.139).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.4, Eqs. 5.138–5.141, pp. 141–142.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L686-L697">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.WaterTableDepth"><a class="docstring-binding" href="#UrbanCanopy.WaterTableDepth"><code>UrbanCanopy.WaterTableDepth</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">WaterTableDepth(; name=:WaterTableDepth)</code></pre><p>Computes the water table depth from aquifer water storage, following Section 5.4 of Oleson et al. (2010).</p><p>When the water table is below the soil column, the depth is computed from the aquifer water storage (Eq. 5.146). Water table depth is constrained to 0.05 ≤ z_v ≤ 80 m.</p><p>Aquifer water W<em>a is in kg/m² (equivalent to mm of water column height). Conversion: W</em>a [kg/m²] / ρ_liq [kg/m³] gives meters of water.</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.4, Eq. 5.146, p. 143.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L728-L742">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.AquiferWaterBalance"><a class="docstring-binding" href="#UrbanCanopy.AquiferWaterBalance"><code>UrbanCanopy.AquiferWaterBalance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">AquiferWaterBalance(; name=:AquiferWaterBalance)</code></pre><p>Computes the update of aquifer water storage, following Section 5.4 of Oleson et al. (2010).</p><p>For the case when the water table is below the soil column, the aquifer water W_a (kg/m²) is updated from the balance of recharge and drainage (Eq. 5.143). Since 1 mm water = 1 kg/m², we use kg/m² for storage and kg/(m²·s) for rates, which ensures unit consistency.</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.4, Eqs. 5.142–5.147, pp. 142–144.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L778-L790">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SnowCappingRunoff"><a class="docstring-binding" href="#UrbanCanopy.SnowCappingRunoff"><code>UrbanCanopy.SnowCappingRunoff</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SnowCappingRunoff(; name=:SnowCappingRunoff)</code></pre><p>Computes runoff from snow-capping when the snow water equivalent exceeds 1000 kg/m², following Section 5.5 of Oleson et al. (2010).</p><p>For snow-capped surfaces, precipitation and dew are routed to solid and liquid runoff terms (Eqs. 5.153–5.154).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.5, Eqs. 5.153–5.154, p. 146.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L812-L822">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SurfaceLayerUpdate"><a class="docstring-binding" href="#UrbanCanopy.SurfaceLayerUpdate"><code>UrbanCanopy.SurfaceLayerUpdate</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SurfaceLayerUpdate(; name=:SurfaceLayerUpdate)</code></pre><p>Computes surface layer ice and liquid water content updates from dew, frost, and sublimation, following Section 5.4 of Oleson et al. (2010).</p><p>These updates apply to the top layer of all surfaces (roof, pervious road, impervious road).</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Eqs. 5.150–5.152, p. 146.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L849-L859">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.PerviousRoadWaterBalance"><a class="docstring-binding" href="#UrbanCanopy.PerviousRoadWaterBalance"><code>UrbanCanopy.PerviousRoadWaterBalance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">PerviousRoadWaterBalance(; name=:PerviousRoadWaterBalance)</code></pre><p>Describes the overall water balance equation for the pervious road column, following Eq. 5.1 of Oleson et al. (2010).</p><p>The pervious road has a full soil column with infiltration, surface runoff, sub-surface drainage, redistribution within the soil, and groundwater interactions.</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Eq. 5.1, p. 110.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L889-L899">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.ImperviousWaterBalance"><a class="docstring-binding" href="#UrbanCanopy.ImperviousWaterBalance"><code>UrbanCanopy.ImperviousWaterBalance</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ImperviousWaterBalance(; name=:ImperviousWaterBalance)</code></pre><p>Describes the water balance for the roof and impervious road surfaces, following Eqs. 5.2–5.3 of Oleson et al. (2010).</p><p>These surfaces have limited water storage capacity (1 kg/m² ponding limit), no sub-surface drainage, and intercept both liquid and solid precipitation.</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Eqs. 5.2–5.5, pp. 112.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L926-L936">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.ImperviousRunoff"><a class="docstring-binding" href="#UrbanCanopy.ImperviousRunoff"><code>UrbanCanopy.ImperviousRunoff</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ImperviousRunoff(; name=:ImperviousRunoff)</code></pre><p>Computes surface runoff for roof and impervious road surfaces, following Eqs. 5.47–5.48 of Oleson et al. (2010).</p><p>These surfaces have limited water storage capacity. When no snow layers are present (snl = 0), runoff equals the excess water above the ponding limit w<em>pond</em>max = 1 kg/m². When snow layers exist (snl &lt; 0), all liquid water reaching the surface becomes runoff.</p><p>After runoff, the surface liquid water content is updated:</p><ul><li>If runoff occurs: w<em>liq</em>1 is set to the ponding limit (Eq. 5.48, case 1)</li><li>If no runoff: w<em>liq</em>1 is updated with net input (Eq. 5.48, case 2)</li></ul><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.2, Eqs. 5.47–5.48, pp. 124–125.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L974-L990">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.InterfaceHydraulicConductivity"><a class="docstring-binding" href="#UrbanCanopy.InterfaceHydraulicConductivity"><code>UrbanCanopy.InterfaceHydraulicConductivity</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">InterfaceHydraulicConductivity(; name=:InterfaceHydraulicConductivity)</code></pre><p>Computes the hydraulic conductivity at the interface between two soil layers, following Eq. 5.69 of Oleson et al. (2010).</p><p>The interface conductivity accounts for averaging of water content and porosity between adjacent layers, Clapp-Hornberger power-law dependence on saturation, and reduction due to frozen soil (impermeable fraction).</p><p>For interfaces between two layers (i = 1, ..., N<em>levsoi - 1):   k[z</em>h,i] = (1 - (f<em>frz,i + f</em>frz,i+1)/2) * k<em>sat[z</em>h,i] *              [0.5<em>(θ<em>i + θ</em>{i+1}) / (0.5</em>(θ<em>sat,i + θ</em>sat,i+1))]^(2B_i+3)</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.3.1, Eq. 5.69, p. 131.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L1037-L1052">source</a></section></details></article><article><details class="docstring" open="true"><summary id="UrbanCanopy.SoilWaterContentCalc"><a class="docstring-binding" href="#UrbanCanopy.SoilWaterContentCalc"><code>UrbanCanopy.SoilWaterContentCalc</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">SoilWaterContentCalc(; name=:SoilWaterContentCalc)</code></pre><p>Computes the total volumetric soil water content from liquid water and ice masses, following Eq. 5.137 of Oleson et al. (2010).</p><p>The total volumetric water content combines both liquid and ice phases:   θ<em>i = w</em>liq,i / (Δz<em>i * ρ</em>liq) + w<em>ice,i / (Δz</em>i * ρ_ice)</p><p><strong>Reference</strong>: Oleson et al. (2010), Chapter 5, Section 5.3.2, Eq. 5.137, p. 141.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/48ed4055f0aad52eb855a387822aa74be1fa495f/src/hydrology.jl#L1080-L1090">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The hydrology module implements the equations from Chapter 5 as 17 modular ModelingToolkit components. Each component can be used independently or composed into larger systems.</p><h3 id="Snow-Density"><a class="docs-heading-anchor" href="#Snow-Density">Snow Density</a><a id="Snow-Density-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Density" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using UrbanCanopy

sys = SnowDensity()

vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">ρ_sno</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Bulk density of newly fallen snow (Eq. 5.10)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>9×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">T_offset</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature offset for density formula</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T_f</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Freezing temperature of water (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">T_thresh_high</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Upper temperature threshold</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">T_thresh_low</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Lower temperature threshold</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ρ_base</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Base snow density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">T_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">ρ_coeff</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Snow density coefficient</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">ρ_warm</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Snow density for warm conditions (T_atm &gt; T_f+2)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">one_K</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Unit temperature for nondimensionalization</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{\rho\_sno}\left( t \right) &amp;= ifelse\left( \mathtt{T\_atm} &gt; \mathtt{T\_f} + \mathtt{T\_thresh\_high}, \mathtt{\rho\_warm}, ifelse\left( \mathtt{T\_atm} &gt; \mathtt{T\_f} + \mathtt{T\_thresh\_low}, \mathtt{\rho\_base} + \left( \frac{\mathtt{T\_atm} - \mathtt{T\_f} + \mathtt{T\_offset}}{\mathtt{one\_K}} \right)^{1.5} \mathtt{\rho\_coeff}, \mathtt{\rho\_base} \right) \right)
\end{align}
 \]</p><h3 id="Snow-Ice-Content"><a class="docs-heading-anchor" href="#Snow-Ice-Content">Snow Ice Content</a><a id="Snow-Ice-Content-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Ice-Content" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_ice = SnowIceContent()

vars = unknowns(sys_ice)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">dz_sno_dt</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Rate of new snow depth accumulation (from Eq. 5.9)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_ice_top</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Rate of ice accumulation for top snow layer (Eq. 5.7)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_ice)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>4×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">ρ_sno</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Bulk density of newly fallen snow</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_subl</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Sublimation rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">q_grnd_ice</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid precipitation reaching the surface (Eq. 5.5)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">q_frost</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Frost rate</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_ice)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{dz\_sno\_dt}\left( t \right) &amp;= \frac{\mathtt{q\_grnd\_ice}}{\mathtt{\rho\_sno}} \\
\mathtt{q\_ice\_top}\left( t \right) &amp;= \mathtt{q\_frost} + \mathtt{q\_grnd\_ice} - \mathtt{q\_subl}
\end{align}
 \]</p><h3 id="Snow-Water-Content"><a class="docs-heading-anchor" href="#Snow-Water-Content">Snow Water Content</a><a id="Snow-Water-Content-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Water-Content" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_swc = SnowWaterContent()

vars = unknowns(sys_swc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">θ_ice</td><td style = "text-align: left;"></td><td style = "text-align: left;">Volumetric ice content in snow layer (Eq. 5.19)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">θ_liq</td><td style = "text-align: left;"></td><td style = "text-align: left;">Volumetric liquid water content in snow layer (Eq. 5.20)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">q_liq_out</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Water flow out of snow layer (Eq. 5.18)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_swc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">w_ice</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Mass of ice in snow layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">w_liq</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Mass of liquid water in snow layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">one_s</td><td style = "text-align: left;">s</td><td style = "text-align: left;">Unit time for rate conversion</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">Δz</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Snow layer thickness</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ρ_ice</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Density of ice (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">zero_kgpm2s</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Zero flux for comparison</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">S_r</td><td style = "text-align: left;"></td><td style = "text-align: left;">Irreducible water saturation (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">ρ_liq</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Density of liquid water (Table 1.4)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_swc)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{\theta\_ice}\left( t \right) &amp;= min\left( \frac{\mathtt{w\_ice}}{\mathtt{{\Delta}z} \mathtt{\rho\_ice}}, 1 \right) \\
\mathtt{\theta\_liq}\left( t \right) &amp;= min\left( \frac{\mathtt{w\_liq}}{\mathtt{{\Delta}z} \mathtt{\rho\_liq}}, 1 - \mathtt{\theta\_ice}\left( t \right) \right) \\
\mathtt{q\_liq\_out}\left( t \right) &amp;= max\left( \frac{\left( \mathtt{\theta\_liq}\left( t \right) - \mathtt{S\_r} \left( 1 - \mathtt{\theta\_ice}\left( t \right) \right) \right) \mathtt{{\Delta}z} \mathtt{\rho\_liq}}{\mathtt{one\_s}}, \mathtt{zero\_kgpm2s} \right)
\end{align}
 \]</p><h3 id="Snow-Compaction"><a class="docs-heading-anchor" href="#Snow-Compaction">Snow Compaction</a><a id="Snow-Compaction-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Compaction" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_sc = SnowCompaction()

vars = unknowns(sys_sc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">c_1</td><td style = "text-align: left;"></td><td style = "text-align: left;">Density-dependent coefficient (Eq. 5.27) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">c_2</td><td style = "text-align: left;"></td><td style = "text-align: left;">Liquid-dependent coefficient (Eq. 5.27) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">C_R1</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Destructive metamorphism compaction rate (Eq. 5.26)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">η</td><td style = "text-align: left;">m⁻² kg s</td><td style = "text-align: left;">Viscosity coefficient (Eq. 5.29)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">C_R2</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Overburden compaction rate (Eq. 5.28)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">C_R3</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Melt compaction rate (Eq. 5.31)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">C_R</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Total fractional compaction rate (Eq. 5.24)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_sc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>17×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">thresh_liq_density</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Liquid water density threshold</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T_i</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Snow layer temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">f_ice_n1</td><td style = "text-align: left;"></td><td style = "text-align: left;">Ice fraction at time n+1 (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">η_0</td><td style = "text-align: left;">m⁻² kg s</td><td style = "text-align: left;">Reference viscosity (Eq. 5.29)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">w_ice</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Mass of ice in layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">w_liq</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Mass of liquid water in layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">one_per_s</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Unit rate for nondimensionalization</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">f_ice_n</td><td style = "text-align: left;"></td><td style = "text-align: left;">Ice fraction at time n (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">T_f</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Freezing temperature of water (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">P_s</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Snow load pressure on this layer (Eq. 5.30)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">hundred_kgpm3</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Reference density 100 kg/m^3</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">coeff_0046</td><td style = "text-align: left;">m³ kg⁻¹</td><td style = "text-align: left;">Density coefficient (Eq. 5.27)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">c_4</td><td style = "text-align: left;">K⁻¹</td><td style = "text-align: left;">Temperature coefficient for metamorphism (Eq. 5.26)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">c_3</td><td style = "text-align: left;">s⁻¹</td><td style = "text-align: left;">Fractional compaction rate at T_f (Eq. 5.26)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">c_6</td><td style = "text-align: left;">m³ kg⁻¹</td><td style = "text-align: left;">Viscosity density coefficient (Eq. 5.29)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">Δz</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Snow layer thickness</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">c_5</td><td style = "text-align: left;">K⁻¹</td><td style = "text-align: left;">Viscosity temperature coefficient (Eq. 5.29)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_sc)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{c\_1}\left( t \right) &amp;= ifelse\left( \frac{\mathtt{w\_ice}}{\mathtt{{\Delta}z}} &gt; \mathtt{hundred\_kgpm3}, e^{ - \mathtt{coeff\_0046} \left(  - \mathtt{hundred\_kgpm3} + \frac{\mathtt{w\_ice}}{\mathtt{{\Delta}z}} \right)}, 1 \right) \\
\mathtt{c\_2}\left( t \right) &amp;= ifelse\left( \frac{\mathtt{w\_liq}}{\mathtt{{\Delta}z}} &gt; \mathtt{thresh\_liq\_density}, 2, 1 \right) \\
\mathtt{C\_R1}\left( t \right) &amp;=  - \mathtt{c\_3} e^{ - \left( \mathtt{T\_f} - \mathtt{T\_i} \right) \mathtt{c\_4}} \mathtt{c\_1}\left( t \right) \mathtt{c\_2}\left( t \right) \\
\eta\left( t \right) &amp;= e^{\frac{\mathtt{c\_6} \mathtt{w\_ice}}{\mathtt{{\Delta}z}} + \left( \mathtt{T\_f} - \mathtt{T\_i} \right) \mathtt{c\_5}} \mathtt{\eta\_0} \\
\mathtt{C\_R2}\left( t \right) &amp;= \frac{ - \mathtt{P\_s}}{\eta\left( t \right)} \\
\mathtt{C\_R3}\left( t \right) &amp;=  - \mathtt{one\_per\_s} max\left( 0, \frac{\mathtt{f\_ice\_n} - \mathtt{f\_ice\_n1}}{max\left( \mathtt{f\_ice\_n}, 1 \cdot 10^{-10} \right)} \right) \\
\mathtt{C\_R}\left( t \right) &amp;= \mathtt{C\_R1}\left( t \right) + \mathtt{C\_R2}\left( t \right) + \mathtt{C\_R3}\left( t \right)
\end{align}
 \]</p><h3 id="Snow-Layer-Combination"><a class="docs-heading-anchor" href="#Snow-Layer-Combination">Snow Layer Combination</a><a id="Snow-Layer-Combination-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Layer-Combination" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_slc = SnowLayerCombination()

vars = unknowns(sys_slc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">Δz_c</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Combined thickness (Eq. 5.38)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">w_liq_c</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Combined liquid water (Eq. 5.39)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">w_ice_c</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Combined ice content (Eq. 5.40)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">h_1</td><td style = "text-align: left;">kg s⁻²</td><td style = "text-align: left;">Enthalpy of layer 1 (Eq. 5.42)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">h_2</td><td style = "text-align: left;">kg s⁻²</td><td style = "text-align: left;">Enthalpy of layer 2 (Eq. 5.42)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">T_c</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Combined temperature (Eq. 5.41)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_slc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>12×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">C_liq</td><td style = "text-align: left;">m² s⁻² K⁻¹</td><td style = "text-align: left;">Specific heat of liquid water (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">Δz_2</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Thickness of layer 2</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">w_liq_2</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Liquid water in layer 2</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">w_ice_1</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Ice content in layer 1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">T_2</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature of layer 2</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">w_ice_2</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Ice content in layer 2</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">w_liq_1</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Liquid water in layer 1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">T_1</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Temperature of layer 1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">T_f</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Freezing temperature of water (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">Δz_1</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Thickness of layer 1</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">C_ice</td><td style = "text-align: left;">m² s⁻² K⁻¹</td><td style = "text-align: left;">Specific heat of ice (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">L_f</td><td style = "text-align: left;">m² s⁻²</td><td style = "text-align: left;">Latent heat of fusion (Table 1.4)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_slc)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{{\Delta}z\_c}\left( t \right) &amp;= \mathtt{{\Delta}z\_1} + \mathtt{{\Delta}z\_2} \\
\mathtt{w\_liq\_c}\left( t \right) &amp;= \mathtt{w\_liq\_1} + \mathtt{w\_liq\_2} \\
\mathtt{w\_ice\_c}\left( t \right) &amp;= \mathtt{w\_ice\_1} + \mathtt{w\_ice\_2} \\
\mathtt{h\_1}\left( t \right) &amp;= \mathtt{L\_f} \mathtt{w\_liq\_1} + \left( \mathtt{C\_ice} \mathtt{w\_ice\_1} + \mathtt{C\_liq} \mathtt{w\_liq\_1} \right) \left( \mathtt{T\_1} - \mathtt{T\_f} \right) \\
\mathtt{h\_2}\left( t \right) &amp;= \mathtt{L\_f} \mathtt{w\_liq\_2} + \left( \mathtt{C\_ice} \mathtt{w\_ice\_2} + \mathtt{C\_liq} \mathtt{w\_liq\_2} \right) \left( \mathtt{T\_2} - \mathtt{T\_f} \right) \\
\mathtt{T\_c}\left( t \right) &amp;= \mathtt{T\_f} + \frac{\mathtt{h\_2}\left( t \right) + \mathtt{h\_1}\left( t \right) - \mathtt{L\_f} \mathtt{w\_liq\_c}\left( t \right)}{\mathtt{C\_ice} \mathtt{w\_ice\_c}\left( t \right) + \mathtt{C\_liq} \mathtt{w\_liq\_c}\left( t \right)}
\end{align}
 \]</p><h3 id="Soil-Hydraulic-Properties"><a class="docs-heading-anchor" href="#Soil-Hydraulic-Properties">Soil Hydraulic Properties</a><a id="Soil-Hydraulic-Properties-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Hydraulic-Properties" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_soil = SoilHydraulicProperties()

vars = unknowns(sys_soil)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">k_sat</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Saturated hydraulic conductivity (Eq. 5.70)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">θ_sat</td><td style = "text-align: left;"></td><td style = "text-align: left;">Volumetric water content at saturation / porosity (Eq. 5.71)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">B</td><td style = "text-align: left;"></td><td style = "text-align: left;">Clapp-Hornberger exponent (Eq. 5.72) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">ψ_sat</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Saturated soil matric potential (Eq. 5.74)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ψ</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Soil matric potential (Eq. 5.73)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_soil)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">pct_clay</td><td style = "text-align: left;"></td><td style = "text-align: left;">Percent clay content (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">k_coeff</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Coefficient for saturated hydraulic conductivity (Eq. 5.70), converted from mm/s to m/s</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">ψ_min</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Minimum soil matric potential (converted from -1e8 mm to m)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">pct_sand</td><td style = "text-align: left;"></td><td style = "text-align: left;">Percent sand content (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ψ_coeff</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Coefficient for saturated matric potential (Eq. 5.74), converted from mm to m</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">θ_i</td><td style = "text-align: left;"></td><td style = "text-align: left;">Total volumetric soil water content</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_soil)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{k\_sat}\left( t \right) &amp;= 10^{-0.884 + 0.0153 \mathtt{pct\_sand}} \mathtt{k\_coeff} \\
\mathtt{\theta\_sat}\left( t \right) &amp;= 0.489 - 0.00126 \mathtt{pct\_sand} \\
B\left( t \right) &amp;= 2.91 + 0.159 \mathtt{pct\_clay} \\
\mathtt{\psi\_sat}\left( t \right) &amp;= 10^{1.88 - 0.0131 \mathtt{pct\_sand}} \mathtt{\psi\_coeff} \\
\psi\left( t \right) &amp;= max\left( \left( \frac{max\left( \mathtt{\theta\_i}, 0.01 \mathtt{\theta\_sat}\left( t \right) \right)}{\mathtt{\theta\_sat}\left( t \right)} \right)^{ - B\left( t \right)} \mathtt{\psi\_sat}\left( t \right), \mathtt{\psi\_min} \right)
\end{align}
 \]</p><h3 id="Groundwater-Drainage"><a class="docs-heading-anchor" href="#Groundwater-Drainage">Groundwater Drainage</a><a id="Groundwater-Drainage-1"></a><a class="docs-heading-anchor-permalink" href="#Groundwater-Drainage" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_gw = GroundwaterDrainage()

vars = unknowns(sys_gw)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">f_imp</td><td style = "text-align: left;"></td><td style = "text-align: left;">Impermeable fraction for drainage (Eq. 5.141) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_drai</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Sub-surface drainage (Eq. 5.140)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_gw)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">α</td><td style = "text-align: left;"></td><td style = "text-align: left;">Scale-dependent parameter (Eq. 5.141) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">f_drai</td><td style = "text-align: left;">m⁻¹</td><td style = "text-align: left;">Drainage decay factor (p. 142)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">f_ice_weighted</td><td style = "text-align: left;"></td><td style = "text-align: left;">Ice-weighted impermeable fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">z_v</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Water table depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">q_drai_max</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Maximum drainage rate at surface (p. 142)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_gw)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{f\_imp}\left( t \right) &amp;= max\left( \frac{ - e^{ - \alpha} + e^{ - \left( 1 - \mathtt{f\_ice\_weighted} \right) \alpha}}{1 - e^{ - \alpha}}, 0 \right) \\
\mathtt{q\_drai}\left( t \right) &amp;= \mathtt{q\_drai\_max} \left( 1 - \mathtt{f\_imp}\left( t \right) \right) e^{ - \mathtt{f\_drai} \mathtt{z\_v}}
\end{align}
 \]</p><h3 id="Water-Table-Depth"><a class="docs-heading-anchor" href="#Water-Table-Depth">Water Table Depth</a><a id="Water-Table-Depth-1"></a><a class="docs-heading-anchor-permalink" href="#Water-Table-Depth" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_wt = WaterTableDepth()

vars = unknowns(sys_wt)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">z_v</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Water table depth (Eq. 5.146)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_wt)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">z_h_bottom</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Depth of bottom soil interface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">z_offset</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Offset for water table calculation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">z_v_min</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Minimum water table depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">z_v_max</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Maximum water table depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">W_a</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Water stored in unconfined aquifer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">S_y</td><td style = "text-align: left;"></td><td style = "text-align: left;">Specific yield (Eq. 5.146) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">ρ_liq</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Density of liquid water (Table 1.4)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_wt)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{z\_v}\left( t \right) &amp;= max\left( \mathtt{z\_v\_min}, min\left( \mathtt{z\_v\_max}, \mathtt{z\_h\_bottom} + \mathtt{z\_offset} + \frac{ - \mathtt{W\_a}}{\mathtt{S\_y} \mathtt{\rho\_liq}} \right) \right)
\end{align}
 \]</p><h3 id="Richards&#39;-Equation-(PDE-Soil-Water-Movement)"><a class="docs-heading-anchor" href="#Richards&#39;-Equation-(PDE-Soil-Water-Movement)">Richards&#39; Equation (PDE Soil Water Movement)</a><a id="Richards&#39;-Equation-(PDE-Soil-Water-Movement)-1"></a><a class="docs-heading-anchor-permalink" href="#Richards&#39;-Equation-(PDE-Soil-Water-Movement)" title="Permalink"></a></h3><p>Richards&#39; equation is implemented as a PDE using MethodOfLines.jl for automatic spatial discretization. The function returns a named tuple containing the discretized ODE problem and symbolic variables.</p><pre><code class="language-julia hljs">using MethodOfLines, DomainSets

result_re = RichardsEquation(;
    N_layers = 10, Δz_total = 2.0,
    pct_sand = 50.0, pct_clay = 20.0,
    θ_top_val = 0.3, θ_bottom_val = 0.3,
    θ_init_val = 0.3,
)
println(&quot;Soil properties for 50% sand, 20% clay:&quot;)
println(&quot;  k_sat = &quot;, result_re.k_sat_val, &quot; m/s&quot;)
println(&quot;  θ_sat = &quot;, result_re.θ_sat_val, &quot; m³/m³&quot;)
println(&quot;  B     = &quot;, result_re.B_val)
println(&quot;  ψ_sat = &quot;, result_re.ψ_sat_val, &quot; m&quot;)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Soil properties for 50% sand, 20% clay:
  k_sat = 5.364558079579147e-6 m/s
  θ_sat = 0.426 m³/m³
  B     = 6.09
  ψ_sat = -0.16788040181225597 m</code></pre><h3 id="Surface-Runoff-and-Infiltration"><a class="docs-heading-anchor" href="#Surface-Runoff-and-Infiltration">Surface Runoff and Infiltration</a><a id="Surface-Runoff-and-Infiltration-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-Runoff-and-Infiltration" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_sri = SurfaceRunoffInfiltration()

vars = unknowns(sys_sri)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">f_frz_1</td><td style = "text-align: left;"></td><td style = "text-align: left;">Impermeable fraction from frozen soil (Eq. 5.51) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">f_sat</td><td style = "text-align: left;"></td><td style = "text-align: left;">Fractional saturated area (Eq. 5.50) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">s</td><td style = "text-align: left;"></td><td style = "text-align: left;">Relative saturation (Eq. 5.53) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">v</td><td style = "text-align: left;"></td><td style = "text-align: left;">Infiltration variable v (Eq. 5.54) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">q_infl_max</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Maximum infiltration capacity (Eq. 5.52)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">q_over</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface runoff (Eq. 5.49)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">q_infl</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Infiltration rate (Eqs. 5.56–5.57)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_sri)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>20×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">B_1</td><td style = "text-align: left;"></td><td style = "text-align: left;">Clapp-Hornberger exponent for top soil layer (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">f_over</td><td style = "text-align: left;">m⁻¹</td><td style = "text-align: left;">Decay factor for saturated fraction (p. 126)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">θ_ice_1</td><td style = "text-align: left;"></td><td style = "text-align: left;">Volumetric ice content of top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">ψ_sat_1</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Saturated matric potential for top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ρ_liq</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Density of liquid water (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">q_liq_0</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid water reaching surface from rain/snowmelt</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">q_seva</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface evaporation of liquid water</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">θ_liq_1</td><td style = "text-align: left;"></td><td style = "text-align: left;">Volumetric liquid water content of top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">w_ice_1</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Ice content of top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">zero_kgpm2s</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Zero flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">w_liq_1</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Liquid water content of top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">f_max</td><td style = "text-align: left;"></td><td style = "text-align: left;">Maximum saturated fraction (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">θ_sat_1</td><td style = "text-align: left;"></td><td style = "text-align: left;">Porosity of top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">α</td><td style = "text-align: left;"></td><td style = "text-align: left;">Scale-dependent parameter for frozen fraction (Eq. 5.51) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">one_kgpm2</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Unit mass per area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">k_sat_1</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Saturated hydraulic conductivity of top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">z_v</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Water table depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">Δz_1</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Thickness of top soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">θ_imp</td><td style = "text-align: left;"></td><td style = "text-align: left;">Minimum effective porosity (p. 127)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">has_snow</td><td style = "text-align: left;"></td><td style = "text-align: left;">Whether snow layers are present (1=yes, 0=no) (dimensionless)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_sri)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{f\_frz\_1}\left( t \right) &amp;= \frac{ - e^{ - \alpha} + e^{ - \left( 1 + \frac{ - \mathtt{w\_ice\_1}}{max\left( \mathtt{w\_ice\_1} + \mathtt{w\_liq\_1}, 1 \cdot 10^{-10} \mathtt{one\_kgpm2} \right)} \right) \alpha}}{1 - e^{ - \alpha}} \\
\mathtt{f\_sat}\left( t \right) &amp;= \mathtt{f\_frz\_1}\left( t \right) + \mathtt{f\_max} e^{ - 0.5 \mathtt{f\_over} \mathtt{z\_v}} \left( 1 - \mathtt{f\_frz\_1}\left( t \right) \right) \\
s\left( t \right) &amp;= max\left( \frac{\frac{\mathtt{\theta\_liq\_1}}{max\left( \mathtt{\theta\_imp},  - \mathtt{\theta\_ice\_1} + \mathtt{\theta\_sat\_1} \right)} - \mathtt{f\_sat}\left( t \right)}{max\left( 1 - \mathtt{f\_sat}\left( t \right), 0.01 \right)}, 0 \right) \\
v\left( t \right) &amp;= \frac{\mathtt{B\_1} \mathtt{\psi\_sat\_1}}{0.5 \mathtt{{\Delta}z\_1}} \\
\mathtt{q\_infl\_max}\left( t \right) &amp;= \mathtt{k\_sat\_1} \left( 1 + v\left( t \right) \left( -1 + s\left( t \right) \right) \right) \mathtt{\rho\_liq} \\
\mathtt{q\_over}\left( t \right) &amp;= \mathtt{q\_liq\_0} \mathtt{f\_sat}\left( t \right) + \left( 1 - \mathtt{f\_sat}\left( t \right) \right) max\left( \mathtt{zero\_kgpm2s}, \mathtt{q\_liq\_0} - \mathtt{q\_infl\_max}\left( t \right) \right) \\
\mathtt{q\_infl}\left( t \right) &amp;= ifelse\left( \mathtt{has\_snow} &gt; 0.5, \mathtt{q\_liq\_0} - \mathtt{q\_over}\left( t \right), max\left( \mathtt{q\_liq\_0} - \mathtt{q\_seva} - \mathtt{q\_over}\left( t \right), \mathtt{zero\_kgpm2s} \right) \right)
\end{align}
 \]</p><h3 id="Soil-Water-Flux"><a class="docs-heading-anchor" href="#Soil-Water-Flux">Soil Water Flux</a><a id="Soil-Water-Flux-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Water-Flux" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_swf = SoilWaterFlux()

vars = unknowns(sys_swf)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Soil water flux at interface (Eq. 5.88, positive upward)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_swf)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">z_upper</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Node depth of upper layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">k_interface</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Hydraulic conductivity at layer interface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">ψ_E_upper</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Equilibrium matric potential of upper layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">ψ_upper</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Soil matric potential of upper layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ψ_E_lower</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Equilibrium matric potential of lower layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">z_lower</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Node depth of lower layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">ψ_lower</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Soil matric potential of lower layer</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_swf)</code></pre><p class="math-container">\[ \begin{align}
q\left( t \right) &amp;= \frac{ - \mathtt{k\_interface} \left( \mathtt{\psi\_E\_lower} - \mathtt{\psi\_E\_upper} - \mathtt{\psi\_lower} + \mathtt{\psi\_upper} \right)}{\mathtt{z\_lower} - \mathtt{z\_upper}}
\end{align}
 \]</p><h3 id="Soil-Water-Equilibrium"><a class="docs-heading-anchor" href="#Soil-Water-Equilibrium">Soil Water Equilibrium</a><a id="Soil-Water-Equilibrium-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Water-Equilibrium" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_swe = SoilWaterEquilibrium()

vars = unknowns(sys_swe)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">θ_E</td><td style = "text-align: left;"></td><td style = "text-align: left;">Layer-averaged equilibrium volumetric water content (Eq. 5.101)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">ψ_E</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Equilibrium matric potential at node (Eq. 5.106)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_swe)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">z_h_lower</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Lower interface depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">θ_sat</td><td style = "text-align: left;"></td><td style = "text-align: left;">Porosity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">ψ_sat</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Saturated matric potential</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">ψ_min</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Minimum matric potential (converted from -1e8 mm)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">z_h_upper</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Upper interface depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">z_v</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Water table depth</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">B</td><td style = "text-align: left;"></td><td style = "text-align: left;">Clapp-Hornberger exponent (dimensionless)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_swe)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{\theta\_E}\left( t \right) &amp;= ifelse\left( \mathtt{z\_v} &lt; \mathtt{z\_h\_upper}, \mathtt{\theta\_sat}, max\left( 0, min\left( \mathtt{\theta\_sat}, \frac{\left( \left( \frac{\mathtt{z\_h\_lower} - \mathtt{z\_v} + \mathtt{\psi\_sat}}{\mathtt{\psi\_sat}} \right)^{1 + \frac{-1}{B}} - \left( \frac{\mathtt{z\_h\_upper} - \mathtt{z\_v} + \mathtt{\psi\_sat}}{\mathtt{\psi\_sat}} \right)^{1 + \frac{-1}{B}} \right) \mathtt{\theta\_sat} \mathtt{\psi\_sat}}{\left( 1 + \frac{-1}{B} \right) \left( \mathtt{z\_h\_lower} - \mathtt{z\_h\_upper} \right)} \right) \right) \right) \\
\mathtt{\psi\_E}\left( t \right) &amp;= max\left( \left( \frac{max\left( \mathtt{\theta\_E}\left( t \right), 0.01 \mathtt{\theta\_sat} \right)}{\mathtt{\theta\_sat}} \right)^{ - B} \mathtt{\psi\_sat}, \mathtt{\psi\_min} \right)
\end{align}
 \]</p><h3 id="Aquifer-Water-Balance"><a class="docs-heading-anchor" href="#Aquifer-Water-Balance">Aquifer Water Balance</a><a id="Aquifer-Water-Balance-1"></a><a class="docs-heading-anchor-permalink" href="#Aquifer-Water-Balance" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_awb = AquiferWaterBalance()

vars = unknowns(sys_awb)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">dW_a</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Rate of change of aquifer water (Eq. 5.143)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_awb)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q_drai</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Sub-surface drainage rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_recharge</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Recharge rate to aquifer</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_awb)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{dW\_a}\left( t \right) &amp;=  - \mathtt{q\_drai} + \mathtt{q\_recharge}
\end{align}
 \]</p><h3 id="Snow-Capping-Runoff"><a class="docs-heading-anchor" href="#Snow-Capping-Runoff">Snow Capping Runoff</a><a id="Snow-Capping-Runoff-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Capping-Runoff" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_scr = SnowCappingRunoff()

vars = unknowns(sys_scr)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>2×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q_snwcp_ice</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid runoff from snow capping (Eq. 5.153)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_snwcp_liq</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid runoff from snow capping (Eq. 5.154)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_scr)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>4×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q_grnd_liq</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid precipitation reaching surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_dew</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Dew rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">q_grnd_ice</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid precipitation reaching surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">q_frost</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Frost rate</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_scr)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{q\_snwcp\_ice}\left( t \right) &amp;= \mathtt{q\_frost} + \mathtt{q\_grnd\_ice} \\
\mathtt{q\_snwcp\_liq}\left( t \right) &amp;= \mathtt{q\_dew} + \mathtt{q\_grnd\_liq}
\end{align}
 \]</p><h3 id="Surface-Layer-Update"><a class="docs-heading-anchor" href="#Surface-Layer-Update">Surface Layer Update</a><a id="Surface-Layer-Update-1"></a><a class="docs-heading-anchor-permalink" href="#Surface-Layer-Update" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_slu = SurfaceLayerUpdate()

vars = unknowns(sys_slu)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">dw_liq_1</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Rate of change of liquid water from dew (Eq. 5.150)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">dw_ice_1_frost</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Rate of change of ice from frost (Eq. 5.151)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">dw_ice_1_subl</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Rate of change of ice from sublimation (Eq. 5.152)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_slu)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q_subl</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Sublimation rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_sdew</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface dew rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">q_frost</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Frost rate</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_slu)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{dw\_liq\_1}\left( t \right) &amp;= \mathtt{q\_sdew} \\
\mathtt{dw\_ice\_1\_frost}\left( t \right) &amp;= \mathtt{q\_frost} \\
\mathtt{dw\_ice\_1\_subl}\left( t \right) &amp;=  - \mathtt{q\_subl}
\end{align}
 \]</p><h3 id="Pervious-Road-Water-Balance"><a class="docs-heading-anchor" href="#Pervious-Road-Water-Balance">Pervious Road Water Balance</a><a id="Pervious-Road-Water-Balance-1"></a><a class="docs-heading-anchor-permalink" href="#Pervious-Road-Water-Balance" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_prwb = PerviousRoadWaterBalance()

vars = unknowns(sys_prwb)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">water_input</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Net water input rate (Eq. 5.1)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_prwb)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>7×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q_sno</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid precipitation rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">E_prvrd</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Total evaporation (pervious road)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">q_rgwl</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid runoff from groundwater</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">q_over</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface runoff</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">q_drai</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Sub-surface drainage</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">q_snwcp_ice</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid runoff from snow capping</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">q_rain</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid precipitation rate</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_prwb)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{water\_input}\left( t \right) &amp;=  - \mathtt{E\_prvrd} - \mathtt{q\_drai} - \mathtt{q\_over} + \mathtt{q\_rain} - \mathtt{q\_rgwl} + \mathtt{q\_sno} - \mathtt{q\_snwcp\_ice}
\end{align}
 \]</p><h3 id="Impervious-Water-Balance"><a class="docs-heading-anchor" href="#Impervious-Water-Balance">Impervious Water Balance</a><a id="Impervious-Water-Balance-1"></a><a class="docs-heading-anchor-permalink" href="#Impervious-Water-Balance" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_iwb = ImperviousWaterBalance()

vars = unknowns(sys_iwb)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q_grnd_liq</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid precipitation reaching surface (Eq. 5.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_grnd_ice</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid precipitation reaching surface (Eq. 5.5)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">water_input</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Net water input rate (Eqs. 5.2-5.3)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_iwb)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>6×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">E_surface</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Total evaporation from surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_sno</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid precipitation rate (Eq. 5.5)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">q_rgwl</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid runoff from groundwater</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">q_over</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface runoff</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">q_snwcp_ice</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid runoff from snow capping</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">q_rain</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid precipitation rate (Eq. 5.4)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_iwb)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{q\_grnd\_liq}\left( t \right) &amp;= \mathtt{q\_rain} \\
\mathtt{q\_grnd\_ice}\left( t \right) &amp;= \mathtt{q\_sno} \\
\mathtt{water\_input}\left( t \right) &amp;=  - \mathtt{E\_surface} - \mathtt{q\_over} + \mathtt{q\_rain} - \mathtt{q\_rgwl} + \mathtt{q\_sno} - \mathtt{q\_snwcp\_ice}
\end{align}
 \]</p><h3 id="Impervious-Runoff"><a class="docs-heading-anchor" href="#Impervious-Runoff">Impervious Runoff</a><a id="Impervious-Runoff-1"></a><a class="docs-heading-anchor-permalink" href="#Impervious-Runoff" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_ir = ImperviousRunoff()

vars = unknowns(sys_ir)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">q_over_nosnow</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface runoff without snow (Eq. 5.47, case 1)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">q_over</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface runoff (Eq. 5.47)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">w_liq_1_new</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Updated surface liquid water content (Eq. 5.48)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_ir)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">one_s</td><td style = "text-align: left;">s</td><td style = "text-align: left;">Unit time for rate conversion</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">zero_kgpm2s</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Zero flux</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">w_pond_max</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Maximum ponding limit (p. 112)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">w_liq_1</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Liquid water on surface</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">zero_kgpm2</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Zero mass per area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">q_liq_0</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid water reaching surface from rain/snowmelt</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">q_seva</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Surface evaporation of liquid water</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">has_snow</td><td style = "text-align: left;"></td><td style = "text-align: left;">Whether snow layers are present (1=yes, 0=no) (dimensionless)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_ir)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{q\_over\_nosnow}\left( t \right) &amp;= max\left( \mathtt{zero\_kgpm2s}, \mathtt{q\_liq\_0} - \mathtt{q\_seva} + \frac{ - \mathtt{w\_pond\_max}}{\mathtt{one\_s}} + \frac{\mathtt{w\_liq\_1}}{\mathtt{one\_s}} \right) \\
\mathtt{q\_over}\left( t \right) &amp;= ifelse\left( \mathtt{has\_snow} &gt; 0.5, \mathtt{q\_liq\_0}, \mathtt{q\_over\_nosnow}\left( t \right) \right) \\
\mathtt{w\_liq\_1\_new}\left( t \right) &amp;= ifelse\left( \mathtt{has\_snow} &gt; 0.5, \mathtt{w\_liq\_1}, ifelse\left( \mathtt{q\_over\_nosnow}\left( t \right) &gt; \mathtt{zero\_kgpm2s}, \mathtt{w\_pond\_max}, max\left( \mathtt{w\_liq\_1} + \mathtt{one\_s} \left( \mathtt{q\_liq\_0} - \mathtt{q\_seva} \right), \mathtt{zero\_kgpm2} \right) \right) \right)
\end{align}
 \]</p><h3 id="Interface-Hydraulic-Conductivity"><a class="docs-heading-anchor" href="#Interface-Hydraulic-Conductivity">Interface Hydraulic Conductivity</a><a id="Interface-Hydraulic-Conductivity-1"></a><a class="docs-heading-anchor-permalink" href="#Interface-Hydraulic-Conductivity" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_ihc = InterfaceHydraulicConductivity()

vars = unknowns(sys_ihc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">k_h</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Hydraulic conductivity at interface (Eq. 5.69)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_ihc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>8×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">f_frz_upper</td><td style = "text-align: left;"></td><td style = "text-align: left;">Impermeable fraction of upper layer (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">f_frz_lower</td><td style = "text-align: left;"></td><td style = "text-align: left;">Impermeable fraction of lower layer (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">θ_upper</td><td style = "text-align: left;"></td><td style = "text-align: left;">Volumetric water content of upper layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">θ_lower</td><td style = "text-align: left;"></td><td style = "text-align: left;">Volumetric water content of lower layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">θ_sat_lower</td><td style = "text-align: left;"></td><td style = "text-align: left;">Porosity of lower layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">θ_sat_upper</td><td style = "text-align: left;"></td><td style = "text-align: left;">Porosity of upper layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">B_i</td><td style = "text-align: left;"></td><td style = "text-align: left;">Clapp-Hornberger exponent of upper layer (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">k_sat_h</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Saturated hydraulic conductivity at interface (Eq. 5.70)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_ihc)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{k\_h}\left( t \right) &amp;= \left( \frac{0.5 \left( \mathtt{\theta\_lower} + \mathtt{\theta\_upper} \right)}{0.5 \left( \mathtt{\theta\_sat\_lower} + \mathtt{\theta\_sat\_upper} \right)} \right)^{3 + 2 \mathtt{B\_i}} \left( 1 - 0.5 \left( \mathtt{f\_frz\_lower} + \mathtt{f\_frz\_upper} \right) \right) \mathtt{k\_sat\_h}
\end{align}
 \]</p><h3 id="Soil-Water-Content"><a class="docs-heading-anchor" href="#Soil-Water-Content">Soil Water Content</a><a id="Soil-Water-Content-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Water-Content" title="Permalink"></a></h3><pre><code class="language-julia hljs">sys_swcc = SoilWaterContentCalc()

vars = unknowns(sys_swcc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>1×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">θ_i</td><td style = "text-align: left;"></td><td style = "text-align: left;">Total volumetric soil water content (Eq. 5.137)</td></tr></tbody></table></div><pre><code class="language-julia hljs">params = parameters(sys_swcc)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [DynamicQuantities.dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>5×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">w_ice</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Mass of ice in soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">w_liq</td><td style = "text-align: left;">m⁻² kg</td><td style = "text-align: left;">Mass of liquid water in soil layer</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">Δz</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Soil layer thickness</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">ρ_ice</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Density of ice (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ρ_liq</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Density of liquid water (Table 1.4)</td></tr></tbody></table></div><pre><code class="language-julia hljs">equations(sys_swcc)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{\theta\_i}\left( t \right) &amp;= \frac{\mathtt{w\_ice}}{\mathtt{{\Delta}z} \mathtt{\rho\_ice}} + \frac{\mathtt{w\_liq}}{\mathtt{{\Delta}z} \mathtt{\rho\_liq}}
\end{align}
 \]</p><h3 id="Table-5.1:-Snow-Layer-Thickness-Bounds"><a class="docs-heading-anchor" href="#Table-5.1:-Snow-Layer-Thickness-Bounds">Table 5.1: Snow Layer Thickness Bounds</a><a id="Table-5.1:-Snow-Layer-Thickness-Bounds-1"></a><a class="docs-heading-anchor-permalink" href="#Table-5.1:-Snow-Layer-Thickness-Bounds" title="Permalink"></a></h3><p>The minimum and maximum thicknesses for the five snow layers used in the model (Table 5.1, p. 121):</p><table><tr><th style="text-align: center">Layer</th><th style="text-align: center"><span>$\Delta z_{min}$</span> (m)</th><th style="text-align: center"><span>$(\Delta z_{max})_l$</span> (m)</th><th style="text-align: center"><span>$(\Delta z_{max})_u$</span> (m)</th></tr><tr><td style="text-align: center">1 (top)</td><td style="text-align: center">0.010</td><td style="text-align: center">0.03</td><td style="text-align: center">0.02</td></tr><tr><td style="text-align: center">2</td><td style="text-align: center">0.015</td><td style="text-align: center">0.07</td><td style="text-align: center">0.05</td></tr><tr><td style="text-align: center">3</td><td style="text-align: center">0.025</td><td style="text-align: center">0.18</td><td style="text-align: center">0.11</td></tr><tr><td style="text-align: center">4</td><td style="text-align: center">0.055</td><td style="text-align: center">0.41</td><td style="text-align: center">0.23</td></tr><tr><td style="text-align: center">5 (bottom)</td><td style="text-align: center">0.115</td><td style="text-align: center">–-</td><td style="text-align: center">–-</td></tr></table><p>Where <span>$(\Delta z_{max})_l$</span> and <span>$(\Delta z_{max})_u$</span> are the maximum thickness at the lower bound (when number of layers equals the layer index) and upper bound (when number of layers exceeds the layer index), respectively.</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><p>The following figures illustrate the key parametric relationships implemented in the hydrology module, using the component functions directly.</p><pre><code class="language-julia hljs">using OrdinaryDiffEqDefault
using Plots</code></pre><h3 id="Snow-Density-vs-Temperature-(Eq.-5.10)"><a class="docs-heading-anchor" href="#Snow-Density-vs-Temperature-(Eq.-5.10)">Snow Density vs Temperature (Eq. 5.10)</a><a id="Snow-Density-vs-Temperature-(Eq.-5.10)-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Density-vs-Temperature-(Eq.-5.10)" title="Permalink"></a></h3><p>Bulk density of newly fallen snow as a function of atmospheric temperature, following Anderson (1976). The density is piecewise: 50 kg/m³ at very cold temperatures (below <span>$T_f - 15$</span>), increasing as <span>$50 + 1.7(T_{atm} - T_f + 15)^{1.5}$</span> for intermediate temperatures, and capped at approximately 169 kg/m³ above <span>$T_f + 2$</span> K (cf. Eq. 5.10, p. 115).</p><pre><code class="language-julia hljs">sys_sd = SnowDensity()
compiled_sd = mtkcompile(sys_sd)

T_f = 273.15
temps = range(250.0, 280.0, length=200)
densities = Float64[]

prob = ODEProblem(compiled_sd, [compiled_sd.T_atm =&gt; 250.0], (0.0, 1.0))
for T in temps
    p = remake(prob; p = [compiled_sd.T_atm =&gt; T])
    sol = solve(p)
    push!(densities, sol[compiled_sd.ρ_sno][end])
end

p = plot(temps, densities, linewidth=2, label=&quot;ρ_sno&quot;,
    xlabel=&quot;Atmospheric Temperature (K)&quot;,
    ylabel=&quot;Snow Density (kg/m³)&quot;,
    title=&quot;New Snow Density vs Temperature (Eq. 5.10)&quot;)
vline!(p, [T_f - 15], linestyle=:dash, color=:gray, label=&quot;T_f - 15 K&quot;)
vline!(p, [T_f + 2], linestyle=:dash, color=:red, label=&quot;T_f + 2 K&quot;)
p</code></pre><img src="c11dc1bc.svg" alt="Example block output"/><p>Below <span>$T_f - 15$</span> K (258.15 K), the snow density is constant at 50 kg/m³. Between <span>$T_f - 15$</span> and <span>$T_f + 2$</span> K, density increases nonlinearly following the 1.5-power law. Above <span>$T_f + 2$</span> K, density is capped at 50 + 1.7(17)^1.5 ≈ 169 kg/m³.</p><h3 id="Soil-Hydraulic-Properties-vs-Sand-Content-(Eqs.-5.70-5.74)"><a class="docs-heading-anchor" href="#Soil-Hydraulic-Properties-vs-Sand-Content-(Eqs.-5.70-5.74)">Soil Hydraulic Properties vs Sand Content (Eqs. 5.70-5.74)</a><a id="Soil-Hydraulic-Properties-vs-Sand-Content-(Eqs.-5.70-5.74)-1"></a><a class="docs-heading-anchor-permalink" href="#Soil-Hydraulic-Properties-vs-Sand-Content-(Eqs.-5.70-5.74)" title="Permalink"></a></h3><p>Soil hydraulic properties as a function of sand and clay content, using the Clapp and Hornberger (1978) and Cosby et al. (1984) pedotransfer functions. These are shown for a saturated soil (<span>$\theta = \theta_{sat}$</span>).</p><pre><code class="language-julia hljs">sys_hp = SoilHydraulicProperties()
compiled_hp = mtkcompile(sys_hp)

sand_range = range(5.0, 95.0, length=100)
ksat_vals = Float64[]
θsat_vals = Float64[]
ψsat_vals = Float64[]
B_vals = Float64[]

pct_clay = 20.0
prob_hp = ODEProblem(compiled_hp,
    [compiled_hp.pct_sand =&gt; 50.0, compiled_hp.pct_clay =&gt; pct_clay,
     compiled_hp.θ_i =&gt; 0.4],
    (0.0, 1.0))

for sand in sand_range
    θ_sat_val = 0.489 - 0.00126 * sand
    p = remake(prob_hp; p = [compiled_hp.pct_sand =&gt; sand,
                              compiled_hp.pct_clay =&gt; pct_clay,
                              compiled_hp.θ_i =&gt; θ_sat_val])
    sol = solve(p)
    push!(ksat_vals, sol[compiled_hp.k_sat][end])
    push!(θsat_vals, sol[compiled_hp.θ_sat][end])
    push!(ψsat_vals, abs(sol[compiled_hp.ψ_sat][end]))
    push!(B_vals, sol[compiled_hp.B][end])
end

p1 = plot(sand_range, ksat_vals .* 1e3, linewidth=2, label=false, yscale=:log10,
    xlabel=&quot;Sand Content (%)&quot;, ylabel=&quot;k_sat (mm/s)&quot;,
    title=&quot;Saturated Hydraulic Conductivity (Eq. 5.70)&quot;)

p2 = plot(sand_range, θsat_vals, linewidth=2, label=false,
    xlabel=&quot;Sand Content (%)&quot;, ylabel=&quot;θ_sat (m³/m³)&quot;,
    title=&quot;Porosity (Eq. 5.71)&quot;)

p3 = plot(sand_range, ψsat_vals .* 1e3, linewidth=2, label=false, yscale=:log10,
    xlabel=&quot;Sand Content (%)&quot;, ylabel=&quot;|ψ_sat| (mm)&quot;,
    title=&quot;Saturated Matric Potential (Eq. 5.74)&quot;)

clay_range = range(5.0, 60.0, length=100)
B_clay = 2.91 .+ 0.159 .* clay_range
p4 = plot(clay_range, B_clay, linewidth=2, label=false,
    xlabel=&quot;Clay Content (%)&quot;, ylabel=&quot;B&quot;,
    title=&quot;Clapp-Hornberger Exponent (Eq. 5.72)&quot;)

p = plot(p1, p2, p3, p4, layout=(2, 2), size=(800, 600))
p</code></pre><img src="14b01c79.svg" alt="Example block output"/><p>Sandy soils have higher saturated hydraulic conductivity (more permeable), lower porosity, and weaker matric potential (less capillary suction). The Clapp-Hornberger exponent B increases linearly with clay content, reflecting the broader pore-size distribution of clay-rich soils. These relationships correspond to Eqs. 5.70-5.74 of the CLMU technical note.</p><h3 id="Groundwater-Drainage-vs-Water-Table-Depth-(Eq.-5.140)"><a class="docs-heading-anchor" href="#Groundwater-Drainage-vs-Water-Table-Depth-(Eq.-5.140)">Groundwater Drainage vs Water Table Depth (Eq. 5.140)</a><a id="Groundwater-Drainage-vs-Water-Table-Depth-(Eq.-5.140)-1"></a><a class="docs-heading-anchor-permalink" href="#Groundwater-Drainage-vs-Water-Table-Depth-(Eq.-5.140)" title="Permalink"></a></h3><p>Sub-surface drainage as an exponential function of water table depth, modified by the frozen soil impermeable fraction (cf. Eq. 5.140, p. 142).</p><pre><code class="language-julia hljs">sys_dr = GroundwaterDrainage()
compiled_dr = mtkcompile(sys_dr)

zv_range = range(0.0, 5.0, length=200)
prob_dr = ODEProblem(compiled_dr,
    [compiled_dr.z_v =&gt; 0.0, compiled_dr.f_ice_weighted =&gt; 0.0],
    (0.0, 1.0))

f_ice_values = [0.0, 0.25, 0.5, 0.75, 1.0]
p = plot(xlabel=&quot;Water Table Depth (m)&quot;,
    ylabel=&quot;Drainage Rate (kg m⁻² s⁻¹)&quot;,
    title=&quot;Sub-surface Drainage vs Water Table Depth (Eq. 5.140)&quot;,
    legend=:topright)

for f_ice in f_ice_values
    drain_vals = Float64[]
    for zv in zv_range
        pr = remake(prob_dr; p = [compiled_dr.z_v =&gt; zv,
                                   compiled_dr.f_ice_weighted =&gt; f_ice])
        sol = solve(pr)
        push!(drain_vals, sol[compiled_dr.q_drai][end])
    end
    plot!(p, zv_range, drain_vals, linewidth=2,
        label=&quot;f_ice = $(f_ice)&quot;)
end
p</code></pre><img src="e115f511.svg" alt="Example block output"/><p>Drainage decreases exponentially with water table depth (decay factor <span>$f_{drai} = 2.5$</span> m<span>$^{-1}$</span>), reaching the maximum rate of 5.5×10<span>$^{-3}$</span> kg m<span>$^{-2}$</span> s<span>$^{-1}$</span> at the surface. Frozen soil (higher <span>$f_{ice}$</span>) reduces drainage through the impermeable fraction <span>$f_{imp}$</span> (Eq. 5.141); fully frozen soil (<span>$f_{ice} = 1$</span>) eliminates drainage entirely.</p><h3 id="Water-Table-Depth-vs-Aquifer-Storage-(Eq.-5.146)"><a class="docs-heading-anchor" href="#Water-Table-Depth-vs-Aquifer-Storage-(Eq.-5.146)">Water Table Depth vs Aquifer Storage (Eq. 5.146)</a><a id="Water-Table-Depth-vs-Aquifer-Storage-(Eq.-5.146)-1"></a><a class="docs-heading-anchor-permalink" href="#Water-Table-Depth-vs-Aquifer-Storage-(Eq.-5.146)" title="Permalink"></a></h3><p>Water table depth as a function of aquifer water storage, for a soil column with bottom interface at 3.5 m depth (cf. Eq. 5.146, p. 143).</p><pre><code class="language-julia hljs">sys_wt = WaterTableDepth()
compiled_wt = mtkcompile(sys_wt)

wa_range = range(0.0, 6000.0, length=200)
zv_vals = Float64[]

prob_wt = ODEProblem(compiled_wt,
    [compiled_wt.z_h_bottom =&gt; 3.5, compiled_wt.W_a =&gt; 0.0],
    (0.0, 1.0))

for wa in wa_range
    p = remake(prob_wt; p = [compiled_wt.W_a =&gt; wa])
    sol = solve(p)
    push!(zv_vals, sol[compiled_wt.z_v][end])
end

p = plot(wa_range, zv_vals, linewidth=2, label=false,
    xlabel=&quot;Aquifer Water Storage W_a (kg/m²)&quot;,
    ylabel=&quot;Water Table Depth z_v (m)&quot;,
    title=&quot;Water Table Depth vs Aquifer Storage (Eq. 5.146)&quot;,
    yflip=true)
hline!(p, [0.05], linestyle=:dash, color=:red, label=&quot;z_v min (0.05 m)&quot;)
hline!(p, [80.0], linestyle=:dash, color=:blue, label=&quot;z_v max (80 m)&quot;)
p</code></pre><img src="bfe714d2.svg" alt="Example block output"/><p>The water table depth decreases (rises) linearly with increasing aquifer water storage according to <span>$z_v = z_{h,bottom} + 25 - W_a / (\rho_{liq} \cdot S_y)$</span>, with specific yield <span>$S_y = 0.2$</span>. The water table depth is clamped between 0.05 m and 80 m. For the configuration shown (<span>$z_{h,bottom} = 3.5$</span> m), at <span>$W_a = 0$</span> the water table is at 28.5 m depth, and it reaches the minimum depth of 0.05 m when <span>$W_a \approx 5690$</span> kg/m².</p><h3 id="Snow-Layer-Combination-Enthalpy-Conservation-(Eq.-5.41)"><a class="docs-heading-anchor" href="#Snow-Layer-Combination-Enthalpy-Conservation-(Eq.-5.41)">Snow Layer Combination - Enthalpy Conservation (Eq. 5.41)</a><a id="Snow-Layer-Combination-Enthalpy-Conservation-(Eq.-5.41)-1"></a><a class="docs-heading-anchor-permalink" href="#Snow-Layer-Combination-Enthalpy-Conservation-(Eq.-5.41)" title="Permalink"></a></h3><p>Temperature of a combined snow layer from two layers with different temperatures, demonstrating enthalpy conservation (Eqs. 5.38-5.42, p. 122).</p><pre><code class="language-julia hljs">sys_comb = SnowLayerCombination()
compiled_comb = mtkcompile(sys_comb)

T_f = 273.15
T2_range = range(245.0, 273.0, length=100)
Tc_vals = Float64[]

prob_comb = ODEProblem(compiled_comb,
    [compiled_comb.Δz_1 =&gt; 0.05, compiled_comb.Δz_2 =&gt; 0.1,
     compiled_comb.w_liq_1 =&gt; 0.5, compiled_comb.w_liq_2 =&gt; 1.0,
     compiled_comb.w_ice_1 =&gt; 3.0, compiled_comb.w_ice_2 =&gt; 5.0,
     compiled_comb.T_1 =&gt; 270.0, compiled_comb.T_2 =&gt; 260.0],
    (0.0, 1.0))

for T2 in T2_range
    p = remake(prob_comb; p = [compiled_comb.T_2 =&gt; T2])
    sol = solve(p)
    push!(Tc_vals, sol[compiled_comb.T_c][end])
end

p = plot(T2_range, Tc_vals, linewidth=2, label=&quot;T_combined&quot;,
    xlabel=&quot;Layer 2 Temperature (K)&quot;,
    ylabel=&quot;Combined Temperature (K)&quot;,
    title=&quot;Snow Layer Combination Temperature (Eq. 5.41)&quot;)
hline!(p, [270.0], linestyle=:dash, color=:gray, label=&quot;T_1 = 270 K&quot;)
plot!(p, T2_range, T2_range, linestyle=:dot, color=:gray, label=&quot;T_2&quot;)
p</code></pre><img src="5a6a0900.svg" alt="Example block output"/><p>The combined temperature lies between the two layer temperatures, weighted by the thermal mass (ice and liquid heat capacities) of each layer. Because layer 2 has more mass (5 kg/m² ice + 1 kg/m² liquid vs 3 + 0.5 for layer 1), the combined temperature is closer to <span>$T_2$</span> than <span>$T_1$</span>.</p><h3 id="Richards&#39;-Equation-Wetting-Front-Propagation-(Eq.-5.59)"><a class="docs-heading-anchor" href="#Richards&#39;-Equation-Wetting-Front-Propagation-(Eq.-5.59)">Richards&#39; Equation - Wetting Front Propagation (Eq. 5.59)</a><a id="Richards&#39;-Equation-Wetting-Front-Propagation-(Eq.-5.59)-1"></a><a class="docs-heading-anchor-permalink" href="#Richards&#39;-Equation-Wetting-Front-Propagation-(Eq.-5.59)" title="Permalink"></a></h3><p>Wetting front propagating downward through a soil column, driven by a wet Dirichlet boundary at the top and dry initial conditions. The soil column is discretized using MethodOfLines.jl.</p><pre><code class="language-julia hljs">using MethodOfLines, DomainSets

θ_sat_val = 0.489 - 0.00126 * 50.0
Δz_total = 2.0
N_layers = 15
θ_dry = 0.1 * θ_sat_val
θ_wet = 0.8 * θ_sat_val

result_infl = RichardsEquation(;
    N_layers = N_layers, Δz_total = Δz_total,
    pct_sand = 50.0, pct_clay = 20.0,
    θ_top_val = θ_wet,
    θ_bottom_val = θ_dry,
    θ_init_val = θ_dry,
)

tspan = (0.0, 50000.0)
prob_infl = remake(result_infl.prob; tspan = tspan)
sol_infl = solve(prob_infl, saveat = 10000.0)
θ_mat_infl = sol_infl[result_infl.θ(result_infl.t_pde, result_infl.z_var)]

# Spatial grid points from the discretization
dz = Δz_total / N_layers
z_grid = range(dz / 2, Δz_total - dz / 2, length = size(θ_mat_infl, 2))

p = plot(xlabel = &quot;Volumetric Water Content (m³/m³)&quot;, ylabel = &quot;Depth (m)&quot;,
    title = &quot;Wetting Front Propagation (Eq. 5.59)&quot;,
    yflip = true, legend = :bottomleft)
for (j, t_val) in enumerate(sol_infl.t)
    plot!(p, θ_mat_infl[j, :], collect(z_grid), linewidth = 2,
        label = &quot;t = $(Int(t_val)) s&quot;, marker = :circle, markersize = 3)
end
vline!(p, [θ_sat_val], linestyle = :dash, color = :gray, label = &quot;θ_sat&quot;)
p</code></pre><img src="f250aa38.svg" alt="Example block output"/><p>The wetting front propagates downward over time as the wet top boundary drives water into the dry soil column through both capillary diffusion and gravity. The front moves faster through sandy soils (higher <span>$k_{sat}$</span>) and slows as the soil approaches saturation.</p><h3 id="Richards&#39;-Equation-Gravity-Drainage-(Eq.-5.68)"><a class="docs-heading-anchor" href="#Richards&#39;-Equation-Gravity-Drainage-(Eq.-5.68)">Richards&#39; Equation - Gravity Drainage (Eq. 5.68)</a><a id="Richards&#39;-Equation-Gravity-Drainage-(Eq.-5.68)-1"></a><a class="docs-heading-anchor-permalink" href="#Richards&#39;-Equation-Gravity-Drainage-(Eq.-5.68)" title="Permalink"></a></h3><p>Starting from a moderately wet uniform initial condition with equal Dirichlet boundary conditions at top and bottom, the soil column evolves under the combined effects of nonlinear diffusion and gravity drainage.</p><pre><code class="language-julia hljs">θ_mid = 0.4 * θ_sat_val

result_grav = RichardsEquation(;
    N_layers = N_layers, Δz_total = Δz_total,
    pct_sand = 50.0, pct_clay = 20.0,
    θ_top_val = θ_mid,
    θ_bottom_val = θ_mid,
    θ_init_val = θ_mid,
)

tspan_grav = (0.0, 200000.0)
prob_grav = remake(result_grav.prob; tspan = tspan_grav)
sol_grav = solve(prob_grav, saveat = 40000.0)
θ_mat_grav = sol_grav[result_grav.θ(result_grav.t_pde, result_grav.z_var)]

p = plot(xlabel = &quot;Volumetric Water Content (m³/m³)&quot;, ylabel = &quot;Depth (m)&quot;,
    title = &quot;Gravity Drainage (Eq. 5.68)&quot;,
    yflip = true, legend = :bottomleft)
for (j, t_val) in enumerate(sol_grav.t)
    plot!(p, θ_mat_grav[j, :], collect(z_grid), linewidth = 2,
        label = &quot;t = $(Int(t_val)) s&quot;, marker = :circle, markersize = 3)
end
vline!(p, [θ_sat_val], linestyle = :dash, color = :gray, label = &quot;θ_sat&quot;)
p</code></pre><img src="7e9b4b71.svg" alt="Example block output"/><p>With equal boundary conditions and gravity, the system evolves toward a steady state where the diffusive flux balances the gravitational flux. The rate of redistribution depends on the hydraulic conductivity, which is a strong function of water content through the Clapp-Hornberger relation (Eq. 5.69).</p><h3 id="Interface-Hydraulic-Conductivity-vs-Saturation-(Eq.-5.69)"><a class="docs-heading-anchor" href="#Interface-Hydraulic-Conductivity-vs-Saturation-(Eq.-5.69)">Interface Hydraulic Conductivity vs Saturation (Eq. 5.69)</a><a id="Interface-Hydraulic-Conductivity-vs-Saturation-(Eq.-5.69)-1"></a><a class="docs-heading-anchor-permalink" href="#Interface-Hydraulic-Conductivity-vs-Saturation-(Eq.-5.69)" title="Permalink"></a></h3><p>Hydraulic conductivity at a layer interface as a function of saturation degree for different Clapp-Hornberger exponents B, showing the strong nonlinearity (cf. Eq. 5.69, p. 131). The frozen fraction is set to zero.</p><pre><code class="language-julia hljs">sys_ihc = InterfaceHydraulicConductivity()
compiled_ihc = mtkcompile(sys_ihc)

k_sat = 1.0e-5  # m/s
θ_sat = 0.4     # m³/m³
sat_range = range(0.05, 1.0, length = 100)

prob_ihc = ODEProblem(compiled_ihc, [
    compiled_ihc.k_sat_h =&gt; k_sat, compiled_ihc.θ_upper =&gt; 0.1,
    compiled_ihc.θ_lower =&gt; 0.1,
    compiled_ihc.θ_sat_upper =&gt; θ_sat, compiled_ihc.θ_sat_lower =&gt; θ_sat,
    compiled_ihc.B_i =&gt; 6.0, compiled_ihc.f_frz_upper =&gt; 0.0,
    compiled_ihc.f_frz_lower =&gt; 0.0,
], (0.0, 1.0))

p = plot(xlabel = &quot;Saturation Degree (θ/θ_sat)&quot;,
    ylabel = &quot;k/k_sat&quot;,
    title = &quot;Interface Hydraulic Conductivity (Eq. 5.69)&quot;,
    yscale = :log10, legend = :bottomright)

for B in [3.0, 6.0, 9.0, 12.0]
    k_vals = Float64[]
    for s in sat_range
        θ_val = s * θ_sat
        pr = remake(prob_ihc; p = [
            compiled_ihc.θ_upper =&gt; θ_val, compiled_ihc.θ_lower =&gt; θ_val,
            compiled_ihc.B_i =&gt; B,
        ])
        sol = solve(pr)
        push!(k_vals, sol[compiled_ihc.k_h][end] / k_sat)
    end
    plot!(p, collect(sat_range), k_vals, linewidth = 2, label = &quot;B = $(Int(B))&quot;)
end
p</code></pre><img src="f256a6db.svg" alt="Example block output"/><p>Higher Clapp-Hornberger exponents (clay-rich soils) produce steeper conductivity curves, reflecting the narrower pore-size distribution and stronger moisture dependence of hydraulic conductivity. At full saturation (<span>$\theta/\theta_{sat} = 1$</span>), the conductivity equals <span>$k_{sat}$</span> regardless of B.</p><h3 id="Impervious-Surface-Runoff-vs-Precipitation-(Eq.-5.47)"><a class="docs-heading-anchor" href="#Impervious-Surface-Runoff-vs-Precipitation-(Eq.-5.47)">Impervious Surface Runoff vs Precipitation (Eq. 5.47)</a><a id="Impervious-Surface-Runoff-vs-Precipitation-(Eq.-5.47)-1"></a><a class="docs-heading-anchor-permalink" href="#Impervious-Surface-Runoff-vs-Precipitation-(Eq.-5.47)" title="Permalink"></a></h3><p>Runoff from impervious surfaces (roof and impervious road) as a function of precipitation rate, for different initial surface water contents. The ponding limit is 1 kg/m² (cf. Eqs. 5.47-5.48, pp. 124-125).</p><pre><code class="language-julia hljs">sys_ir = ImperviousRunoff()
compiled_ir = mtkcompile(sys_ir)

q_range = range(0.0, 5.0, length = 200)

prob_ir = ODEProblem(compiled_ir, [
    compiled_ir.w_liq_1 =&gt; 0.5, compiled_ir.q_liq_0 =&gt; 0.0,
    compiled_ir.q_seva =&gt; 0.0, compiled_ir.has_snow =&gt; 0.0,
], (0.0, 1.0))

p = plot(xlabel = &quot;Liquid Precipitation Rate (kg m⁻² s⁻¹)&quot;,
    ylabel = &quot;Surface Runoff (kg m⁻² s⁻¹)&quot;,
    title = &quot;Impervious Surface Runoff (Eq. 5.47)&quot;,
    legend = :topleft)

for w0 in [0.0, 0.5, 1.0, 1.5]
    runoff_vals = Float64[]
    for q in q_range
        pr = remake(prob_ir; p = [compiled_ir.w_liq_1 =&gt; w0, compiled_ir.q_liq_0 =&gt; q])
        sol = solve(pr)
        push!(runoff_vals, sol[compiled_ir.q_over][end])
    end
    plot!(p, collect(q_range), runoff_vals, linewidth = 2,
        label = &quot;w_liq = $(w0) kg/m²&quot;)
end
plot!(p, q_range, q_range, linestyle = :dash, color = :gray, label = &quot;1:1 line&quot;)
p</code></pre><img src="e9c8098f.svg" alt="Example block output"/><p>When surface water exceeds the ponding limit (1 kg/m²), any additional input becomes runoff immediately. Higher initial surface water content (<span>$w_{liq,1}$</span>) shifts the runoff curve to the left, reflecting less available storage. The dashed 1:1 line represents the theoretical maximum when all precipitation becomes runoff.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../roof_wall_road_snow_temperatures/">« Roof, Wall, Road, Snow Temperatures</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Friday 20 February 2026 03:57">Friday 20 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
