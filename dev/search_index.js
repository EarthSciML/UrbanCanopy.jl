var documenterSearchIndex = {"docs":
[{"location":"api/#API-Reference","page":"API","title":"API Reference","text":"","category":"section"},{"location":"api/#UrbanCanopy.CLMUAtmosphere-Tuple{}","page":"API","title":"UrbanCanopy.CLMUAtmosphere","text":"CLMUAtmosphere(; name=:CLMUAtmosphere)\n\nAtmospheric interface for the Community Land Model Urban (CLMU) parameterization. Computes atmospheric density, vapor pressure, and reference height from atmospheric forcing variables, following Chapter 1 of Oleson et al. (2010).\n\nThe CLMU represents the urban surface using a canyon concept (Oke, 1987) consisting of a canyon floor of width W bordered by two facing buildings of height H. The urban canyon is divided into five columns: roof, sunlit wall, shaded wall, pervious road, and impervious road. This component defines the atmospheric forcing interface and the diagnostic equations that connect atmospheric model variables to the urban canopy model.\n\nReference: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp.\n\n\n\n\n\n","category":"method"},{"location":"clmu_introduction/#CLMU-Introduction:-Atmospheric-Interface","page":"CLMU Introduction","title":"CLMU Introduction: Atmospheric Interface","text":"","category":"section"},{"location":"clmu_introduction/#Overview","page":"CLMU Introduction","title":"Overview","text":"The Community Land Model Urban (CLMU) parameterization provides a physically-based representation of urban surfaces for use within the Community Land Model (CLM4). Chapter 1 of the technical note introduces the model structure and defines the atmospheric interface: the forcing variables provided by the atmospheric model, the diagnostic equations for air density and vapor pressure, and the reference height computation.\n\nThe urban surface is represented using the canyon concept (Oke, 1987), where the considerable complexity of the urban surface is reduced to a single urban canyon consisting of a canyon floor of width W bordered by two facing buildings of height H. The urban canyon is divided into five columns: roof, sunlit wall, shaded wall, pervious road, and impervious road.\n\nReference: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp.","category":"section"},{"location":"clmu_introduction/#Implementation","page":"CLMU Introduction","title":"Implementation","text":"The CLMUAtmosphere component implements three diagnostic equations from Chapter 1:\n\nAtmospheric vapor pressure from specific humidity and pressure\nAir density from pressure, vapor pressure, and temperature\nReference height for flux computations","category":"section"},{"location":"clmu_introduction/#State-Variables","page":"CLMU Introduction","title":"State Variables","text":"using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities\nusing UrbanCanopy\n\nsys = CLMUAtmosphere()\n\nvars = unknowns(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(v, escape = false)) for v in vars],\n    :Units => [dimension(ModelingToolkit.get_unit(v)) for v in vars],\n    :Description => [ModelingToolkit.getdescription(v) for v in vars]\n)","category":"section"},{"location":"clmu_introduction/#Parameters","page":"CLMU Introduction","title":"Parameters","text":"params = parameters(sys)\nDataFrame(\n    :Name => [string(Symbolics.tosymbol(p, escape = false)) for p in params],\n    :Units => [dimension(ModelingToolkit.get_unit(p)) for p in params],\n    :Description => [ModelingToolkit.getdescription(p) for p in params]\n)","category":"section"},{"location":"clmu_introduction/#Equations","page":"CLMU Introduction","title":"Equations","text":"eqs = equations(sys)","category":"section"},{"location":"clmu_introduction/#Table-1.1:-Atmospheric-Input-to-Urban-Model","page":"CLMU Introduction","title":"Table 1.1: Atmospheric Input to Urban Model","text":"The atmospheric model provides the following forcing variables to the urban model at each time step (Table 1.1, p. 16). The reference height z_atm is the height above the surface defined as the roughness length z_0 plus displacement height z_d, so the reference height used for flux computations is z_atm = z_atm + z_0 + z_d.\n\nVariable Symbol Units\nReference height z_atm m\nZonal wind at z_atm u_atm m/s\nMeridional wind at z_atm v_atm m/s\nPotential temperature theta_atm K\nSpecific humidity at z_atm q_atm kg/kg\nPressure at z_atm P_atm Pa\nTemperature at z_atm T_atm K\nIncident longwave radiation L_atmdownarrow W/m²\nLiquid precipitation q_rain kg/(m²·s)\nSolid precipitation q_sno kg/(m²·s)\nDirect beam visible solar radiation S_atmdownarrow^mu_vis W/m²\nDirect beam near-infrared solar radiation S_atmdownarrow^mu_nir W/m²\nDiffuse visible solar radiation S_atmdownarrow_vis W/m²\nDiffuse near-infrared solar radiation S_atmdownarrow_nir W/m²\nCarbon dioxide (CO₂) concentration c_a ppmv\nAerosol deposition rate D_sp kg/(m²·s)\nNitrogen deposition rate NF_ndep_sminn g(N)/(m²·yr)\n\nNote: CO₂ concentration, aerosol deposition rate, and nitrogen deposition rate are provided by the atmospheric model but not used by the urban model.","category":"section"},{"location":"clmu_introduction/#Table-1.2:-Urban-Model-Output-to-Atmospheric-Model","page":"CLMU Introduction","title":"Table 1.2: Urban Model Output to Atmospheric Model","text":"The urban model provides the following area-averaged fluxes to the atmospheric model (Table 1.2, p. 18).\n\nVariable Symbol Units\nLatent heat flux lambda E W/m²\nSensible heat flux H W/m²\nWater vapor flux E mm/s\nZonal momentum flux tau_x kg/(m·s²)\nMeridional momentum flux tau_y kg/(m·s²)\nEmitted longwave radiation Luparrow W/m²\nDirect beam visible albedo Iuparrow^mu_vis -\nDirect beam near-infrared albedo Iuparrow^mu_nir -\nDiffuse visible albedo Iuparrow_vis -\nDiffuse near-infrared albedo Iuparrow_nir -\nAbsorbed solar radiation vecS W/m²\nRadiative temperature T_rad K\nTemperature at 2 meter height T_2m K\nSpecific humidity at 2 meter height q_2m kg/kg\nSnow water equivalent W_sno m\nAerodynamic resistance r_am s/m\nFriction velocity u_* m/s\nDust flux F_j kg/(m²·s)\nNet ecosystem exchange NEE kgCO₂/(m²·s)\n\nNote: lambda is either the latent heat of vaporization lambda_vap or latent heat of sublimation lambda_sub (Table 1.4) depending on the thermal state of surface water on the roof, pervious and impervious road. Dust flux and net ecosystem exchange are set to zero for urban areas.","category":"section"},{"location":"clmu_introduction/#Table-1.3:-Input-Data-Required-for-the-Urban-Model","page":"CLMU Introduction","title":"Table 1.3: Input Data Required for the Urban Model","text":"Required input data for urban landunits are listed in Table 1.3 (p. 23). This data is provided by the surface dataset at the required spatial resolution.\n\nData Symbol Units\nPercent urban - %\nCanyon height to width ratio HW -\nRoof fraction W_roof -\nPervious road fraction f_prvrd -\nEmissivity of roof varepsilon_roof -\nEmissivity of impervious road varepsilon_imprvrd -\nEmissivity of pervious road varepsilon_prvrd -\nEmissivity of walls varepsilon_wall -\nBuilding height H m\nRoof albedo (visible direct/diffuse, near-infrared direct/diffuse) alpha_roof -\nWall albedo (visible direct/diffuse, near-infrared direct/diffuse) alpha_walls -\nImpervious road albedo (visible direct/diffuse, near-infrared direct/diffuse) alpha_imprvrd -\nPervious road albedo (visible direct/diffuse, near-infrared direct/diffuse) alpha_prvrd -\nRoof thermal conductivity lambda_roofi W/(m·K)\nWall thermal conductivity lambda_walli W/(m·K)\nImpervious road thermal conductivity lambda_imprvrdi W/(m·K)\nPervious road thermal conductivity lambda_prvrdi W/(m·K)\nRoof volumetric heat capacity c_roofi J/(m³·K)\nWall volumetric heat capacity c_walli J/(m³·K)\nImpervious road volumetric heat capacity c_imprvrdi J/(m³·K)\nPervious road volumetric heat capacity c_prvrdi J/(m³·K)\nMaximum interior building temperature T_iBmax K\nMinimum interior building temperature T_iBmin K\nHeight of wind source in canyon H_w m\nNumber of impervious road layers N_imprvrd -\nWall thickness Delta z_wall m\nRoof thickness Delta z_roof m\nPercent sand, percent clay of pervious road (soil) %sand, %clay %\nGrid cell latitude and longitude phi theta degrees","category":"section"},{"location":"clmu_introduction/#Table-1.4:-Physical-Constants","page":"CLMU Introduction","title":"Table 1.4: Physical Constants","text":"Physical constants used by the CLMU, shared by all components of CCSM (Table 1.4, p. 25).\n\nConstant Symbol Value Units\nPi pi 3.14159265358979323846 -\nAcceleration of gravity g 9.80616 m/s²\nStandard pressure P_std 101325 Pa\nStefan-Boltzmann constant sigma 5.67 × 10⁻⁸ W/(m²·K⁴)\nBoltzmann constant kappa 1.38065 × 10⁻²³ J/K\nAvogadro's number N_A 6.02214 × 10²⁶ molecule/kmol\nUniversal gas constant R_gas N_A kappa J/(K·kmol)\nMolecular weight of dry air MW_da 28.966 kg/kmol\nDry air gas constant R_da R_gasMW_da J/(K·kg)\nMolecular weight of water vapor MW_wv 18.016 kg/kmol\nWater vapor gas constant R_wv R_gasMW_wv J/(K·kg)\nVon Karman constant k 0.4 -\nFreezing temperature of fresh water T_f 273.15 K\nDensity of liquid water rho_liq 1000 kg/m³\nDensity of ice rho_ice 917 kg/m³\nSpecific heat capacity of dry air C_p 1.00464 × 10³ J/(kg·K)\nSpecific heat capacity of water C_liq 4.188 × 10³ J/(kg·K)\nSpecific heat capacity of ice C_ice 2.11727 × 10³ J/(kg·K)\nLatent heat of vaporization lambda_vap 2.501 × 10⁶ J/kg\nLatent heat of fusion L_f 3.337 × 10⁵ J/kg\nLatent heat of sublimation lambda_sub lambda_vap + L_f J/kg\nThermal conductivity of water lambda_liq 0.6 W/(m·K)\nThermal conductivity of ice lambda_ice 2.29 W/(m·K)\nThermal conductivity of air lambda_air 0.023 W/(m·K)\nRadius of the earth R_e 6.37122 × 10⁶ m","category":"section"},{"location":"clmu_introduction/#Analysis","page":"CLMU Introduction","title":"Analysis","text":"","category":"section"},{"location":"clmu_introduction/#Air-Density-vs.-Temperature","page":"CLMU Introduction","title":"Air Density vs. Temperature","text":"The air density equation from Chapter 1 (p. 17) computes atmospheric density as a function of pressure, temperature, and vapor pressure. For dry air, this reduces to the ideal gas law: rho = P  (R_da T). The following figure shows how air density varies with temperature at standard pressure for both dry and moist air.\n\nusing OrdinaryDiffEqDefault\nusing Plots\n\ncompiled = mtkcompile(sys)\n\nT_range = 250.0:5.0:320.0\nρ_dry = Float64[]\nρ_moist = Float64[]\n\nfor T_val in T_range\n    prob = ODEProblem(\n        compiled,\n        Dict(\n            compiled.q_atm => 0.0,\n            compiled.P_atm => 101325.0,\n            compiled.T_atm => T_val,\n            compiled.z_prime_atm => 30.0,\n            compiled.z_0 => 1.0,\n            compiled.z_d => 5.0,\n        ),\n        (0.0, 1.0),\n    )\n    sol = solve(prob)\n    push!(ρ_dry, sol[compiled.ρ_atm][end])\n\n    prob_m = ODEProblem(\n        compiled,\n        Dict(\n            compiled.q_atm => 0.015,\n            compiled.P_atm => 101325.0,\n            compiled.T_atm => T_val,\n            compiled.z_prime_atm => 30.0,\n            compiled.z_0 => 1.0,\n            compiled.z_d => 5.0,\n        ),\n        (0.0, 1.0),\n    )\n    sol_m = solve(prob_m)\n    push!(ρ_moist, sol_m[compiled.ρ_atm][end])\nend\n\np = plot(T_range, ρ_dry, label=\"Dry air (q=0)\", xlabel=\"Temperature (K)\",\n    ylabel=\"Air density (kg/m³)\", title=\"Air Density vs Temperature at P=101325 Pa\",\n    linewidth=2, legend=:topright)\nplot!(p, T_range, ρ_moist, label=\"Moist air (q=0.015 kg/kg)\", linewidth=2, linestyle=:dash)\np\n\nAt all temperatures, moist air is less dense than dry air at the same pressure, consistent with the lower molecular weight of water vapor (18.016 kg/kmol) compared to dry air (28.966 kg/kmol).","category":"section"},{"location":"clmu_introduction/#Vapor-Pressure-vs.-Specific-Humidity","page":"CLMU Introduction","title":"Vapor Pressure vs. Specific Humidity","text":"The vapor pressure equation relates the atmospheric vapor pressure to specific humidity and total pressure. This relationship is approximately linear for small specific humidities but becomes nonlinear at higher moisture content.\n\nq_range = 0.0:0.001:0.03\ne_vals = Float64[]\n\nfor q_val in q_range\n    prob = ODEProblem(\n        compiled,\n        Dict(\n            compiled.q_atm => q_val,\n            compiled.P_atm => 101325.0,\n            compiled.T_atm => 293.15,\n            compiled.z_prime_atm => 30.0,\n            compiled.z_0 => 1.0,\n            compiled.z_d => 5.0,\n        ),\n        (0.0, 1.0),\n    )\n    sol = solve(prob)\n    push!(e_vals, sol[compiled.e_atm][end])\nend\n\np = plot(q_range .* 1000, e_vals, xlabel=\"Specific humidity (g/kg)\",\n    ylabel=\"Vapor pressure (Pa)\",\n    title=\"Atmospheric Vapor Pressure vs Specific Humidity\\nat P=101325 Pa\",\n    linewidth=2, legend=false)\np","category":"section"},{"location":"clmu_introduction/#UrbanCanopy.CLMUAtmosphere","page":"CLMU Introduction","title":"UrbanCanopy.CLMUAtmosphere","text":"CLMUAtmosphere(; name=:CLMUAtmosphere)\n\nAtmospheric interface for the Community Land Model Urban (CLMU) parameterization. Computes atmospheric density, vapor pressure, and reference height from atmospheric forcing variables, following Chapter 1 of Oleson et al. (2010).\n\nThe CLMU represents the urban surface using a canyon concept (Oke, 1987) consisting of a canyon floor of width W bordered by two facing buildings of height H. The urban canyon is divided into five columns: roof, sunlit wall, shaded wall, pervious road, and impervious road. This component defines the atmospheric forcing interface and the diagnostic equations that connect atmospheric model variables to the urban canopy model.\n\nReference: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp.\n\n\n\n\n\n","category":"function"},{"location":"#UrbanCanopy.jl","page":"Home","title":"UrbanCanopy.jl","text":"Documentation for UrbanCanopy.jl.\n\nUrbanCanopy.jl implements urban canopy processes for the EarthSciML framework, including urban heat island effects, building energy balance, urban surface exchange, anthropogenic heat fluxes, and urban boundary layer interactions.\n\n","category":"section"}]
}
