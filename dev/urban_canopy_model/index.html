<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Urban Canopy Model · UrbanCanopy.jl</title><meta name="title" content="Urban Canopy Model · UrbanCanopy.jl"/><meta property="og:title" content="Urban Canopy Model · UrbanCanopy.jl"/><meta property="twitter:title" content="Urban Canopy Model · UrbanCanopy.jl"/><meta name="description" content="Documentation for UrbanCanopy.jl."/><meta property="og:description" content="Documentation for UrbanCanopy.jl."/><meta property="twitter:description" content="Documentation for UrbanCanopy.jl."/><meta property="og:url" content="https://urbancanopy.earthsci.dev/urban_canopy_model/"/><meta property="twitter:url" content="https://urbancanopy.earthsci.dev/urban_canopy_model/"/><link rel="canonical" href="https://urbancanopy.earthsci.dev/urban_canopy_model/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">UrbanCanopy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../clmu_introduction/">CLMU Introduction</a></li><li><a class="tocitem" href="../offline_mode/">Offline Mode</a></li><li><a class="tocitem" href="../albedos_radiative_fluxes/">Albedos and Radiative Fluxes</a></li><li><a class="tocitem" href="../heat_momentum_fluxes/">Heat and Momentum Fluxes</a></li><li><a class="tocitem" href="../roof_wall_road_snow_temperatures/">Roof, Wall, Road, Snow Temperatures</a></li><li><a class="tocitem" href="../hydrology/">Hydrology</a></li><li class="is-active"><a class="tocitem" href>Urban Canopy Model</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Urban Canopy Model</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Urban Canopy Model</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/main/docs/src/urban_canopy_model.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Urban-Canopy-Model"><a class="docs-heading-anchor" href="#Urban-Canopy-Model">Urban Canopy Model</a><a id="Urban-Canopy-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Urban-Canopy-Model" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The <code>UrbanCanopyModel</code> is the top-level composed diagnostic model for the Community Land Model Urban (CLMU) parameterization. It wires together four subsystem components (<a href="../offline_mode/#UrbanCanopy.OfflineModeForcing"><code>OfflineModeForcing</code></a>, <a href="../clmu_introduction/#UrbanCanopy.CLMUAtmosphere"><code>CLMUAtmosphere</code></a>, <a href="../albedos_radiative_fluxes/#UrbanCanopy.UrbanRadiation"><code>UrbanRadiation</code></a>, and <a href="../heat_momentum_fluxes/#UrbanCanopy.HeatMomentumFluxes"><code>HeatMomentumFluxes</code></a>) into a single system that can be driven by prescribing meteorological forcing and surface conditions.</p><p>In this diagnostic configuration, surface temperatures (roof, walls, roads) are prescribed as parameters rather than computed prognostically. The model computes urban canopy layer (UCL) air temperature, sensible and latent heat fluxes, and radiation budgets.</p><p><strong>Reference</strong>: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp.</p><article><details class="docstring" open="true"><summary id="UrbanCanopy.UrbanCanopyModel"><a class="docstring-binding" href="#UrbanCanopy.UrbanCanopyModel"><code>UrbanCanopy.UrbanCanopyModel</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">UrbanCanopyModel(; name=:UrbanCanopyModel)</code></pre><p>Top-level composed diagnostic urban canopy model following the Community Land Model Urban (CLMU) parameterization of Oleson et al. (2010).</p><p>This component wires together the four diagnostic CLMU subsystems:</p><ul><li><a href="../offline_mode/#UrbanCanopy.OfflineModeForcing"><code>OfflineModeForcing</code></a>: Partitions raw meteorological forcing into derived quantities</li><li><a href="../clmu_introduction/#UrbanCanopy.CLMUAtmosphere"><code>CLMUAtmosphere</code></a>: Computes atmospheric density, vapor pressure, and reference height</li><li><a href="../albedos_radiative_fluxes/#UrbanCanopy.UrbanRadiation"><code>UrbanRadiation</code></a>: Computes absorbed/reflected solar and longwave radiation</li><li><a href="../heat_momentum_fluxes/#UrbanCanopy.HeatMomentumFluxes"><code>HeatMomentumFluxes</code></a>: Computes sensible/latent heat fluxes and UCL air temperature</li></ul><p>Surface temperatures are prescribed as parameters (diagnostic mode). The prognostic thermal solvers (Chapter 4) and hydrology (Chapter 5) are left for future work.</p><p>Key outputs (accessed via subsystem dot notation):</p><ul><li><code>flux.T_ac</code> [K]: Urban canopy layer air temperature</li><li><code>flux.q_ac</code> [kg/kg]: UCL specific humidity</li><li><code>flux.H_total</code> [W/m^2]: Total sensible heat flux</li><li><code>flux.E_total</code> [kg/(m^2*s)]: Total evaporation</li><li><code>rad.S_net_total</code> [W/m^2]: Net absorbed solar radiation</li><li><code>rad.L_net_total</code> [W/m^2]: Net longwave radiation</li></ul><p><strong>Reference</strong>: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/9200edd4f15609f20339d3a7d104de8064544310/src/urban_canopy_model.jl#L13-L40">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><h3 id="Creating-the-System"><a class="docs-heading-anchor" href="#Creating-the-System">Creating the System</a><a id="Creating-the-System-1"></a><a class="docs-heading-anchor-permalink" href="#Creating-the-System" title="Permalink"></a></h3><pre><code class="language-julia hljs">using ModelingToolkit, UrbanCanopy, DynamicQuantities, DataFrames, Symbolics

sys = UrbanCanopyModel()</code></pre><h3 id="Top-Level-Parameters"><a class="docs-heading-anchor" href="#Top-Level-Parameters">Top-Level Parameters</a><a id="Top-Level-Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Top-Level-Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
parent_params = filter(p -&gt; !occursin(&quot;₊&quot;, string(Symbolics.tosymbol(p, escape=false))), params)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape=false)) for p in parent_params],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in parent_params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in parent_params]
)</code></pre><div><div style = "float: left;"><span>40×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">S_atm</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total incident solar radiation (Eq. 6.1 output)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">T_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">P_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Atmospheric specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">W_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Atmospheric wind speed</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">P_precip</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Total precipitation rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">z_0</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Roughness length</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">z_d</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Displacement height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">μ_zen</td><td style = "text-align: left;"></td><td style = "text-align: left;">Solar zenith angle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">H_W</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon height to width ratio H/W (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">W_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof fraction of urban surface (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">α_roof_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">α_roof_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">α_roof_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">α_roof_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">α_road_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">α_road_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">α_road_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">α_road_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">α_wall_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">α_wall_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">α_wall_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">α_wall_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">ε_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">ε_road</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">ε_wall</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">27</td><td style = "text-align: left;">T_g_roof</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Roof surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">28</td><td style = "text-align: left;">T_g_imprvrd</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Impervious road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">29</td><td style = "text-align: left;">T_g_sunwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Sunlit wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">30</td><td style = "text-align: left;">T_g_shdwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Shaded wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">31</td><td style = "text-align: left;">H_canyon</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Canyon (building/roof) height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">32</td><td style = "text-align: left;">f_prvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Fraction of road that is pervious (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">33</td><td style = "text-align: left;">H_w_est</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Height at which canyon wind speed is estimated</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">34</td><td style = "text-align: left;">T_g_prvrd</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Pervious road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">35</td><td style = "text-align: left;">q_g_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof surface saturated specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">36</td><td style = "text-align: left;">q_g_prvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Pervious road surface specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">37</td><td style = "text-align: left;">q_g_imprvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Impervious road surface saturated specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">38</td><td style = "text-align: left;">f_wet_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wetted fraction of roof (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">39</td><td style = "text-align: left;">f_wet_imprvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wetted fraction of impervious road (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">40</td><td style = "text-align: left;">ζ_in</td><td style = "text-align: left;"></td><td style = "text-align: left;">Monin-Obukhov stability parameter (dimensionless)</td></tr></tbody></table></div><h3 id="Subsystem-Variables"><a class="docs-heading-anchor" href="#Subsystem-Variables">Subsystem Variables</a><a id="Subsystem-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Subsystem-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape=false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>268×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">offline₊S_atm</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total incident solar radiation at model time step (Eq. 6.1 output)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">offline₊T_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">offline₊P_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">offline₊q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Atmospheric specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">offline₊W_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Atmospheric wind speed</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">offline₊P_precip</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Total precipitation rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">atmos₊z_prime_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Atmospheric reference height from atmospheric model</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">offline₊z_prime_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Atmospheric reference height (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">atmos₊T_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric temperature at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">atmos₊P_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric pressure at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">atmos₊q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Specific humidity at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">atmos₊z_0</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Roughness length</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">atmos₊z_d</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Displacement height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">14</td><td style = "text-align: left;">rad₊S_atm_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident direct beam visible solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">15</td><td style = "text-align: left;">offline₊S_atm_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam visible solar radiation (Eq. 6.2)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">16</td><td style = "text-align: left;">rad₊S_atm_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident direct beam NIR solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">17</td><td style = "text-align: left;">offline₊S_atm_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam near-infrared solar radiation (Eq. 6.3)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">18</td><td style = "text-align: left;">rad₊S_atm_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident diffuse visible solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">19</td><td style = "text-align: left;">offline₊S_atm_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse visible solar radiation (Eq. 6.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">20</td><td style = "text-align: left;">rad₊S_atm_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident diffuse NIR solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">21</td><td style = "text-align: left;">offline₊S_atm_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse near-infrared solar radiation (Eq. 6.5)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">22</td><td style = "text-align: left;">rad₊L_atm_down</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident longwave radiation from atmosphere</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">23</td><td style = "text-align: left;">offline₊L_atm_down</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Atmospheric downwelling longwave radiation (Eq. 6.9)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">24</td><td style = "text-align: left;">rad₊μ_zen</td><td style = "text-align: left;"></td><td style = "text-align: left;">Solar zenith angle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">25</td><td style = "text-align: left;">rad₊H_W</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon height to width ratio H/W (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">26</td><td style = "text-align: left;">rad₊W_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof fraction of urban surface (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">27</td><td style = "text-align: left;">rad₊α_roof_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">28</td><td style = "text-align: left;">rad₊α_roof_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">29</td><td style = "text-align: left;">rad₊α_roof_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">30</td><td style = "text-align: left;">rad₊α_roof_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">31</td><td style = "text-align: left;">rad₊α_road_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">32</td><td style = "text-align: left;">rad₊α_road_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">33</td><td style = "text-align: left;">rad₊α_road_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">34</td><td style = "text-align: left;">rad₊α_road_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">35</td><td style = "text-align: left;">rad₊α_wall_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">36</td><td style = "text-align: left;">rad₊α_wall_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">37</td><td style = "text-align: left;">rad₊α_wall_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">38</td><td style = "text-align: left;">rad₊α_wall_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">39</td><td style = "text-align: left;">rad₊ε_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">40</td><td style = "text-align: left;">rad₊ε_road</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">41</td><td style = "text-align: left;">rad₊ε_wall</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">42</td><td style = "text-align: left;">rad₊T_roof</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Roof surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">43</td><td style = "text-align: left;">rad₊T_road</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">44</td><td style = "text-align: left;">rad₊T_sunwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Sunlit wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">45</td><td style = "text-align: left;">rad₊T_shdwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Shaded wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">46</td><td style = "text-align: left;">flux₊u_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Zonal wind at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">47</td><td style = "text-align: left;">offline₊u_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Zonal wind component (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">48</td><td style = "text-align: left;">flux₊v_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Meridional wind at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">49</td><td style = "text-align: left;">offline₊v_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Meridional wind component (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">50</td><td style = "text-align: left;">flux₊θ_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric potential temperature (Eq. 3.8)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">51</td><td style = "text-align: left;">offline₊θ_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Potential temperature (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">52</td><td style = "text-align: left;">flux₊q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Atmospheric specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">53</td><td style = "text-align: left;">flux₊ρ_atm</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Atmospheric air density (Eq. 3.9)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">54</td><td style = "text-align: left;">atmos₊ρ_atm</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Atmospheric air density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">55</td><td style = "text-align: left;">flux₊z_atm_m</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for wind (momentum)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">56</td><td style = "text-align: left;">atmos₊z_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for flux computations</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">57</td><td style = "text-align: left;">flux₊z_atm_h</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for temperature (sensible heat)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">58</td><td style = "text-align: left;">flux₊z_atm_w</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for humidity (water vapor)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">59</td><td style = "text-align: left;">flux₊H_W</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon height to width ratio H/W (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">60</td><td style = "text-align: left;">flux₊H_canyon</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Canyon (building/roof) height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">61</td><td style = "text-align: left;">flux₊W_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof fraction of urban surface (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">62</td><td style = "text-align: left;">flux₊f_prvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Fraction of road that is pervious (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">63</td><td style = "text-align: left;">flux₊H_w_est</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Height at which canyon wind speed is estimated (Table 1.3)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">64</td><td style = "text-align: left;">flux₊T_g_roof</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Roof surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">65</td><td style = "text-align: left;">flux₊T_g_prvrd</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Pervious road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">66</td><td style = "text-align: left;">flux₊T_g_imprvrd</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Impervious road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">67</td><td style = "text-align: left;">flux₊T_g_sunwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Sunlit wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">68</td><td style = "text-align: left;">flux₊T_g_shdwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Shaded wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">69</td><td style = "text-align: left;">flux₊q_g_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof surface saturated specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">70</td><td style = "text-align: left;">flux₊q_g_prvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Pervious road surface specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">71</td><td style = "text-align: left;">flux₊q_g_imprvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Impervious road surface saturated specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">72</td><td style = "text-align: left;">flux₊f_wet_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wetted fraction of roof (Eqs. 3.82-3.83) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">73</td><td style = "text-align: left;">flux₊f_wet_imprvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wetted fraction of impervious road (Eqs. 3.82-3.83) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">74</td><td style = "text-align: left;">flux₊ζ_in</td><td style = "text-align: left;"></td><td style = "text-align: left;">Monin-Obukhov stability parameter ζ = (z_atm_m - d)/L, from iterative solution (Eqs. 3.47-3.50) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">75</td><td style = "text-align: left;">offline₊R_vis_raw</td><td style = "text-align: left;"></td><td style = "text-align: left;">Unclamped visible direct fraction (Eq. 6.7) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">76</td><td style = "text-align: left;">offline₊S_atm</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total incident solar radiation at model time step (Eq. 6.1 output)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">77</td><td style = "text-align: left;">offline₊R_nir_raw</td><td style = "text-align: left;"></td><td style = "text-align: left;">Unclamped NIR direct fraction (Eq. 6.8) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">78</td><td style = "text-align: left;">offline₊R_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Visible direct fraction, clamped to [0.01, 0.99] (Eq. 6.7) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">79</td><td style = "text-align: left;">offline₊R_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">NIR direct fraction, clamped to [0.01, 0.99] (Eq. 6.8) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">80</td><td style = "text-align: left;">offline₊S_atm_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam visible solar radiation (Eq. 6.2)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">81</td><td style = "text-align: left;">offline₊S_atm_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam near-infrared solar radiation (Eq. 6.3)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">82</td><td style = "text-align: left;">offline₊S_atm_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse visible solar radiation (Eq. 6.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">83</td><td style = "text-align: left;">offline₊S_atm_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse near-infrared solar radiation (Eq. 6.5)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">84</td><td style = "text-align: left;">offline₊e_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric vapor pressure (Eq. 6.10)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">85</td><td style = "text-align: left;">offline₊q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Atmospheric specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">86</td><td style = "text-align: left;">offline₊P_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">87</td><td style = "text-align: left;">offline₊L_atm_down</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Atmospheric downwelling longwave radiation (Eq. 6.9)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">88</td><td style = "text-align: left;">offline₊T_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">89</td><td style = "text-align: left;">offline₊f_P_raw</td><td style = "text-align: left;"></td><td style = "text-align: left;">Unclamped rain fraction (Eq. 6.13) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">90</td><td style = "text-align: left;">offline₊f_P</td><td style = "text-align: left;"></td><td style = "text-align: left;">Rain fraction, clamped to [0, 1] (Eq. 6.13) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">91</td><td style = "text-align: left;">offline₊q_rain</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Liquid precipitation rate (Eq. 6.11)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">92</td><td style = "text-align: left;">offline₊P_precip</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Total precipitation rate</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">93</td><td style = "text-align: left;">offline₊q_snow</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Solid precipitation rate (Eq. 6.12)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">94</td><td style = "text-align: left;">offline₊u_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Zonal wind component (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">95</td><td style = "text-align: left;">offline₊W_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Atmospheric wind speed</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">96</td><td style = "text-align: left;">offline₊v_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Meridional wind component (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">97</td><td style = "text-align: left;">offline₊θ_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Potential temperature (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">98</td><td style = "text-align: left;">offline₊z_prime_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Atmospheric reference height (p.149)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">99</td><td style = "text-align: left;">atmos₊e_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric vapor pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">100</td><td style = "text-align: left;">atmos₊q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Specific humidity at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">101</td><td style = "text-align: left;">atmos₊P_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric pressure at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">102</td><td style = "text-align: left;">atmos₊ρ_atm</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Atmospheric air density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">103</td><td style = "text-align: left;">atmos₊T_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric temperature at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">104</td><td style = "text-align: left;">atmos₊z_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for flux computations</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">105</td><td style = "text-align: left;">atmos₊z_prime_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Atmospheric reference height from atmospheric model</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">106</td><td style = "text-align: left;">atmos₊z_d</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Displacement height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">107</td><td style = "text-align: left;">atmos₊z_0</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Roughness length</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">108</td><td style = "text-align: left;">rad₊Ψ_sky_wall</td><td style = "text-align: left;"></td><td style = "text-align: left;">View factor: sky to wall (Eq. 2.24) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">109</td><td style = "text-align: left;">rad₊H_W</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon height to width ratio H/W (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">110</td><td style = "text-align: left;">rad₊Ψ_wall_sky</td><td style = "text-align: left;"></td><td style = "text-align: left;">View factor: wall to sky (Eq. 2.24) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">111</td><td style = "text-align: left;">rad₊Ψ_road_sky</td><td style = "text-align: left;"></td><td style = "text-align: left;">View factor: road to sky (Eq. 2.25) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">112</td><td style = "text-align: left;">rad₊Ψ_sky_road</td><td style = "text-align: left;"></td><td style = "text-align: left;">View factor: sky to road (Eq. 2.25) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">113</td><td style = "text-align: left;">rad₊Ψ_wall_road</td><td style = "text-align: left;"></td><td style = "text-align: left;">View factor: wall to road (Eq. 2.26) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">114</td><td style = "text-align: left;">rad₊Ψ_road_wall</td><td style = "text-align: left;"></td><td style = "text-align: left;">View factor: road to wall (Eq. 2.27) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">115</td><td style = "text-align: left;">rad₊Ψ_wall_wall</td><td style = "text-align: left;"></td><td style = "text-align: left;">View factor: wall to wall (Eq. 2.28) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">116</td><td style = "text-align: left;">rad₊T_rw</td><td style = "text-align: left;"></td><td style = "text-align: left;">Transport: wall to road = H/W * Ψ_wall_road (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">117</td><td style = "text-align: left;">rad₊T_wr</td><td style = "text-align: left;"></td><td style = "text-align: left;">Transport: road to wall = Ψ_road_wall / (H/W) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">118</td><td style = "text-align: left;">rad₊T_ww</td><td style = "text-align: left;"></td><td style = "text-align: left;">Transport: wall to wall = Ψ_wall_wall (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">119</td><td style = "text-align: left;">rad₊θ_0</td><td style = "text-align: left;"></td><td style = "text-align: left;">Critical canyon orientation angle (Eq. 2.11)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">120</td><td style = "text-align: left;">rad₊μ_zen</td><td style = "text-align: left;"></td><td style = "text-align: left;">Solar zenith angle</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">121</td><td style = "text-align: left;">rad₊S_sunwall_factor</td><td style = "text-align: left;"></td><td style = "text-align: left;">Sunlit wall direct beam factor (Eq. 2.16) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">122</td><td style = "text-align: left;">rad₊S_sunwall_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam VIS on sunlit wall (Eq. 2.16)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">123</td><td style = "text-align: left;">rad₊S_atm_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident direct beam visible solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">124</td><td style = "text-align: left;">rad₊S_sunwall_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam NIR on sunlit wall</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">125</td><td style = "text-align: left;">rad₊S_atm_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident direct beam NIR solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">126</td><td style = "text-align: left;">rad₊S_road_factor</td><td style = "text-align: left;"></td><td style = "text-align: left;">Road direct beam factor (Eq. 2.17) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">127</td><td style = "text-align: left;">rad₊S_road_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam VIS on road (Eq. 2.17)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">128</td><td style = "text-align: left;">rad₊S_road_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Direct beam NIR on road</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">129</td><td style = "text-align: left;">rad₊S_road_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse VIS on road (Eq. 2.30)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">130</td><td style = "text-align: left;">rad₊S_atm_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident diffuse visible solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">131</td><td style = "text-align: left;">rad₊S_road_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse NIR on road</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">132</td><td style = "text-align: left;">rad₊S_atm_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident diffuse NIR solar radiation</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">133</td><td style = "text-align: left;">rad₊S_wall_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse VIS on wall (Eq. 2.31-2.32)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">134</td><td style = "text-align: left;">rad₊S_wall_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Diffuse NIR on wall</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">135</td><td style = "text-align: left;">rad₊S_net_roof</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net absorbed solar by roof (Eqs. 2.34-2.35)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">136</td><td style = "text-align: left;">rad₊α_roof_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">137</td><td style = "text-align: left;">rad₊α_roof_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">138</td><td style = "text-align: left;">rad₊α_roof_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">139</td><td style = "text-align: left;">rad₊α_roof_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">140</td><td style = "text-align: left;">rad₊det_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Determinant of (I-TA), direct beam VIS (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">141</td><td style = "text-align: left;">rad₊α_wall_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">142</td><td style = "text-align: left;">rad₊α_road_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, direct beam, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">143</td><td style = "text-align: left;">rad₊S_net_road_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: road, direct VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">144</td><td style = "text-align: left;">rad₊S_net_sunwall_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: sunwall, direct VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">145</td><td style = "text-align: left;">rad₊S_net_shdwall_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: shdwall, direct VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">146</td><td style = "text-align: left;">rad₊S_refl_sky_dir_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Reflected to sky: direct VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">147</td><td style = "text-align: left;">rad₊det_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Determinant of (I-TA), direct beam NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">148</td><td style = "text-align: left;">rad₊α_road_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">149</td><td style = "text-align: left;">rad₊α_wall_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, direct beam, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">150</td><td style = "text-align: left;">rad₊S_net_road_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: road, direct NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">151</td><td style = "text-align: left;">rad₊S_net_sunwall_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: sunwall, direct NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">152</td><td style = "text-align: left;">rad₊S_net_shdwall_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: shdwall, direct NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">153</td><td style = "text-align: left;">rad₊S_refl_sky_dir_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Reflected to sky: direct NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">154</td><td style = "text-align: left;">rad₊det_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Determinant of (I-TA), diffuse VIS (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">155</td><td style = "text-align: left;">rad₊α_wall_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">156</td><td style = "text-align: left;">rad₊α_road_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, diffuse, visible (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">157</td><td style = "text-align: left;">rad₊S_net_road_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: road, diffuse VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">158</td><td style = "text-align: left;">rad₊S_net_sunwall_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: sunwall, diffuse VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">159</td><td style = "text-align: left;">rad₊S_net_shdwall_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: shdwall, diffuse VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">160</td><td style = "text-align: left;">rad₊S_refl_sky_dif_vis</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Reflected to sky: diffuse VIS</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">161</td><td style = "text-align: left;">rad₊det_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Determinant of (I-TA), diffuse NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">162</td><td style = "text-align: left;">rad₊α_wall_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">163</td><td style = "text-align: left;">rad₊α_road_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road albedo, diffuse, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">164</td><td style = "text-align: left;">rad₊S_net_road_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: road, diffuse NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">165</td><td style = "text-align: left;">rad₊S_net_sunwall_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: sunwall, diffuse NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">166</td><td style = "text-align: left;">rad₊S_net_shdwall_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Absorbed solar: shdwall, diffuse NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">167</td><td style = "text-align: left;">rad₊S_refl_sky_dif_nir</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Reflected to sky: diffuse NIR</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">168</td><td style = "text-align: left;">rad₊S_net_road</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total net absorbed solar by road</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">169</td><td style = "text-align: left;">rad₊S_net_sunwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total net absorbed solar by sunlit wall per wall area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">170</td><td style = "text-align: left;">rad₊S_net_shdwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total net absorbed solar by shaded wall per wall area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">171</td><td style = "text-align: left;">rad₊S_net_uc</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net absorbed solar by urban canyon per ground area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">172</td><td style = "text-align: left;">rad₊α_uc_dir_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon direct beam albedo, VIS (Eq. 2.93) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">173</td><td style = "text-align: left;">rad₊α_uc_dir_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon direct beam albedo, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">174</td><td style = "text-align: left;">rad₊α_uc_dif_vis</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon diffuse albedo, VIS (Eq. 2.94) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">175</td><td style = "text-align: left;">rad₊α_uc_dif_nir</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon diffuse albedo, NIR (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">176</td><td style = "text-align: left;">rad₊S_net_total</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total net absorbed solar (Eq. 2.95)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">177</td><td style = "text-align: left;">rad₊W_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof fraction of urban surface (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">178</td><td style = "text-align: left;">rad₊L_up_roof</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Upward LW from roof (Eq. 2.102)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">179</td><td style = "text-align: left;">rad₊ε_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">180</td><td style = "text-align: left;">rad₊T_roof</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Roof surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">181</td><td style = "text-align: left;">rad₊L_atm_down</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Incident longwave radiation from atmosphere</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">182</td><td style = "text-align: left;">rad₊L_net_roof</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net LW for roof (Eq. 2.101)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">183</td><td style = "text-align: left;">rad₊L_emit_road</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Emitted LW from road (Eq. 2.111)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">184</td><td style = "text-align: left;">rad₊ε_road</td><td style = "text-align: left;"></td><td style = "text-align: left;">Effective road emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">185</td><td style = "text-align: left;">rad₊T_road</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">186</td><td style = "text-align: left;">rad₊L_emit_sunwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Emitted LW from sunlit wall (Eq. 2.112)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">187</td><td style = "text-align: left;">rad₊ε_wall</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wall emissivity (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">188</td><td style = "text-align: left;">rad₊T_sunwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Sunlit wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">189</td><td style = "text-align: left;">rad₊L_emit_shdwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Emitted LW from shaded wall (Eq. 2.113)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">190</td><td style = "text-align: left;">rad₊T_shdwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Shaded wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">191</td><td style = "text-align: left;">rad₊det_lw</td><td style = "text-align: left;"></td><td style = "text-align: left;">Determinant of (I-TA) for longwave (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">192</td><td style = "text-align: left;">rad₊L_net_road</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net LW for road</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">193</td><td style = "text-align: left;">rad₊L_net_sunwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net LW for sunlit wall per wall area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">194</td><td style = "text-align: left;">rad₊L_net_shdwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net LW for shaded wall per wall area</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">195</td><td style = "text-align: left;">rad₊L_net_uc</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Net LW for urban canyon per ground area (Eq. 2.172)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">196</td><td style = "text-align: left;">rad₊L_net_total</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total net LW (Eq. 2.175)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">197</td><td style = "text-align: left;">flux₊λ_p</td><td style = "text-align: left;"></td><td style = "text-align: left;">Plan area index (Eq. 3.56) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">198</td><td style = "text-align: left;">flux₊H_W</td><td style = "text-align: left;"></td><td style = "text-align: left;">Canyon height to width ratio H/W (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">199</td><td style = "text-align: left;">flux₊λ_F</td><td style = "text-align: left;"></td><td style = "text-align: left;">Frontal area index (Eq. 3.58) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">200</td><td style = "text-align: left;">flux₊d_canopy</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Canopy displacement height (Eq. 3.55)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">201</td><td style = "text-align: left;">flux₊H_canyon</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Canyon (building/roof) height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">202</td><td style = "text-align: left;">flux₊z_0m_canopy</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Canopy roughness length for momentum (Eq. 3.57)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">203</td><td style = "text-align: left;">flux₊V_r</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Reference level atmospheric wind (Eq. 3.63)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">204</td><td style = "text-align: left;">flux₊u_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Zonal wind at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">205</td><td style = "text-align: left;">flux₊v_atm</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Meridional wind at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">206</td><td style = "text-align: left;">flux₊L_MO</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Monin-Obukhov length (Eq. 3.17)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">207</td><td style = "text-align: left;">flux₊z_atm_m</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for wind (momentum)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">208</td><td style = "text-align: left;">flux₊ζ_in</td><td style = "text-align: left;"></td><td style = "text-align: left;">Monin-Obukhov stability parameter ζ = (z_atm_m - d)/L, from iterative solution (Eqs. 3.47-3.50) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">209</td><td style = "text-align: left;">flux₊ζ_0m</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stability parameter at z_0m (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">210</td><td style = "text-align: left;">flux₊ζ_h</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stability parameter for heat at z_atm_h (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">211</td><td style = "text-align: left;">flux₊z_atm_h</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for temperature (sensible heat)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">212</td><td style = "text-align: left;">flux₊ζ_0h</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stability parameter at z_0h (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">213</td><td style = "text-align: left;">flux₊ζ_w</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stability parameter for moisture at z_atm_w (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">214</td><td style = "text-align: left;">flux₊z_atm_w</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for humidity (water vapor)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">215</td><td style = "text-align: left;">flux₊ζ_0w</td><td style = "text-align: left;"></td><td style = "text-align: left;">Stability parameter at z_0w (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">216</td><td style = "text-align: left;">flux₊ψ_m_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Momentum stability correction at ζ (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">217</td><td style = "text-align: left;">flux₊ψ_m_0</td><td style = "text-align: left;"></td><td style = "text-align: left;">Momentum stability correction at ζ_0m (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">218</td><td style = "text-align: left;">flux₊ψ_h_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Heat stability correction at ζ_h (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">219</td><td style = "text-align: left;">flux₊ψ_h_0</td><td style = "text-align: left;"></td><td style = "text-align: left;">Heat stability correction at ζ_0h (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">220</td><td style = "text-align: left;">flux₊ψ_w_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Moisture stability correction at ζ_w (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">221</td><td style = "text-align: left;">flux₊ψ_w_0</td><td style = "text-align: left;"></td><td style = "text-align: left;">Moisture stability correction at ζ_0w (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">222</td><td style = "text-align: left;">flux₊θ_v_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Virtual potential temperature at reference height (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">223</td><td style = "text-align: left;">flux₊q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Atmospheric specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">224</td><td style = "text-align: left;">flux₊θ_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric potential temperature (Eq. 3.8)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">225</td><td style = "text-align: left;">flux₊U_c</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Convective velocity (Eq. 3.29)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">226</td><td style = "text-align: left;">flux₊V_a</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Effective wind speed (Eq. 3.25)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">227</td><td style = "text-align: left;">flux₊u_star</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Friction velocity (Eq. 3.26)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">228</td><td style = "text-align: left;">flux₊r_am</td><td style = "text-align: left;">m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance for momentum (Eq. 3.65)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">229</td><td style = "text-align: left;">flux₊r_ah</td><td style = "text-align: left;">m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance for sensible heat (Eq. 3.66)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">230</td><td style = "text-align: left;">flux₊r_aw</td><td style = "text-align: left;">m⁻¹ s</td><td style = "text-align: left;">Aerodynamic resistance for water vapor (Eq. 3.67)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">231</td><td style = "text-align: left;">flux₊U_can</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Canyon horizontal wind speed (Eqs. 3.60-3.62)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">232</td><td style = "text-align: left;">flux₊H_w_est</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Height at which canyon wind speed is estimated (Table 1.3)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">233</td><td style = "text-align: left;">flux₊U_ac</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Canyon wind speed (Eq. 3.59)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">234</td><td style = "text-align: left;">flux₊r_s_u</td><td style = "text-align: left;">m⁻¹ s</td><td style = "text-align: left;">Surface resistance for all urban surfaces (Eq. 3.68)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">235</td><td style = "text-align: left;">flux₊ρ_atm</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Atmospheric air density (Eq. 3.9)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">236</td><td style = "text-align: left;">flux₊c_a_h</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Sensible heat conductance UCL to atmosphere (1/r_ah)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">237</td><td style = "text-align: left;">flux₊c_a_w</td><td style = "text-align: left;">m s⁻¹</td><td style = "text-align: left;">Latent heat conductance UCL to atmosphere (1/r_aw)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">238</td><td style = "text-align: left;">flux₊T_ac</td><td style = "text-align: left;">K</td><td style = "text-align: left;">UCL air temperature (Eq. 3.75)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">239</td><td style = "text-align: left;">flux₊T_g_sunwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Sunlit wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">240</td><td style = "text-align: left;">flux₊W_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof fraction of urban surface (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">241</td><td style = "text-align: left;">flux₊T_g_shdwall</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Shaded wall surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">242</td><td style = "text-align: left;">flux₊f_prvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Fraction of road that is pervious (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">243</td><td style = "text-align: left;">flux₊T_g_prvrd</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Pervious road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">244</td><td style = "text-align: left;">flux₊T_g_roof</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Roof surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">245</td><td style = "text-align: left;">flux₊T_g_imprvrd</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Impervious road surface temperature</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">246</td><td style = "text-align: left;">flux₊q_ac</td><td style = "text-align: left;"></td><td style = "text-align: left;">UCL air specific humidity (Eq. 3.93)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">247</td><td style = "text-align: left;">flux₊q_g_prvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Pervious road surface specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">248</td><td style = "text-align: left;">flux₊f_wet_imprvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wetted fraction of impervious road (Eqs. 3.82-3.83) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">249</td><td style = "text-align: left;">flux₊q_g_imprvrd</td><td style = "text-align: left;"></td><td style = "text-align: left;">Impervious road surface saturated specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">250</td><td style = "text-align: left;">flux₊q_g_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Roof surface saturated specific humidity</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">251</td><td style = "text-align: left;">flux₊f_wet_roof</td><td style = "text-align: left;"></td><td style = "text-align: left;">Wetted fraction of roof (Eqs. 3.82-3.83) (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">252</td><td style = "text-align: left;">flux₊H_roof</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Sensible heat flux from roof (Eq. 3.69)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">253</td><td style = "text-align: left;">flux₊H_prvrd</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Sensible heat flux from pervious road (Eq. 3.70)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">254</td><td style = "text-align: left;">flux₊H_imprvrd</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Sensible heat flux from impervious road (Eq. 3.71)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">255</td><td style = "text-align: left;">flux₊H_sunwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Sensible heat flux from sunlit wall (Eq. 3.72)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">256</td><td style = "text-align: left;">flux₊H_shdwall</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Sensible heat flux from shaded wall (Eq. 3.73)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">257</td><td style = "text-align: left;">flux₊H_total</td><td style = "text-align: left;">kg s⁻³</td><td style = "text-align: left;">Total sensible heat flux (Eq. 3.74)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">258</td><td style = "text-align: left;">flux₊E_roof</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Water vapor flux from roof (Eq. 3.76)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">259</td><td style = "text-align: left;">flux₊E_prvrd</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Water vapor flux from pervious road (Eq. 3.77)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">260</td><td style = "text-align: left;">flux₊E_imprvrd</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Water vapor flux from impervious road (Eq. 3.78)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">261</td><td style = "text-align: left;">flux₊E_total</td><td style = "text-align: left;">m⁻² kg s⁻¹</td><td style = "text-align: left;">Total water vapor flux (Eq. 3.81)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">262</td><td style = "text-align: left;">flux₊τ_x</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Zonal momentum flux (Eq. 3.6)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">263</td><td style = "text-align: left;">flux₊τ_y</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Meridional momentum flux (Eq. 3.7)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">264</td><td style = "text-align: left;">flux₊dH_roof_dT</td><td style = "text-align: left;">kg s⁻³ K⁻¹</td><td style = "text-align: left;">∂H_roof/∂T_g,roof (Eq. 3.95)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">265</td><td style = "text-align: left;">flux₊dH_prvrd_dT</td><td style = "text-align: left;">kg s⁻³ K⁻¹</td><td style = "text-align: left;">∂H_prvrd/∂T_g,prvrd (Eq. 3.96)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">266</td><td style = "text-align: left;">flux₊dH_imprvrd_dT</td><td style = "text-align: left;">kg s⁻³ K⁻¹</td><td style = "text-align: left;">∂H_imprvrd/∂T_g,imprvrd (Eq. 3.97)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">267</td><td style = "text-align: left;">flux₊dH_sunwall_dT</td><td style = "text-align: left;">kg s⁻³ K⁻¹</td><td style = "text-align: left;">∂H_sunwall/∂T_g,sunwall (Eq. 3.98)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">268</td><td style = "text-align: left;">flux₊dH_shdwall_dT</td><td style = "text-align: left;">kg s⁻³ K⁻¹</td><td style = "text-align: left;">∂H_shdwall/∂T_g,shdwall (Eq. 3.99)</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">eqs = equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{offline.S\_atm}\left( t \right) &amp;= \mathtt{S\_atm} \\
\mathtt{offline.T\_atm}\left( t \right) &amp;= \mathtt{T\_atm} \\
\mathtt{offline.P\_atm}\left( t \right) &amp;= \mathtt{P\_atm} \\
\mathtt{offline.q\_atm}\left( t \right) &amp;= \mathtt{q\_atm} \\
\mathtt{offline.W\_atm}\left( t \right) &amp;= \mathtt{W\_atm} \\
\mathtt{offline.P\_precip}\left( t \right) &amp;= \mathtt{P\_precip} \\
\mathtt{atmos.z\_prime\_atm}\left( t \right) &amp;= \mathtt{offline.z\_prime\_atm}\left( t \right) \\
\mathtt{atmos.T\_atm}\left( t \right) &amp;= \mathtt{T\_atm} \\
\mathtt{atmos.P\_atm}\left( t \right) &amp;= \mathtt{P\_atm} \\
\mathtt{atmos.q\_atm}\left( t \right) &amp;= \mathtt{q\_atm} \\
\mathtt{atmos.z\_0}\left( t \right) &amp;= \mathtt{z\_0} \\
\mathtt{atmos.z\_d}\left( t \right) &amp;= \mathtt{z\_d} \\
\mathtt{rad.S\_atm\_dir\_vis}\left( t \right) &amp;= \mathtt{offline.S\_atm\_dir\_vis}\left( t \right) \\
\mathtt{rad.S\_atm\_dir\_nir}\left( t \right) &amp;= \mathtt{offline.S\_atm\_dir\_nir}\left( t \right) \\
\mathtt{rad.S\_atm\_dif\_vis}\left( t \right) &amp;= \mathtt{offline.S\_atm\_dif\_vis}\left( t \right) \\
\mathtt{rad.S\_atm\_dif\_nir}\left( t \right) &amp;= \mathtt{offline.S\_atm\_dif\_nir}\left( t \right) \\
\mathtt{rad.L\_atm\_down}\left( t \right) &amp;= \mathtt{offline.L\_atm\_down}\left( t \right) \\
\mathtt{rad.\mu\_zen}\left( t \right) &amp;= \mathtt{\mu\_zen} \\
\mathtt{rad.H\_W}\left( t \right) &amp;= \mathtt{H\_W} \\
\mathtt{rad.W\_roof}\left( t \right) &amp;= \mathtt{W\_roof} \\
\mathtt{rad.\alpha\_roof\_dir\_vis}\left( t \right) &amp;= \mathtt{\alpha\_roof\_dir\_vis} \\
\mathtt{rad.\alpha\_roof\_dir\_nir}\left( t \right) &amp;= \mathtt{\alpha\_roof\_dir\_nir} \\
\mathtt{rad.\alpha\_roof\_dif\_vis}\left( t \right) &amp;= \mathtt{\alpha\_roof\_dif\_vis} \\
\mathtt{rad.\alpha\_roof\_dif\_nir}\left( t \right) &amp;= \mathtt{\alpha\_roof\_dif\_nir} \\
\mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) &amp;= \mathtt{\alpha\_road\_dir\_vis} \\
\mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) &amp;= \mathtt{\alpha\_road\_dir\_nir} \\
\mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) &amp;= \mathtt{\alpha\_road\_dif\_vis} \\
\mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) &amp;= \mathtt{\alpha\_road\_dif\_nir} \\
\mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) &amp;= \mathtt{\alpha\_wall\_dir\_vis} \\
\mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) &amp;= \mathtt{\alpha\_wall\_dir\_nir} \\
\mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) &amp;= \mathtt{\alpha\_wall\_dif\_vis} \\
\mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) &amp;= \mathtt{\alpha\_wall\_dif\_nir} \\
\mathtt{rad.\varepsilon\_roof}\left( t \right) &amp;= \mathtt{\varepsilon\_roof} \\
\mathtt{rad.\varepsilon\_road}\left( t \right) &amp;= \mathtt{\varepsilon\_road} \\
\mathtt{rad.\varepsilon\_wall}\left( t \right) &amp;= \mathtt{\varepsilon\_wall} \\
\mathtt{rad.T\_roof}\left( t \right) &amp;= \mathtt{T\_g\_roof} \\
\mathtt{rad.T\_road}\left( t \right) &amp;= \mathtt{T\_g\_imprvrd} \\
\mathtt{rad.T\_sunwall}\left( t \right) &amp;= \mathtt{T\_g\_sunwall} \\
\mathtt{rad.T\_shdwall}\left( t \right) &amp;= \mathtt{T\_g\_shdwall} \\
\mathtt{flux.u\_atm}\left( t \right) &amp;= \mathtt{offline.u\_atm}\left( t \right) \\
\mathtt{flux.v\_atm}\left( t \right) &amp;= \mathtt{offline.v\_atm}\left( t \right) \\
\mathtt{flux.\theta\_atm}\left( t \right) &amp;= \mathtt{offline.\theta\_atm}\left( t \right) \\
\mathtt{flux.q\_atm}\left( t \right) &amp;= \mathtt{q\_atm} \\
\mathtt{flux.\rho\_atm}\left( t \right) &amp;= \mathtt{atmos.\rho\_atm}\left( t \right) \\
\mathtt{flux.z\_atm\_m}\left( t \right) &amp;= \mathtt{atmos.z\_atm}\left( t \right) \\
\mathtt{flux.z\_atm\_h}\left( t \right) &amp;= \mathtt{atmos.z\_atm}\left( t \right) \\
\mathtt{flux.z\_atm\_w}\left( t \right) &amp;= \mathtt{atmos.z\_atm}\left( t \right) \\
\mathtt{flux.H\_W}\left( t \right) &amp;= \mathtt{H\_W} \\
\mathtt{flux.H\_canyon}\left( t \right) &amp;= \mathtt{H\_canyon} \\
\mathtt{flux.W\_roof}\left( t \right) &amp;= \mathtt{W\_roof} \\
\mathtt{flux.f\_prvrd}\left( t \right) &amp;= \mathtt{f\_prvrd} \\
\mathtt{flux.H\_w\_est}\left( t \right) &amp;= \mathtt{H\_w\_est} \\
\mathtt{flux.T\_g\_roof}\left( t \right) &amp;= \mathtt{T\_g\_roof} \\
\mathtt{flux.T\_g\_prvrd}\left( t \right) &amp;= \mathtt{T\_g\_prvrd} \\
\mathtt{flux.T\_g\_imprvrd}\left( t \right) &amp;= \mathtt{T\_g\_imprvrd} \\
\mathtt{flux.T\_g\_sunwall}\left( t \right) &amp;= \mathtt{T\_g\_sunwall} \\
\mathtt{flux.T\_g\_shdwall}\left( t \right) &amp;= \mathtt{T\_g\_shdwall} \\
\mathtt{flux.q\_g\_roof}\left( t \right) &amp;= \mathtt{q\_g\_roof} \\
\mathtt{flux.q\_g\_prvrd}\left( t \right) &amp;= \mathtt{q\_g\_prvrd} \\
\mathtt{flux.q\_g\_imprvrd}\left( t \right) &amp;= \mathtt{q\_g\_imprvrd} \\
\mathtt{flux.f\_wet\_roof}\left( t \right) &amp;= \mathtt{f\_wet\_roof} \\
\mathtt{flux.f\_wet\_imprvrd}\left( t \right) &amp;= \mathtt{f\_wet\_imprvrd} \\
\mathtt{flux.\zeta\_in}\left( t \right) &amp;= \mathtt{\zeta\_in} \\
\mathtt{offline.R\_vis\_raw}\left( t \right) &amp;= \mathtt{offline.a\_0} + \mathtt{offline.a\_1} ~ \mathtt{offline.\alpha\_vis} ~ \mathtt{offline.S\_atm}\left( t \right) + \left( \mathtt{offline.S\_atm}\left( t \right) \right)^{2} ~ \mathtt{offline.\alpha\_vis}^{2} ~ \mathtt{offline.a\_2} + \left( \mathtt{offline.S\_atm}\left( t \right) \right)^{3} ~ \mathtt{offline.\alpha\_vis}^{3} ~ \mathtt{offline.a\_3} \\
\mathtt{offline.R\_nir\_raw}\left( t \right) &amp;= \mathtt{offline.b\_0} + \mathtt{offline.b\_1} ~ \left( \mathtt{offline.one\_dimless} - \mathtt{offline.\alpha\_vis} \right) ~ \mathtt{offline.S\_atm}\left( t \right) + \left( \mathtt{offline.S\_atm}\left( t \right) \right)^{2} ~ \left( \mathtt{offline.one\_dimless} - \mathtt{offline.\alpha\_vis} \right)^{2} ~ \mathtt{offline.b\_2} + \left( \mathtt{offline.S\_atm}\left( t \right) \right)^{3} ~ \left( \mathtt{offline.one\_dimless} - \mathtt{offline.\alpha\_vis} \right)^{3} ~ \mathtt{offline.b\_3} \\
\mathtt{offline.R\_vis}\left( t \right) &amp;= max\left( \mathtt{offline.R\_min}, min\left( \mathtt{offline.R\_max}, \mathtt{offline.R\_vis\_raw}\left( t \right) \right) \right) \\
\mathtt{offline.R\_nir}\left( t \right) &amp;= max\left( \mathtt{offline.R\_min}, min\left( \mathtt{offline.R\_max}, \mathtt{offline.R\_nir\_raw}\left( t \right) \right) \right) \\
\mathtt{offline.S\_atm\_dir\_vis}\left( t \right) &amp;= \mathtt{offline.\alpha\_vis} ~ \mathtt{offline.S\_atm}\left( t \right) ~ \mathtt{offline.R\_vis}\left( t \right) \\
\mathtt{offline.S\_atm\_dir\_nir}\left( t \right) &amp;= \left( \mathtt{offline.one\_dimless} - \mathtt{offline.\alpha\_vis} \right) ~ \mathtt{offline.S\_atm}\left( t \right) ~ \mathtt{offline.R\_nir}\left( t \right) \\
\mathtt{offline.S\_atm\_dif\_vis}\left( t \right) &amp;= \left( \mathtt{offline.one\_dimless} - \mathtt{offline.R\_vis}\left( t \right) \right) ~ \mathtt{offline.\alpha\_vis} ~ \mathtt{offline.S\_atm}\left( t \right) \\
\mathtt{offline.S\_atm\_dif\_nir}\left( t \right) &amp;= \left( \mathtt{offline.one\_dimless} - \mathtt{offline.R\_nir}\left( t \right) \right) ~ \left( \mathtt{offline.one\_dimless} - \mathtt{offline.\alpha\_vis} \right) ~ \mathtt{offline.S\_atm}\left( t \right) \\
\mathtt{offline.e\_atm}\left( t \right) &amp;= \frac{\mathtt{offline.P\_atm}\left( t \right) ~ \mathtt{offline.q\_atm}\left( t \right)}{\mathtt{offline.\varepsilon\_ratio} + \mathtt{offline.one\_minus\_\varepsilon} ~ \mathtt{offline.q\_atm}\left( t \right)} \\
\mathtt{offline.L\_atm\_down}\left( t \right) &amp;= \left( \mathtt{offline.T\_atm}\left( t \right) \right)^{4} ~ \left( \mathtt{offline.idso\_base} + \mathtt{offline.idso\_coeff} ~ e^{\frac{\mathtt{offline.idso\_T\_ref}}{\mathtt{offline.T\_atm}\left( t \right)}} ~ \mathtt{offline.e\_atm}\left( t \right) \right) ~ \mathtt{offline.\sigma\_SB} \\
\mathtt{offline.f\_P\_raw}\left( t \right) &amp;= \left(  - \mathtt{offline.T\_f} + \mathtt{offline.T\_atm}\left( t \right) \right) ~ \mathtt{offline.f\_P\_slope} \\
\mathtt{offline.f\_P}\left( t \right) &amp;= max\left( \mathtt{offline.zero\_dimless}, min\left( \mathtt{offline.one\_dimless}, \mathtt{offline.f\_P\_raw}\left( t \right) \right) \right) \\
\mathtt{offline.q\_rain}\left( t \right) &amp;= \mathtt{offline.P\_precip}\left( t \right) ~ \mathtt{offline.f\_P}\left( t \right) \\
\mathtt{offline.q\_snow}\left( t \right) &amp;= \left( \mathtt{offline.one\_dimless} - \mathtt{offline.f\_P}\left( t \right) \right) ~ \mathtt{offline.P\_precip}\left( t \right) \\
\mathtt{offline.u\_atm}\left( t \right) &amp;= \mathtt{offline.sqrt2\_inv} ~ \mathtt{offline.W\_atm}\left( t \right) \\
\mathtt{offline.v\_atm}\left( t \right) &amp;= \mathtt{offline.sqrt2\_inv} ~ \mathtt{offline.W\_atm}\left( t \right) \\
\mathtt{offline.\theta\_atm}\left( t \right) &amp;= \mathtt{offline.T\_atm}\left( t \right) \\
\mathtt{offline.z\_prime\_atm}\left( t \right) &amp;= \mathtt{offline.z\_prime\_atm\_val} \\
\mathtt{atmos.e\_atm}\left( t \right) &amp;= \frac{\mathtt{atmos.P\_atm}\left( t \right) ~ \mathtt{atmos.q\_atm}\left( t \right)}{\mathtt{atmos.\varepsilon\_ratio} + \mathtt{atmos.one\_minus\_\varepsilon} ~ \mathtt{atmos.q\_atm}\left( t \right)} \\
\mathtt{atmos.\rho\_atm}\left( t \right) &amp;= \frac{\mathtt{atmos.P\_atm}\left( t \right) - \mathtt{atmos.one\_minus\_\varepsilon} ~ \mathtt{atmos.e\_atm}\left( t \right)}{\mathtt{atmos.R\_da} ~ \mathtt{atmos.T\_atm}\left( t \right)} \\
\mathtt{atmos.z\_atm}\left( t \right) &amp;= \mathtt{atmos.z\_d}\left( t \right) + \mathtt{atmos.z\_prime\_atm}\left( t \right) + \mathtt{atmos.z\_0}\left( t \right) \\
\mathtt{rad.\Psi\_sky\_wall}\left( t \right) &amp;= \frac{1 - \sqrt{1 + \left( \mathtt{rad.H\_W}\left( t \right) \right)^{2}} + \mathtt{rad.H\_W}\left( t \right)}{2 ~ \mathtt{rad.H\_W}\left( t \right)} \\
\mathtt{rad.\Psi\_wall\_sky}\left( t \right) &amp;= \mathtt{rad.\Psi\_sky\_wall}\left( t \right) \\
\mathtt{rad.\Psi\_road\_sky}\left( t \right) &amp;= \sqrt{1 + \left( \mathtt{rad.H\_W}\left( t \right) \right)^{2}} - \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.\Psi\_sky\_road}\left( t \right) &amp;= \mathtt{rad.\Psi\_road\_sky}\left( t \right) \\
\mathtt{rad.\Psi\_wall\_road}\left( t \right) &amp;= \mathtt{rad.\Psi\_wall\_sky}\left( t \right) \\
\mathtt{rad.\Psi\_road\_wall}\left( t \right) &amp;= \frac{1 - \mathtt{rad.\Psi\_road\_sky}\left( t \right)}{2} \\
\mathtt{rad.\Psi\_wall\_wall}\left( t \right) &amp;= 1 - \mathtt{rad.\Psi\_wall\_sky}\left( t \right) - \mathtt{rad.\Psi\_wall\_road}\left( t \right) \\
\mathtt{rad.T\_rw}\left( t \right) &amp;= \mathtt{rad.\Psi\_wall\_road}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.T\_wr}\left( t \right) &amp;= \frac{\mathtt{rad.\Psi\_road\_wall}\left( t \right)}{\mathtt{rad.H\_W}\left( t \right)} \\
\mathtt{rad.T\_ww}\left( t \right) &amp;= \mathtt{rad.\Psi\_wall\_wall}\left( t \right) \\
\mathtt{rad.\theta\_0}\left( t \right) &amp;= \mathtt{rad.one\_rad} ~ \arcsin\left( min\left( \frac{1}{\tan\left( \frac{\mathtt{rad.\mu\_zen}\left( t \right)}{\mathtt{rad.one\_rad}} \right) ~ \mathtt{rad.H\_W}\left( t \right)}, 1 \right) \right) \\
\mathtt{rad.S\_sunwall\_factor}\left( t \right) &amp;= 2 ~ \left( \frac{0.5 + \frac{ - \mathtt{rad.\theta\_0}\left( t \right)}{\mathtt{rad.one\_rad} ~ \mathtt{rad.\pi\_val}}}{\mathtt{rad.H\_W}\left( t \right)} + \frac{\tan\left( \frac{\mathtt{rad.\mu\_zen}\left( t \right)}{\mathtt{rad.one\_rad}} \right) ~ \left( 1 - \cos\left( \frac{\mathtt{rad.\theta\_0}\left( t \right)}{\mathtt{rad.one\_rad}} \right) \right)}{\mathtt{rad.\pi\_val}} \right) \\
\mathtt{rad.S\_sunwall\_dir\_vis}\left( t \right) &amp;= \mathtt{rad.S\_atm\_dir\_vis}\left( t \right) ~ \mathtt{rad.S\_sunwall\_factor}\left( t \right) \\
\mathtt{rad.S\_sunwall\_dir\_nir}\left( t \right) &amp;= \mathtt{rad.S\_atm\_dir\_nir}\left( t \right) ~ \mathtt{rad.S\_sunwall\_factor}\left( t \right) \\
\mathtt{rad.S\_road\_factor}\left( t \right) &amp;= \frac{ - 2 ~ \tan\left( \frac{\mathtt{rad.\mu\_zen}\left( t \right)}{\mathtt{rad.one\_rad}} \right) ~ \left( 1 - \cos\left( \frac{\mathtt{rad.\theta\_0}\left( t \right)}{\mathtt{rad.one\_rad}} \right) \right) ~ \mathtt{rad.H\_W}\left( t \right)}{\mathtt{rad.\pi\_val}} + \frac{2 ~ \mathtt{rad.\theta\_0}\left( t \right)}{\mathtt{rad.one\_rad} ~ \mathtt{rad.\pi\_val}} \\
\mathtt{rad.S\_road\_dir\_vis}\left( t \right) &amp;= \mathtt{rad.S\_atm\_dir\_vis}\left( t \right) ~ \mathtt{rad.S\_road\_factor}\left( t \right) \\
\mathtt{rad.S\_road\_dir\_nir}\left( t \right) &amp;= \mathtt{rad.S\_atm\_dir\_nir}\left( t \right) ~ \mathtt{rad.S\_road\_factor}\left( t \right) \\
\mathtt{rad.S\_road\_dif\_vis}\left( t \right) &amp;= \mathtt{rad.\Psi\_sky\_road}\left( t \right) ~ \mathtt{rad.S\_atm\_dif\_vis}\left( t \right) \\
\mathtt{rad.S\_road\_dif\_nir}\left( t \right) &amp;= \mathtt{rad.\Psi\_sky\_road}\left( t \right) ~ \mathtt{rad.S\_atm\_dif\_nir}\left( t \right) \\
\mathtt{rad.S\_wall\_dif\_vis}\left( t \right) &amp;= \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.S\_atm\_dif\_vis}\left( t \right) \\
\mathtt{rad.S\_wall\_dif\_nir}\left( t \right) &amp;= \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.S\_atm\_dif\_nir}\left( t \right) \\
\mathtt{rad.S\_net\_roof}\left( t \right) &amp;= \mathtt{rad.S\_atm\_dir\_vis}\left( t \right) ~ \left( 1 - \mathtt{rad.\alpha\_roof\_dir\_vis}\left( t \right) \right) + \mathtt{rad.S\_atm\_dir\_nir}\left( t \right) ~ \left( 1 - \mathtt{rad.\alpha\_roof\_dir\_nir}\left( t \right) \right) + \mathtt{rad.S\_atm\_dif\_nir}\left( t \right) ~ \left( 1 - \mathtt{rad.\alpha\_roof\_dif\_nir}\left( t \right) \right) + \left( 1 - \mathtt{rad.\alpha\_roof\_dif\_vis}\left( t \right) \right) ~ \mathtt{rad.S\_atm\_dif\_vis}\left( t \right) \\
\mathtt{rad.det\_dir\_vis}\left( t \right) &amp;= 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) \right)^{2} - 2 ~ \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) \\
\mathtt{rad.S\_net\_road\_dir\_vis}\left( t \right) &amp;= \frac{\left( \mathtt{rad.zero\_wm2} ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) + \mathtt{rad.S\_sunwall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) + \left( 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) \right)^{2} \right) ~ \mathtt{rad.S\_road\_dir\_vis}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) \right)}{\mathtt{rad.det\_dir\_vis}\left( t \right)} \\
\mathtt{rad.S\_net\_sunwall\_dir\_vis}\left( t \right) &amp;= \frac{\left( \mathtt{rad.zero\_wm2} ~ \left( \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) + \left( 1 - \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_sunwall\_dir\_vis}\left( t \right) + \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.S\_road\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) \right)}{\mathtt{rad.det\_dir\_vis}\left( t \right)} \\
\mathtt{rad.S\_net\_shdwall\_dir\_vis}\left( t \right) &amp;= \frac{\left( \mathtt{rad.zero\_wm2} ~ \left( 1 - \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) + \left( \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_sunwall\_dir\_vis}\left( t \right) + \mathtt{rad.\alpha\_road\_dir\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.S\_road\_dir\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dir\_vis}\left( t \right) \right)}{\mathtt{rad.det\_dir\_vis}\left( t \right)} \\
\mathtt{rad.S\_refl\_sky\_dir\_vis}\left( t \right) &amp;=  - \mathtt{rad.S\_net\_road\_dir\_vis}\left( t \right) + \mathtt{rad.S\_road\_dir\_vis}\left( t \right) + \left( \mathtt{rad.zero\_wm2} + \mathtt{rad.S\_sunwall\_dir\_vis}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) - \left( \mathtt{rad.S\_net\_sunwall\_dir\_vis}\left( t \right) + \mathtt{rad.S\_net\_shdwall\_dir\_vis}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.det\_dir\_nir}\left( t \right) &amp;= 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) \right)^{2} - 2 ~ \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) \\
\mathtt{rad.S\_net\_road\_dir\_nir}\left( t \right) &amp;= \frac{\left( \mathtt{rad.zero\_wm2} ~ \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_rw}\left( t \right) + \left( 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) \right)^{2} \right) ~ \mathtt{rad.S\_road\_dir\_nir}\left( t \right) + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.S\_sunwall\_dir\_nir}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) \right)}{\mathtt{rad.det\_dir\_nir}\left( t \right)} \\
\mathtt{rad.S\_net\_sunwall\_dir\_nir}\left( t \right) &amp;= \frac{\left( \mathtt{rad.zero\_wm2} ~ \left( \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) \right) + \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.S\_road\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) + \left( 1 - \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) \right) ~ \mathtt{rad.S\_sunwall\_dir\_nir}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) \right)}{\mathtt{rad.det\_dir\_nir}\left( t \right)} \\
\mathtt{rad.S\_net\_shdwall\_dir\_nir}\left( t \right) &amp;= \frac{\left( \mathtt{rad.zero\_wm2} ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) \right) + \left( 1 + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.S\_road\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) + \left( \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dir\_nir}\left( t \right) \right) ~ \mathtt{rad.S\_sunwall\_dir\_nir}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dir\_nir}\left( t \right) \right)}{\mathtt{rad.det\_dir\_nir}\left( t \right)} \\
\mathtt{rad.S\_refl\_sky\_dir\_nir}\left( t \right) &amp;= \mathtt{rad.S\_road\_dir\_nir}\left( t \right) - \mathtt{rad.S\_net\_road\_dir\_nir}\left( t \right) + \left( \mathtt{rad.zero\_wm2} + \mathtt{rad.S\_sunwall\_dir\_nir}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) - \left( \mathtt{rad.S\_net\_shdwall\_dir\_nir}\left( t \right) + \mathtt{rad.S\_net\_sunwall\_dir\_nir}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.det\_dif\_vis}\left( t \right) &amp;= 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) \right)^{2} - 2 ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) \\
\mathtt{rad.S\_net\_road\_dif\_vis}\left( t \right) &amp;= \frac{\left( 2 ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) + \mathtt{rad.S\_road\_dif\_vis}\left( t \right) ~ \left( 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) \right)^{2} \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) \right)}{\mathtt{rad.det\_dif\_vis}\left( t \right)} \\
\mathtt{rad.S\_net\_sunwall\_dif\_vis}\left( t \right) &amp;= \frac{\left( \left( 1 - \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) + \left( \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) + \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) ~ \mathtt{rad.S\_road\_dif\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) \right)}{\mathtt{rad.det\_dif\_vis}\left( t \right)} \\
\mathtt{rad.S\_net\_shdwall\_dif\_vis}\left( t \right) &amp;= \frac{\left( \left( 1 - \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) + \left( \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) + \mathtt{rad.\alpha\_road\_dif\_vis}\left( t \right) ~ \mathtt{rad.S\_road\_dif\_vis}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dif\_vis}\left( t \right) \right)}{\mathtt{rad.det\_dif\_vis}\left( t \right)} \\
\mathtt{rad.S\_refl\_sky\_dif\_vis}\left( t \right) &amp;= \mathtt{rad.S\_road\_dif\_vis}\left( t \right) - \mathtt{rad.S\_net\_road\_dif\_vis}\left( t \right) - \left( \mathtt{rad.S\_net\_shdwall\_dif\_vis}\left( t \right) + \mathtt{rad.S\_net\_sunwall\_dif\_vis}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) + 2 ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.det\_dif\_nir}\left( t \right) &amp;= 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) \right)^{2} - 2 ~ \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) \\
\mathtt{rad.S\_net\_road\_dif\_nir}\left( t \right) &amp;= \frac{\left( 1 - \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) \right) ~ \left( 2 ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) + \mathtt{rad.S\_road\_dif\_nir}\left( t \right) ~ \left( 1 - \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) \right)^{2} \right) \right)}{\mathtt{rad.det\_dif\_nir}\left( t \right)} \\
\mathtt{rad.S\_net\_sunwall\_dif\_nir}\left( t \right) &amp;= \frac{\left( \left( \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) + \left( 1 - \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) + \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) ~ \mathtt{rad.S\_road\_dif\_nir}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) \right)}{\mathtt{rad.det\_dif\_nir}\left( t \right)} \\
\mathtt{rad.S\_net\_shdwall\_dif\_nir}\left( t \right) &amp;= \frac{\left( \left( \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) + \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) + \left( 1 - \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) + \mathtt{rad.\alpha\_road\_dif\_nir}\left( t \right) ~ \mathtt{rad.S\_road\_dif\_nir}\left( t \right) ~ \left( 1 + \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.T\_ww}\left( t \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\alpha\_wall\_dif\_nir}\left( t \right) \right)}{\mathtt{rad.det\_dif\_nir}\left( t \right)} \\
\mathtt{rad.S\_refl\_sky\_dif\_nir}\left( t \right) &amp;= \mathtt{rad.S\_road\_dif\_nir}\left( t \right) - \mathtt{rad.S\_net\_road\_dif\_nir}\left( t \right) + 2 ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right) - \left( \mathtt{rad.S\_net\_shdwall\_dif\_nir}\left( t \right) + \mathtt{rad.S\_net\_sunwall\_dif\_nir}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.S\_net\_road}\left( t \right) &amp;= \mathtt{rad.S\_net\_road\_dir\_vis}\left( t \right) + \mathtt{rad.S\_net\_road\_dif\_nir}\left( t \right) + \mathtt{rad.S\_net\_road\_dir\_nir}\left( t \right) + \mathtt{rad.S\_net\_road\_dif\_vis}\left( t \right) \\
\mathtt{rad.S\_net\_sunwall}\left( t \right) &amp;= \mathtt{rad.S\_net\_sunwall\_dir\_nir}\left( t \right) + \mathtt{rad.S\_net\_sunwall\_dir\_vis}\left( t \right) + \mathtt{rad.S\_net\_sunwall\_dif\_nir}\left( t \right) + \mathtt{rad.S\_net\_sunwall\_dif\_vis}\left( t \right) \\
\mathtt{rad.S\_net\_shdwall}\left( t \right) &amp;= \mathtt{rad.S\_net\_shdwall\_dif\_vis}\left( t \right) + \mathtt{rad.S\_net\_shdwall\_dir\_nir}\left( t \right) + \mathtt{rad.S\_net\_shdwall\_dif\_nir}\left( t \right) + \mathtt{rad.S\_net\_shdwall\_dir\_vis}\left( t \right) \\
\mathtt{rad.S\_net\_uc}\left( t \right) &amp;= \mathtt{rad.S\_net\_road}\left( t \right) + \left( \mathtt{rad.S\_net\_shdwall}\left( t \right) + \mathtt{rad.S\_net\_sunwall}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.\alpha\_uc\_dir\_vis}\left( t \right) &amp;= ifelse\left( \mathtt{rad.S\_road\_dir\_vis}\left( t \right) + \mathtt{rad.S\_sunwall\_dir\_vis}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right) &gt; \mathtt{rad.zero\_wm2}, \frac{\mathtt{rad.S\_refl\_sky\_dir\_vis}\left( t \right)}{\mathtt{rad.S\_road\_dir\_vis}\left( t \right) + \mathtt{rad.S\_sunwall\_dir\_vis}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right)}, 0 \right) \\
\mathtt{rad.\alpha\_uc\_dir\_nir}\left( t \right) &amp;= ifelse\left( \mathtt{rad.S\_road\_dir\_nir}\left( t \right) + \mathtt{rad.S\_sunwall\_dir\_nir}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right) &gt; \mathtt{rad.zero\_wm2}, \frac{\mathtt{rad.S\_refl\_sky\_dir\_nir}\left( t \right)}{\mathtt{rad.S\_road\_dir\_nir}\left( t \right) + \mathtt{rad.S\_sunwall\_dir\_nir}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right)}, 0 \right) \\
\mathtt{rad.\alpha\_uc\_dif\_vis}\left( t \right) &amp;= ifelse\left( \mathtt{rad.S\_road\_dif\_vis}\left( t \right) + 2 ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right) &gt; \mathtt{rad.zero\_wm2}, \frac{\mathtt{rad.S\_refl\_sky\_dif\_vis}\left( t \right)}{\mathtt{rad.S\_road\_dif\_vis}\left( t \right) + 2 ~ \mathtt{rad.S\_wall\_dif\_vis}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right)}, 0 \right) \\
\mathtt{rad.\alpha\_uc\_dif\_nir}\left( t \right) &amp;= ifelse\left( \mathtt{rad.S\_road\_dif\_nir}\left( t \right) + 2 ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right) &gt; \mathtt{rad.zero\_wm2}, \frac{\mathtt{rad.S\_refl\_sky\_dif\_nir}\left( t \right)}{\mathtt{rad.S\_road\_dif\_nir}\left( t \right) + 2 ~ \mathtt{rad.S\_wall\_dif\_nir}\left( t \right) ~ \mathtt{rad.H\_W}\left( t \right)}, 0 \right) \\
\mathtt{rad.S\_net\_total}\left( t \right) &amp;= \mathtt{rad.S\_net\_roof}\left( t \right) ~ \mathtt{rad.W\_roof}\left( t \right) + \left( 1 - \mathtt{rad.W\_roof}\left( t \right) \right) ~ \mathtt{rad.S\_net\_uc}\left( t \right) \\
\mathtt{rad.L\_up\_roof}\left( t \right) &amp;= \mathtt{rad.L\_atm\_down}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_roof}\left( t \right) \right) + \left( \mathtt{rad.T\_roof}\left( t \right) \right)^{4} ~ \mathtt{rad.\sigma\_SB} ~ \mathtt{rad.\varepsilon\_roof}\left( t \right) \\
\mathtt{rad.L\_net\_roof}\left( t \right) &amp;=  - \mathtt{rad.L\_atm\_down}\left( t \right) + \mathtt{rad.L\_up\_roof}\left( t \right) \\
\mathtt{rad.L\_emit\_road}\left( t \right) &amp;= \left( \mathtt{rad.T\_road}\left( t \right) \right)^{4} ~ \mathtt{rad.\sigma\_SB} ~ \mathtt{rad.\varepsilon\_road}\left( t \right) \\
\mathtt{rad.L\_emit\_sunwall}\left( t \right) &amp;= \left( \mathtt{rad.T\_sunwall}\left( t \right) \right)^{4} ~ \mathtt{rad.\sigma\_SB} ~ \mathtt{rad.\varepsilon\_wall}\left( t \right) \\
\mathtt{rad.L\_emit\_shdwall}\left( t \right) &amp;= \left( \mathtt{rad.T\_shdwall}\left( t \right) \right)^{4} ~ \mathtt{rad.\sigma\_SB} ~ \mathtt{rad.\varepsilon\_wall}\left( t \right) \\
\mathtt{rad.det\_lw}\left( t \right) &amp;= 1 - \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} - 2 ~ \mathtt{rad.T\_rw}\left( t \right) ~ \left( 1 + \mathtt{rad.T\_ww}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_road}\left( t \right) \right) \\
\mathtt{rad.L\_net\_road}\left( t \right) &amp;= \mathtt{rad.L\_emit\_road}\left( t \right) + \frac{ - \left( \left( \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.L\_atm\_down}\left( t \right) + \mathtt{rad.L\_emit\_road}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) + \mathtt{rad.T\_ww}\left( t \right) ~ \mathtt{rad.L\_emit\_shdwall}\left( t \right) \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \left( 1 + \mathtt{rad.T\_ww}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) + \left( \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.L\_atm\_down}\left( t \right) + \mathtt{rad.L\_emit\_road}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) + \mathtt{rad.T\_ww}\left( t \right) ~ \mathtt{rad.L\_emit\_sunwall}\left( t \right) \right) ~ \mathtt{rad.T\_rw}\left( t \right) ~ \left( 1 + \mathtt{rad.T\_ww}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) + \left( \mathtt{rad.L\_atm\_down}\left( t \right) ~ \mathtt{rad.\Psi\_sky\_road}\left( t \right) + \mathtt{rad.T\_rw}\left( t \right) ~ \left( \mathtt{rad.L\_emit\_shdwall}\left( t \right) + \mathtt{rad.L\_emit\_sunwall}\left( t \right) \right) \right) ~ \left( 1 - \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right)^{2} ~ \left( \mathtt{rad.T\_ww}\left( t \right) \right)^{2} \right) \right) ~ \mathtt{rad.\varepsilon\_road}\left( t \right)}{\mathtt{rad.det\_lw}\left( t \right)} \\
\mathtt{rad.L\_net\_sunwall}\left( t \right) &amp;= \frac{ - \left( \left( \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.L\_atm\_down}\left( t \right) + \mathtt{rad.L\_emit\_road}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) + \mathtt{rad.T\_ww}\left( t \right) ~ \mathtt{rad.L\_emit\_shdwall}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_road}\left( t \right) \right) \right) + \left( \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.L\_atm\_down}\left( t \right) + \mathtt{rad.L\_emit\_road}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) + \mathtt{rad.T\_ww}\left( t \right) ~ \mathtt{rad.L\_emit\_sunwall}\left( t \right) \right) ~ \left( \mathtt{rad.T\_ww}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) + \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_road}\left( t \right) \right) \right) + \left( \mathtt{rad.L\_atm\_down}\left( t \right) ~ \mathtt{rad.\Psi\_sky\_road}\left( t \right) + \mathtt{rad.T\_rw}\left( t \right) ~ \left( \mathtt{rad.L\_emit\_shdwall}\left( t \right) + \mathtt{rad.L\_emit\_sunwall}\left( t \right) \right) \right) ~ \left( 1 + \mathtt{rad.T\_ww}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_road}\left( t \right) \right) \right) ~ \mathtt{rad.\varepsilon\_wall}\left( t \right)}{\mathtt{rad.det\_lw}\left( t \right)} + \mathtt{rad.L\_emit\_sunwall}\left( t \right) \\
\mathtt{rad.L\_net\_shdwall}\left( t \right) &amp;= \frac{ - \left( \left( \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.L\_atm\_down}\left( t \right) + \mathtt{rad.L\_emit\_road}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) + \mathtt{rad.T\_ww}\left( t \right) ~ \mathtt{rad.L\_emit\_sunwall}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_road}\left( t \right) \right) \right) + \left( \mathtt{rad.\Psi\_sky\_wall}\left( t \right) ~ \mathtt{rad.L\_atm\_down}\left( t \right) + \mathtt{rad.L\_emit\_road}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) + \mathtt{rad.T\_ww}\left( t \right) ~ \mathtt{rad.L\_emit\_shdwall}\left( t \right) \right) ~ \left( \mathtt{rad.T\_ww}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) + \mathtt{rad.T\_rw}\left( t \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_road}\left( t \right) \right) \right) + \left( \mathtt{rad.L\_atm\_down}\left( t \right) ~ \mathtt{rad.\Psi\_sky\_road}\left( t \right) + \mathtt{rad.T\_rw}\left( t \right) ~ \left( \mathtt{rad.L\_emit\_shdwall}\left( t \right) + \mathtt{rad.L\_emit\_sunwall}\left( t \right) \right) \right) ~ \left( 1 + \mathtt{rad.T\_ww}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_wall}\left( t \right) \right) \right) ~ \mathtt{rad.T\_wr}\left( t \right) ~ \left( 1 - \mathtt{rad.\varepsilon\_road}\left( t \right) \right) \right) ~ \mathtt{rad.\varepsilon\_wall}\left( t \right)}{\mathtt{rad.det\_lw}\left( t \right)} + \mathtt{rad.L\_emit\_shdwall}\left( t \right) \\
\mathtt{rad.L\_net\_uc}\left( t \right) &amp;= \mathtt{rad.L\_net\_road}\left( t \right) + \left( \mathtt{rad.L\_net\_shdwall}\left( t \right) + \mathtt{rad.L\_net\_sunwall}\left( t \right) \right) ~ \mathtt{rad.H\_W}\left( t \right) \\
\mathtt{rad.L\_net\_total}\left( t \right) &amp;= \mathtt{rad.L\_net\_roof}\left( t \right) ~ \mathtt{rad.W\_roof}\left( t \right) + \left( 1 - \mathtt{rad.W\_roof}\left( t \right) \right) ~ \mathtt{rad.L\_net\_uc}\left( t \right) \\
\mathtt{flux.\lambda\_p}\left( t \right) &amp;= \frac{\mathtt{flux.H\_W}\left( t \right)}{1 + \mathtt{flux.H\_W}\left( t \right)} \\
\mathtt{flux.\lambda\_F}\left( t \right) &amp;= \left( 1 - \mathtt{flux.\lambda\_p}\left( t \right) \right) ~ \mathtt{flux.H\_W}\left( t \right) \\
\mathtt{flux.d\_canopy}\left( t \right) &amp;= \left( 1 + \mathtt{flux.\alpha\_rough}^{ - \mathtt{flux.\lambda\_p}\left( t \right)} ~ \left( -1 + \mathtt{flux.\lambda\_p}\left( t \right) \right) \right) ~ \mathtt{flux.H\_canyon}\left( t \right) \\
\mathtt{flux.z\_0m\_canopy}\left( t \right) &amp;= e^{\frac{-1}{\left( \frac{0.5 ~ \mathtt{flux.B\_drag} ~ \mathtt{flux.C\_D} ~ \mathtt{flux.\lambda\_F}\left( t \right) ~ \left( 1 + \frac{ - \mathtt{flux.d\_canopy}\left( t \right)}{\mathtt{flux.H\_canyon}\left( t \right)} \right)}{\mathtt{flux.k\_vk}^{2}} \right)^{0.5}}} ~ \left( 1 + \frac{ - \mathtt{flux.d\_canopy}\left( t \right)}{\mathtt{flux.H\_canyon}\left( t \right)} \right) ~ \mathtt{flux.H\_canyon}\left( t \right) \\
\mathtt{flux.V\_r}\left( t \right) &amp;= max\left( \sqrt{\left( \mathtt{flux.u\_atm}\left( t \right) \right)^{2} + \left( \mathtt{flux.v\_atm}\left( t \right) \right)^{2}}, \mathtt{flux.one\_ms} \right) \\
\mathtt{flux.L\_MO}\left( t \right) &amp;= \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.\zeta\_in}\left( t \right)} \\
\mathtt{flux.\zeta\_0m}\left( t \right) &amp;= \frac{\mathtt{flux.z\_0m\_canopy}\left( t \right)}{\mathtt{flux.L\_MO}\left( t \right)} \\
\mathtt{flux.\zeta\_h}\left( t \right) &amp;= \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_h}\left( t \right)}{\mathtt{flux.L\_MO}\left( t \right)} \\
\mathtt{flux.\zeta\_0h}\left( t \right) &amp;= \frac{\mathtt{flux.z\_0m\_canopy}\left( t \right)}{\mathtt{flux.L\_MO}\left( t \right)} \\
\mathtt{flux.\zeta\_w}\left( t \right) &amp;= \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_w}\left( t \right)}{\mathtt{flux.L\_MO}\left( t \right)} \\
\mathtt{flux.\zeta\_0w}\left( t \right) &amp;= \frac{\mathtt{flux.z\_0m\_canopy}\left( t \right)}{\mathtt{flux.L\_MO}\left( t \right)} \\
\mathtt{flux.\psi\_m\_atm}\left( t \right) &amp;= ifelse\left( \mathtt{flux.\zeta\_in}\left( t \right) &lt; \mathtt{flux.\zeta\_m\_threshold}, \frac{\mathtt{flux.\pi\_val}}{2} + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_m\_threshold} \right)^{0.25}}{2} \right) + \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_m\_threshold} \right)^{0.5}}{2} \right) - 2 ~ \arctan\left( \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_m\_threshold} \right)^{0.25} \right) + \log\left( \frac{\mathtt{flux.\zeta\_in}\left( t \right)}{\mathtt{flux.\zeta\_m\_threshold}} \right) - \mathtt{flux.c\_vu\_m} ~ \left(  - \left(  - \mathtt{flux.\zeta\_m\_threshold} \right)^{0.33333} + \left(  - \mathtt{flux.\zeta\_in}\left( t \right) \right)^{0.33333} \right), ifelse\left( \mathtt{flux.\zeta\_in}\left( t \right) &lt; 0, \frac{\mathtt{flux.\pi\_val}}{2} - 2 ~ \arctan\left( \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_in}\left( t \right) \right)^{0.25} \right) + \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_in}\left( t \right) \right)^{0.5}}{2} \right) + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_in}\left( t \right) \right)^{0.25}}{2} \right), ifelse\left( \mathtt{flux.\zeta\_in}\left( t \right) \leq 1,  - \mathtt{flux.a\_BD} ~ \mathtt{flux.\zeta\_in}\left( t \right), 1 - \mathtt{flux.a\_BD} - \mathtt{flux.\zeta\_in}\left( t \right) + \left( 1 - \mathtt{flux.a\_BD} \right) ~ \log\left( \mathtt{flux.\zeta\_in}\left( t \right) \right) \right) \right) \right) \\
\mathtt{flux.\psi\_m\_0}\left( t \right) &amp;= ifelse\left( \mathtt{flux.\zeta\_0m}\left( t \right) &lt; \mathtt{flux.\zeta\_m\_threshold}, \frac{\mathtt{flux.\pi\_val}}{2} + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_m\_threshold} \right)^{0.25}}{2} \right) + \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_m\_threshold} \right)^{0.5}}{2} \right) + \log\left( \frac{\mathtt{flux.\zeta\_0m}\left( t \right)}{\mathtt{flux.\zeta\_m\_threshold}} \right) - 2 ~ \arctan\left( \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_m\_threshold} \right)^{0.25} \right) - \mathtt{flux.c\_vu\_m} ~ \left(  - \left(  - \mathtt{flux.\zeta\_m\_threshold} \right)^{0.33333} + \left(  - \mathtt{flux.\zeta\_0m}\left( t \right) \right)^{0.33333} \right), ifelse\left( \mathtt{flux.\zeta\_0m}\left( t \right) &lt; 0, \frac{\mathtt{flux.\pi\_val}}{2} - 2 ~ \arctan\left( \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_0m}\left( t \right) \right)^{0.25} \right) + \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_0m}\left( t \right) \right)^{0.5}}{2} \right) + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_0m}\left( t \right) \right)^{0.25}}{2} \right), ifelse\left( \mathtt{flux.\zeta\_0m}\left( t \right) \leq 1,  - \mathtt{flux.a\_BD} ~ \mathtt{flux.\zeta\_0m}\left( t \right), 1 - \mathtt{flux.a\_BD} - \mathtt{flux.\zeta\_0m}\left( t \right) + \left( 1 - \mathtt{flux.a\_BD} \right) ~ \log\left( \mathtt{flux.\zeta\_0m}\left( t \right) \right) \right) \right) \right) \\
\mathtt{flux.\psi\_h\_atm}\left( t \right) &amp;= ifelse\left( \mathtt{flux.\zeta\_h}\left( t \right) &lt; \mathtt{flux.\zeta\_h\_threshold}, \mathtt{flux.c\_vu\_h} ~ \left( \frac{-1}{\left(  - \mathtt{flux.\zeta\_h\_threshold} \right)^{0.33333}} + \frac{1}{\left(  - \mathtt{flux.\zeta\_h}\left( t \right) \right)^{0.33333}} \right) + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_h\_threshold} \right)^{0.5}}{2} \right) + \log\left( \frac{\mathtt{flux.\zeta\_h}\left( t \right)}{\mathtt{flux.\zeta\_h\_threshold}} \right), ifelse\left( \mathtt{flux.\zeta\_h}\left( t \right) &lt; 0, 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_h}\left( t \right) \right)^{0.5}}{2} \right), ifelse\left( \mathtt{flux.\zeta\_h}\left( t \right) \leq 1,  - \mathtt{flux.a\_BD} ~ \mathtt{flux.\zeta\_h}\left( t \right), 1 - \mathtt{flux.a\_BD} - \mathtt{flux.\zeta\_h}\left( t \right) + \left( 1 - \mathtt{flux.a\_BD} \right) ~ \log\left( \mathtt{flux.\zeta\_h}\left( t \right) \right) \right) \right) \right) \\
\mathtt{flux.\psi\_h\_0}\left( t \right) &amp;= ifelse\left( \mathtt{flux.\zeta\_0h}\left( t \right) &lt; \mathtt{flux.\zeta\_h\_threshold}, \mathtt{flux.c\_vu\_h} ~ \left( \frac{-1}{\left(  - \mathtt{flux.\zeta\_h\_threshold} \right)^{0.33333}} + \frac{1}{\left(  - \mathtt{flux.\zeta\_0h}\left( t \right) \right)^{0.33333}} \right) + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_h\_threshold} \right)^{0.5}}{2} \right) + \log\left( \frac{\mathtt{flux.\zeta\_0h}\left( t \right)}{\mathtt{flux.\zeta\_h\_threshold}} \right), ifelse\left( \mathtt{flux.\zeta\_0h}\left( t \right) &lt; 0, 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_0h}\left( t \right) \right)^{0.5}}{2} \right), ifelse\left( \mathtt{flux.\zeta\_0h}\left( t \right) \leq 1,  - \mathtt{flux.a\_BD} ~ \mathtt{flux.\zeta\_0h}\left( t \right), 1 - \mathtt{flux.a\_BD} - \mathtt{flux.\zeta\_0h}\left( t \right) + \left( 1 - \mathtt{flux.a\_BD} \right) ~ \log\left( \mathtt{flux.\zeta\_0h}\left( t \right) \right) \right) \right) \right) \\
\mathtt{flux.\psi\_w\_atm}\left( t \right) &amp;= ifelse\left( \mathtt{flux.\zeta\_w}\left( t \right) &lt; \mathtt{flux.\zeta\_h\_threshold}, \mathtt{flux.c\_vu\_h} ~ \left( \frac{-1}{\left(  - \mathtt{flux.\zeta\_h\_threshold} \right)^{0.33333}} + \frac{1}{\left(  - \mathtt{flux.\zeta\_w}\left( t \right) \right)^{0.33333}} \right) + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_h\_threshold} \right)^{0.5}}{2} \right) + \log\left( \frac{\mathtt{flux.\zeta\_w}\left( t \right)}{\mathtt{flux.\zeta\_h\_threshold}} \right), ifelse\left( \mathtt{flux.\zeta\_w}\left( t \right) &lt; 0, 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_w}\left( t \right) \right)^{0.5}}{2} \right), ifelse\left( \mathtt{flux.\zeta\_w}\left( t \right) \leq 1,  - \mathtt{flux.a\_BD} ~ \mathtt{flux.\zeta\_w}\left( t \right), 1 - \mathtt{flux.a\_BD} - \mathtt{flux.\zeta\_w}\left( t \right) + \left( 1 - \mathtt{flux.a\_BD} \right) ~ \log\left( \mathtt{flux.\zeta\_w}\left( t \right) \right) \right) \right) \right) \\
\mathtt{flux.\psi\_w\_0}\left( t \right) &amp;= ifelse\left( \mathtt{flux.\zeta\_0w}\left( t \right) &lt; \mathtt{flux.\zeta\_h\_threshold}, \mathtt{flux.c\_vu\_h} ~ \left( \frac{-1}{\left(  - \mathtt{flux.\zeta\_h\_threshold} \right)^{0.33333}} + \frac{1}{\left(  - \mathtt{flux.\zeta\_0w}\left( t \right) \right)^{0.33333}} \right) + \log\left( \frac{\mathtt{flux.\zeta\_0w}\left( t \right)}{\mathtt{flux.\zeta\_h\_threshold}} \right) + 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_h\_threshold} \right)^{0.5}}{2} \right), ifelse\left( \mathtt{flux.\zeta\_0w}\left( t \right) &lt; 0, 2 ~ \log\left( \frac{1 + \left( 1 - \mathtt{flux.\gamma\_BD} ~ \mathtt{flux.\zeta\_0w}\left( t \right) \right)^{0.5}}{2} \right), ifelse\left( \mathtt{flux.\zeta\_0w}\left( t \right) \leq 1,  - \mathtt{flux.a\_BD} ~ \mathtt{flux.\zeta\_0w}\left( t \right), 1 - \mathtt{flux.a\_BD} - \mathtt{flux.\zeta\_0w}\left( t \right) + \left( 1 - \mathtt{flux.a\_BD} \right) ~ \log\left( \mathtt{flux.\zeta\_0w}\left( t \right) \right) \right) \right) \right) \\
\mathtt{flux.\theta\_v\_atm}\left( t \right) &amp;= \left( 1 + \mathtt{flux.c\_virt} ~ \mathtt{flux.q\_atm}\left( t \right) \right) ~ \mathtt{flux.\theta\_atm}\left( t \right) \\
\mathtt{flux.U\_c}\left( t \right) &amp;= \mathtt{flux.\beta\_conv} ~ ifelse\left( \mathtt{flux.\zeta\_in}\left( t \right) &lt; 0, \left( max\left( \frac{ - \mathtt{flux.z\_i} ~ \mathtt{flux.\zeta\_in}\left( t \right)}{\mathtt{flux.k\_vk} ~ \left(  - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right) \right)}, 0 \right) \right)^{0.33333} ~ max\left( \frac{\mathtt{flux.k\_vk} ~ \mathtt{flux.V\_r}\left( t \right)}{\log\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)} \right) - \mathtt{flux.\psi\_m\_atm}\left( t \right) + \mathtt{flux.\psi\_m\_0}\left( t \right)}, 0.01 ~ \mathtt{flux.one\_ms} \right), \mathtt{flux.zero\_ms} \right) \\
\mathtt{flux.V\_a}\left( t \right) &amp;= max\left( \sqrt{\left( \mathtt{flux.U\_c}\left( t \right) \right)^{2} + \left( \mathtt{flux.u\_atm}\left( t \right) \right)^{2} + \left( \mathtt{flux.v\_atm}\left( t \right) \right)^{2}}, \mathtt{flux.one\_ms} \right) \\
\mathtt{flux.u\_star}\left( t \right) &amp;= max\left( \frac{\mathtt{flux.k\_vk} ~ \mathtt{flux.V\_a}\left( t \right)}{\log\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)} \right) - \mathtt{flux.\psi\_m\_atm}\left( t \right) + \mathtt{flux.\psi\_m\_0}\left( t \right)}, 0.01 ~ \mathtt{flux.one\_ms} \right) \\
\mathtt{flux.r\_am}\left( t \right) &amp;= \frac{\mathtt{flux.V\_a}\left( t \right)}{\left( \mathtt{flux.u\_star}\left( t \right) \right)^{2}} \\
\mathtt{flux.r\_ah}\left( t \right) &amp;= \frac{\left(  - \mathtt{flux.\psi\_h\_atm}\left( t \right) + \mathtt{flux.\psi\_h\_0}\left( t \right) + \log\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_h}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)} \right) \right) ~ \left( \log\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)} \right) - \mathtt{flux.\psi\_m\_atm}\left( t \right) + \mathtt{flux.\psi\_m\_0}\left( t \right) \right)}{\mathtt{flux.k\_vk}^{2} ~ \mathtt{flux.V\_a}\left( t \right)} \\
\mathtt{flux.r\_aw}\left( t \right) &amp;= \frac{\left( \log\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)} \right) - \mathtt{flux.\psi\_m\_atm}\left( t \right) + \mathtt{flux.\psi\_m\_0}\left( t \right) \right) ~ \left( \log\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_w}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)} \right) - \mathtt{flux.\psi\_w\_atm}\left( t \right) + \mathtt{flux.\psi\_w\_0}\left( t \right) \right)}{\mathtt{flux.k\_vk}^{2} ~ \mathtt{flux.V\_a}\left( t \right)} \\
\mathtt{flux.U\_can}\left( t \right) &amp;= ifelse\left( \mathtt{flux.H\_W}\left( t \right) \geq 1, \frac{2 ~ \log\left( max\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.H\_canyon}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)}, 1 \right) \right) ~ \mathtt{flux.V\_r}\left( t \right) ~ e^{ - 0.5 ~ \left( 1 + \frac{ - \mathtt{flux.H\_w\_est}\left( t \right)}{\mathtt{flux.H\_canyon}\left( t \right)} \right) ~ \mathtt{flux.H\_W}\left( t \right)}}{\mathtt{flux.\pi\_val} ~ \log\left( max\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)}, 1 \right) \right)}, ifelse\left( \mathtt{flux.H\_W}\left( t \right) \geq 0.5, \frac{\left( 1 + 2 ~ \left( -1 + \frac{2}{\mathtt{flux.\pi\_val}} \right) ~ \left( -0.5 + \mathtt{flux.H\_W}\left( t \right) \right) \right) ~ \log\left( max\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.H\_canyon}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)}, 1 \right) \right) ~ \mathtt{flux.V\_r}\left( t \right) ~ e^{ - 0.5 ~ \left( 1 + \frac{ - \mathtt{flux.H\_w\_est}\left( t \right)}{\mathtt{flux.H\_canyon}\left( t \right)} \right) ~ \mathtt{flux.H\_W}\left( t \right)}}{\log\left( max\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)}, 1 \right) \right)}, \frac{\log\left( max\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.H\_canyon}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)}, 1 \right) \right) ~ \mathtt{flux.V\_r}\left( t \right) ~ e^{ - 0.5 ~ \left( 1 + \frac{ - \mathtt{flux.H\_w\_est}\left( t \right)}{\mathtt{flux.H\_canyon}\left( t \right)} \right) ~ \mathtt{flux.H\_W}\left( t \right)}}{\log\left( max\left( \frac{ - \mathtt{flux.d\_canopy}\left( t \right) + \mathtt{flux.z\_atm\_m}\left( t \right)}{\mathtt{flux.z\_0m\_canopy}\left( t \right)}, 1 \right) \right)} \right) \right) \\
\mathtt{flux.U\_ac}\left( t \right) &amp;= \sqrt{\left( \mathtt{flux.u\_star}\left( t \right) \right)^{2} + \left( \mathtt{flux.U\_can}\left( t \right) \right)^{2}} \\
\mathtt{flux.r\_s\_u}\left( t \right) &amp;= \frac{\mathtt{flux.C\_p} ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.h\_c\_free} + \mathtt{flux.h\_c\_forced} ~ \mathtt{flux.U\_ac}\left( t \right)} \\
\mathtt{flux.c\_a\_h}\left( t \right) &amp;= \frac{1}{\mathtt{flux.r\_ah}\left( t \right)} \\
\mathtt{flux.c\_a\_w}\left( t \right) &amp;= \frac{1}{\mathtt{flux.r\_aw}\left( t \right)} \\
\mathtt{flux.T\_ac}\left( t \right) &amp;= \frac{\frac{\mathtt{flux.T\_g\_sunwall}\left( t \right) ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right) ~ \mathtt{flux.T\_g\_imprvrd}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.T\_g\_shdwall}\left( t \right) ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.T\_g\_prvrd}\left( t \right) ~ \mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right) ~ \mathtt{flux.T\_g\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) ~ \mathtt{flux.\theta\_atm}\left( t \right)}{\frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)}} \\
\mathtt{flux.q\_ac}\left( t \right) &amp;= \frac{\frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right) ~ \mathtt{flux.f\_wet\_imprvrd}\left( t \right) ~ \mathtt{flux.q\_g\_imprvrd}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.q\_g\_roof}\left( t \right) ~ \mathtt{flux.f\_wet\_roof}\left( t \right) ~ \mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \mathtt{flux.q\_g\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.q\_atm}\left( t \right) ~ \mathtt{flux.c\_a\_w}\left( t \right)}{\frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right) ~ \mathtt{flux.f\_wet\_imprvrd}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_w}\left( t \right) + \frac{\mathtt{flux.f\_wet\_roof}\left( t \right) ~ \mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)}} \\
\mathtt{flux.H\_roof}\left( t \right) &amp;= \frac{ - \mathtt{flux.C\_p} ~ \left( \mathtt{flux.T\_ac}\left( t \right) - \mathtt{flux.T\_g\_roof}\left( t \right) \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.H\_prvrd}\left( t \right) &amp;= \frac{ - \mathtt{flux.C\_p} ~ \left( \mathtt{flux.T\_ac}\left( t \right) - \mathtt{flux.T\_g\_prvrd}\left( t \right) \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.H\_imprvrd}\left( t \right) &amp;= \frac{ - \mathtt{flux.C\_p} ~ \left( \mathtt{flux.T\_ac}\left( t \right) - \mathtt{flux.T\_g\_imprvrd}\left( t \right) \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.H\_sunwall}\left( t \right) &amp;= \frac{ - \mathtt{flux.C\_p} ~ \left( \mathtt{flux.T\_ac}\left( t \right) - \mathtt{flux.T\_g\_sunwall}\left( t \right) \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.H\_shdwall}\left( t \right) &amp;= \frac{ - \mathtt{flux.C\_p} ~ \left( \mathtt{flux.T\_ac}\left( t \right) - \mathtt{flux.T\_g\_shdwall}\left( t \right) \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.H\_total}\left( t \right) &amp;= \mathtt{flux.H\_roof}\left( t \right) ~ \mathtt{flux.W\_roof}\left( t \right) + \left( \mathtt{flux.H\_shdwall}\left( t \right) ~ \mathtt{flux.H\_W}\left( t \right) + \mathtt{flux.H\_sunwall}\left( t \right) ~ \mathtt{flux.H\_W}\left( t \right) + \mathtt{flux.f\_prvrd}\left( t \right) ~ \mathtt{flux.H\_prvrd}\left( t \right) + \left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \mathtt{flux.H\_imprvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right) \\
\mathtt{flux.E\_roof}\left( t \right) &amp;= \frac{ - \left(  - \mathtt{flux.q\_g\_roof}\left( t \right) + \mathtt{flux.q\_ac}\left( t \right) \right) ~ \mathtt{flux.f\_wet\_roof}\left( t \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.E\_prvrd}\left( t \right) &amp;= \frac{ - \mathtt{flux.\rho\_atm}\left( t \right) ~ \left(  - \mathtt{flux.q\_g\_prvrd}\left( t \right) + \mathtt{flux.q\_ac}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.E\_imprvrd}\left( t \right) &amp;= \frac{ - \mathtt{flux.\rho\_atm}\left( t \right) ~ \left( \mathtt{flux.q\_ac}\left( t \right) - \mathtt{flux.q\_g\_imprvrd}\left( t \right) \right) ~ \mathtt{flux.f\_wet\_imprvrd}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.E\_total}\left( t \right) &amp;= \mathtt{flux.E\_roof}\left( t \right) ~ \mathtt{flux.W\_roof}\left( t \right) + \left( \mathtt{flux.f\_prvrd}\left( t \right) ~ \mathtt{flux.E\_prvrd}\left( t \right) + \left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \mathtt{flux.E\_imprvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right) \\
\mathtt{flux.\tau\_x}\left( t \right) &amp;= \frac{ - \mathtt{flux.u\_atm}\left( t \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\mathtt{flux.r\_am}\left( t \right)} \\
\mathtt{flux.\tau\_y}\left( t \right) &amp;= \frac{ - \mathtt{flux.\rho\_atm}\left( t \right) ~ \mathtt{flux.v\_atm}\left( t \right)}{\mathtt{flux.r\_am}\left( t \right)} \\
\mathtt{flux.dH\_roof\_dT}\left( t \right) &amp;= \frac{\mathtt{flux.C\_p} ~ \left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.dH\_prvrd\_dT}\left( t \right) &amp;= \frac{\mathtt{flux.C\_p} ~ \left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.dH\_imprvrd\_dT}\left( t \right) &amp;= \frac{\mathtt{flux.C\_p} ~ \left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.dH\_sunwall\_dT}\left( t \right) &amp;= \frac{\mathtt{flux.C\_p} ~ \left( \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.r\_s\_u}\left( t \right)} \\
\mathtt{flux.dH\_shdwall\_dT}\left( t \right) &amp;= \frac{\mathtt{flux.C\_p} ~ \left( \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.\rho\_atm}\left( t \right)}{\left( \frac{2 ~ \mathtt{flux.H\_W}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \mathtt{flux.c\_a\_h}\left( t \right) + \frac{\mathtt{flux.f\_prvrd}\left( t \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\mathtt{flux.W\_roof}\left( t \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} + \frac{\left( 1 - \mathtt{flux.f\_prvrd}\left( t \right) \right) ~ \left( 1 - \mathtt{flux.W\_roof}\left( t \right) \right)}{\mathtt{flux.r\_s\_u}\left( t \right)} \right) ~ \mathtt{flux.r\_s\_u}\left( t \right)}
\end{align}
 \]</p><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="UCL-Air-Temperature-vs-Atmospheric-Temperature"><a class="docs-heading-anchor" href="#UCL-Air-Temperature-vs-Atmospheric-Temperature">UCL Air Temperature vs Atmospheric Temperature</a><a id="UCL-Air-Temperature-vs-Atmospheric-Temperature-1"></a><a class="docs-heading-anchor-permalink" href="#UCL-Air-Temperature-vs-Atmospheric-Temperature" title="Permalink"></a></h3><p>This example shows how the urban canopy layer air temperature (T_ac) varies with atmospheric temperature for different canyon height-to-width ratios. Surfaces warmer than the atmosphere create the urban heat island effect.</p><pre><code class="language-julia hljs">using OrdinaryDiffEqDefault, Plots

compiled = mtkcompile(sys)

function solve_ucm(compiled, params)
    prob = ODEProblem(compiled, params, (0.0, 1.0))
    sol = solve(prob)
    return sol
end

# Baseline parameters
function make_params(compiled; T_atm_val=300.0, H_W_val=1.0, S_atm_val=500.0)
    Dict(
        compiled.S_atm =&gt; S_atm_val,
        compiled.T_atm =&gt; T_atm_val,
        compiled.P_atm =&gt; 101325.0,
        compiled.q_atm =&gt; 0.01,
        compiled.W_atm =&gt; 4.0,
        compiled.P_precip =&gt; 0.0,
        compiled.μ_zen =&gt; 0.7854,
        compiled.H_W =&gt; H_W_val,
        compiled.W_roof =&gt; 0.25,
        compiled.H_canyon =&gt; 10.0,
        compiled.f_prvrd =&gt; 0.5,
        compiled.H_w_est =&gt; 5.0,
        compiled.z_0 =&gt; 0.5,
        compiled.z_d =&gt; 5.0,
        compiled.α_roof_dir_vis =&gt; 0.2,
        compiled.α_roof_dir_nir =&gt; 0.2,
        compiled.α_roof_dif_vis =&gt; 0.2,
        compiled.α_roof_dif_nir =&gt; 0.2,
        compiled.α_road_dir_vis =&gt; 0.08,
        compiled.α_road_dir_nir =&gt; 0.08,
        compiled.α_road_dif_vis =&gt; 0.08,
        compiled.α_road_dif_nir =&gt; 0.08,
        compiled.α_wall_dir_vis =&gt; 0.25,
        compiled.α_wall_dir_nir =&gt; 0.25,
        compiled.α_wall_dif_vis =&gt; 0.25,
        compiled.α_wall_dif_nir =&gt; 0.25,
        compiled.ε_roof =&gt; 0.9,
        compiled.ε_road =&gt; 0.95,
        compiled.ε_wall =&gt; 0.9,
        compiled.T_g_roof =&gt; 310.0,
        compiled.T_g_prvrd =&gt; 305.0,
        compiled.T_g_imprvrd =&gt; 308.0,
        compiled.T_g_sunwall =&gt; 312.0,
        compiled.T_g_shdwall =&gt; 303.0,
        compiled.q_g_roof =&gt; 0.015,
        compiled.q_g_prvrd =&gt; 0.012,
        compiled.q_g_imprvrd =&gt; 0.014,
        compiled.f_wet_roof =&gt; 0.0,
        compiled.f_wet_imprvrd =&gt; 0.0,
        compiled.ζ_in =&gt; 0.1,
    )
end

T_atm_range = 285.0:1.0:310.0
H_W_vals = [0.5, 1.0, 2.0]

p = plot(xlabel=&quot;Atmospheric Temperature (K)&quot;, ylabel=&quot;UCL Air Temperature T_ac (K)&quot;,
         title=&quot;UCL Temperature vs Atmospheric Temperature&quot;,
         legend=:topleft)
plot!(p, T_atm_range, T_atm_range, label=&quot;T_ac = T_atm (1:1 line)&quot;, linestyle=:dash, color=:black)

for hw in H_W_vals
    T_ac_vals = Float64[]
    for T_atm_val in T_atm_range
        params = make_params(compiled; T_atm_val=T_atm_val, H_W_val=hw)
        sol = solve_ucm(compiled, params)
        push!(T_ac_vals, sol[compiled.flux.T_ac][end])
    end
    plot!(p, T_atm_range, T_ac_vals, label=&quot;H/W = $hw&quot;, linewidth=2)
end

p</code></pre><img src="86819f10.svg" alt="Example block output"/><h3 id="Diurnal-Cycle-Heat-Map-of-UCL-Air-Temperature"><a class="docs-heading-anchor" href="#Diurnal-Cycle-Heat-Map-of-UCL-Air-Temperature">Diurnal Cycle Heat Map of UCL Air Temperature</a><a id="Diurnal-Cycle-Heat-Map-of-UCL-Air-Temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Diurnal-Cycle-Heat-Map-of-UCL-Air-Temperature" title="Permalink"></a></h3><p>This example creates a spatial heat map showing how T_ac varies over a grid as solar radiation changes through the day. The grid represents spatial variation in atmospheric temperature (latitude axis) and urban density (longitude axis, via H/W ratio).</p><pre><code class="language-julia hljs">T_atm_grid = 290.0:2.0:310.0  # Temperature gradient (rows)
H_W_grid = 0.3:0.1:2.0        # Urban density gradient (columns)

# Simulate a diurnal cycle by varying S_atm (solar radiation proxy)
S_atm_vals = [0.0, 100.0, 300.0, 500.0, 700.0, 500.0, 300.0, 100.0, 0.0]
hour_labels = [&quot;0:00&quot;, &quot;3:00&quot;, &quot;6:00&quot;, &quot;9:00&quot;, &quot;12:00&quot;, &quot;15:00&quot;, &quot;18:00&quot;, &quot;21:00&quot;, &quot;24:00&quot;]

anim = @animate for (i, S_val) in enumerate(S_atm_vals)
    T_ac_grid = zeros(length(T_atm_grid), length(H_W_grid))
    for (ri, T_val) in enumerate(T_atm_grid)
        for (ci, hw_val) in enumerate(H_W_grid)
            params = make_params(compiled; T_atm_val=T_val, H_W_val=hw_val, S_atm_val=max(S_val, 1.0))
            sol = solve_ucm(compiled, params)
            T_ac_grid[ri, ci] = sol[compiled.flux.T_ac][end]
        end
    end
    heatmap(collect(H_W_grid), collect(T_atm_grid), T_ac_grid,
            xlabel=&quot;Canyon H/W Ratio&quot;, ylabel=&quot;Atmospheric Temperature (K)&quot;,
            title=&quot;UCL Air Temperature at $(hour_labels[i])&quot;,
            colorbar_title=&quot;T_ac (K)&quot;, clims=(290.0, 315.0),
            color=:thermal)
end

gif(anim, fps=2)</code></pre><img src="238ce6e3.gif" alt="Example block output"/><h3 id="GEOS-FP-Coupled-System"><a class="docs-heading-anchor" href="#GEOS-FP-Coupled-System">GEOS-FP Coupled System</a><a id="GEOS-FP-Coupled-System-1"></a><a class="docs-heading-anchor-permalink" href="#GEOS-FP-Coupled-System" title="Permalink"></a></h3><p>The <code>UrbanCanopyModel</code> can be coupled to GEOS-FP reanalysis data via the <code>EarthSciDataExt</code> package extension. This coupling automatically maps GEOS-FP surface meteorological fields to the model&#39;s forcing parameters and computes derived quantities (Monin-Obukhov stability, solar zenith angle) from GEOS-FP friction velocity, sensible heat flux, latitude, longitude, and time.</p><p>The following example creates a coupled system over a domain spanning part of the continental United States and inspects the coupling equations.</p><pre><code class="language-julia hljs">using EarthSciData, EarthSciMLBase, Dates

domain = DomainInfo(
    DateTime(2016, 5, 1),
    DateTime(2016, 5, 4);
    lonrange = deg2rad(-115):deg2rad(2.5):deg2rad(-68.75),
    latrange = deg2rad(25):deg2rad(2):deg2rad(53.7),
    levrange = 1:15,
)

csys = couple(
    UrbanCanopyModel(),
    GEOSFP(&quot;4x5&quot;, domain),
    domain,
)

coupled_sys = convert(System, csys)</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">Precompiling packages...
  14866.2 ms  ✓ UrbanCanopy → EarthSciDataExt
  1 dependency successfully precompiled in 15 seconds. 426 already precompiled.
[ Info: Creating directory /home/runner/.julia/scratchspaces/a293c155-435f-439d-9c11-a083b6b47337/earthsci_data/https_geos-chem.s3-us-west-2.amazonaws.com/GEOS_4x5/GEOS_FP/2016/04
Downloading GEOSFP.20160430.A1.4x5.nc:   0%|             |  ETA: 0:18:20Downloading GEOSFP.20160430.A1.4x5.nc:  13%|█▊           |  ETA: 0:00:20Downloading GEOSFP.20160430.A1.4x5.nc:  52%|██████▊      |  ETA: 0:00:03Downloading GEOSFP.20160430.A1.4x5.nc: 100%|█████████████| Time: 0:00:03
Downloading GEOSFP.20160430.A1.4x5.nc: 100%|█████████████| Time: 0:00:03
Downloading GEOSFP.20160430.A1.4x5.nc: 100%|█████████████| Time: 0:00:03
Downloading GEOSFP.20160430.A1.4x5.nc: 100%|█████████████| Time: 0:00:03
[ Info: Creating directory /home/runner/.julia/scratchspaces/a293c155-435f-439d-9c11-a083b6b47337/earthsci_data/https_geos-chem.s3-us-west-2.amazonaws.com/GEOS_4x5/GEOS_FP/2016/05
Downloading GEOSFP.20160501.A1.4x5.nc:   0%|             |  ETA: N/ADownloading GEOSFP.20160501.A1.4x5.nc:  85%|███████████▏ |  ETA: 0:00:00Downloading GEOSFP.20160501.A1.4x5.nc:  97%|████████████▋|  ETA: 0:00:00Downloading GEOSFP.20160501.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160501.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160501.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160501.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160502.A1.4x5.nc:   0%|             |  ETA: N/ADownloading GEOSFP.20160502.A1.4x5.nc:  93%|████████████▏|  ETA: 0:00:00Downloading GEOSFP.20160502.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160502.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160502.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160502.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160503.A1.4x5.nc:   0%|             |  ETA: N/ADownloading GEOSFP.20160503.A1.4x5.nc:  87%|███████████▍ |  ETA: 0:00:00Downloading GEOSFP.20160503.A1.4x5.nc:  90%|███████████▊ |  ETA: 0:00:00Downloading GEOSFP.20160503.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160503.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160503.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160503.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.A1.4x5.nc:   0%|             |  ETA: N/ADownloading GEOSFP.20160504.A1.4x5.nc:  44%|█████▊       |  ETA: 0:00:00Downloading GEOSFP.20160504.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.A1.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3cld.4x5.nc:   0%|          |  ETA: 0:06:23Downloading GEOSFP.20160430.A3cld.4x5.nc:   1%|          |  ETA: 0:01:46Downloading GEOSFP.20160430.A3cld.4x5.nc:   2%|▎         |  ETA: 0:00:29Downloading GEOSFP.20160430.A3cld.4x5.nc:   5%|▌         |  ETA: 0:00:15Downloading GEOSFP.20160430.A3cld.4x5.nc:  21%|██▏       |  ETA: 0:00:04Downloading GEOSFP.20160430.A3cld.4x5.nc:  42%|████▎     |  ETA: 0:00:02Downloading GEOSFP.20160430.A3cld.4x5.nc:  87%|████████▊ |  ETA: 0:00:00Downloading GEOSFP.20160430.A3cld.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160430.A3cld.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160430.A3cld.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160430.A3cld.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160501.A3cld.4x5.nc:   0%|          |  ETA: 0:00:53Downloading GEOSFP.20160501.A3cld.4x5.nc:  28%|██▉       |  ETA: 0:00:01Downloading GEOSFP.20160501.A3cld.4x5.nc:  67%|██████▋   |  ETA: 0:00:00Downloading GEOSFP.20160501.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3cld.4x5.nc:   1%|          |  ETA: 0:00:40Downloading GEOSFP.20160502.A3cld.4x5.nc:  26%|██▋       |  ETA: 0:00:01Downloading GEOSFP.20160502.A3cld.4x5.nc:  55%|█████▌    |  ETA: 0:00:00Downloading GEOSFP.20160502.A3cld.4x5.nc:  94%|█████████▌|  ETA: 0:00:00Downloading GEOSFP.20160502.A3cld.4x5.nc:  97%|█████████▊|  ETA: 0:00:00Downloading GEOSFP.20160502.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3cld.4x5.nc:   0%|          |  ETA: N/ADownloading GEOSFP.20160503.A3cld.4x5.nc:  34%|███▍      |  ETA: 0:00:01Downloading GEOSFP.20160503.A3cld.4x5.nc:  56%|█████▋    |  ETA: 0:00:00Downloading GEOSFP.20160503.A3cld.4x5.nc:  82%|████████▎ |  ETA: 0:00:00Downloading GEOSFP.20160503.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3cld.4x5.nc:   0%|          |  ETA: 0:04:04Downloading GEOSFP.20160504.A3cld.4x5.nc:  26%|██▋       |  ETA: 0:00:01Downloading GEOSFP.20160504.A3cld.4x5.nc:  70%|███████   |  ETA: 0:00:00Downloading GEOSFP.20160504.A3cld.4x5.nc:  99%|██████████|  ETA: 0:00:00Downloading GEOSFP.20160504.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3cld.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3dyn.4x5.nc:   0%|          |  ETA: N/ADownloading GEOSFP.20160430.A3dyn.4x5.nc:  20%|██        |  ETA: 0:00:01Downloading GEOSFP.20160430.A3dyn.4x5.nc:  30%|███       |  ETA: 0:00:01Downloading GEOSFP.20160430.A3dyn.4x5.nc:  45%|████▌     |  ETA: 0:00:01Downloading GEOSFP.20160430.A3dyn.4x5.nc:  60%|██████    |  ETA: 0:00:01Downloading GEOSFP.20160430.A3dyn.4x5.nc:  76%|███████▋  |  ETA: 0:00:00Downloading GEOSFP.20160430.A3dyn.4x5.nc:  85%|████████▌ |  ETA: 0:00:00Downloading GEOSFP.20160430.A3dyn.4x5.nc:  98%|█████████▊|  ETA: 0:00:00Downloading GEOSFP.20160430.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160430.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160430.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160430.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160501.A3dyn.4x5.nc:   0%|          |  ETA: 0:01:43Downloading GEOSFP.20160501.A3dyn.4x5.nc:  19%|█▉        |  ETA: 0:00:02Downloading GEOSFP.20160501.A3dyn.4x5.nc:  30%|███       |  ETA: 0:00:01Downloading GEOSFP.20160501.A3dyn.4x5.nc:  54%|█████▍    |  ETA: 0:00:01Downloading GEOSFP.20160501.A3dyn.4x5.nc:  55%|█████▌    |  ETA: 0:00:01Downloading GEOSFP.20160501.A3dyn.4x5.nc:  60%|██████    |  ETA: 0:00:01Downloading GEOSFP.20160501.A3dyn.4x5.nc:  74%|███████▌  |  ETA: 0:00:00Downloading GEOSFP.20160501.A3dyn.4x5.nc:  83%|████████▎ |  ETA: 0:00:00Downloading GEOSFP.20160501.A3dyn.4x5.nc:  90%|█████████ |  ETA: 0:00:00Downloading GEOSFP.20160501.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160501.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160501.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160501.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160502.A3dyn.4x5.nc:   0%|          |  ETA: N/ADownloading GEOSFP.20160502.A3dyn.4x5.nc:  18%|█▊        |  ETA: 0:00:01Downloading GEOSFP.20160502.A3dyn.4x5.nc:  30%|███       |  ETA: 0:00:01Downloading GEOSFP.20160502.A3dyn.4x5.nc:  48%|████▊     |  ETA: 0:00:01Downloading GEOSFP.20160502.A3dyn.4x5.nc:  60%|██████    |  ETA: 0:00:00Downloading GEOSFP.20160502.A3dyn.4x5.nc:  85%|████████▌ |  ETA: 0:00:00Downloading GEOSFP.20160502.A3dyn.4x5.nc:  95%|█████████▌|  ETA: 0:00:00Downloading GEOSFP.20160502.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3dyn.4x5.nc:   0%|          |  ETA: 0:01:34Downloading GEOSFP.20160503.A3dyn.4x5.nc:  14%|█▍        |  ETA: 0:00:02Downloading GEOSFP.20160503.A3dyn.4x5.nc:  23%|██▍       |  ETA: 0:00:02Downloading GEOSFP.20160503.A3dyn.4x5.nc:  30%|███       |  ETA: 0:00:02Downloading GEOSFP.20160503.A3dyn.4x5.nc:  44%|████▍     |  ETA: 0:00:01Downloading GEOSFP.20160503.A3dyn.4x5.nc:  60%|██████    |  ETA: 0:00:01Downloading GEOSFP.20160503.A3dyn.4x5.nc:  74%|███████▍  |  ETA: 0:00:00Downloading GEOSFP.20160503.A3dyn.4x5.nc:  95%|█████████▌|  ETA: 0:00:00Downloading GEOSFP.20160503.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160503.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160503.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160503.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160504.A3dyn.4x5.nc:   0%|          |  ETA: N/ADownloading GEOSFP.20160504.A3dyn.4x5.nc:  16%|█▋        |  ETA: 0:00:02Downloading GEOSFP.20160504.A3dyn.4x5.nc:  30%|███       |  ETA: 0:00:01Downloading GEOSFP.20160504.A3dyn.4x5.nc:  46%|████▋     |  ETA: 0:00:01Downloading GEOSFP.20160504.A3dyn.4x5.nc:  53%|█████▎    |  ETA: 0:00:01Downloading GEOSFP.20160504.A3dyn.4x5.nc:  60%|██████    |  ETA: 0:00:01Downloading GEOSFP.20160504.A3dyn.4x5.nc:  74%|███████▍  |  ETA: 0:00:00Downloading GEOSFP.20160504.A3dyn.4x5.nc:  90%|█████████ |  ETA: 0:00:00Downloading GEOSFP.20160504.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160504.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160504.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160504.A3dyn.4x5.nc: 100%|██████████| Time: 0:00:01
Downloading GEOSFP.20160430.A3mstC.4x5.nc:   1%|         |  ETA: 0:00:40Downloading GEOSFP.20160430.A3mstC.4x5.nc:  81%|███████▍ |  ETA: 0:00:00Downloading GEOSFP.20160430.A3mstC.4x5.nc:  82%|███████▍ |  ETA: 0:00:00Downloading GEOSFP.20160430.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstC.4x5.nc:   0%|         |  ETA: 0:02:08Downloading GEOSFP.20160501.A3mstC.4x5.nc:  77%|██████▉  |  ETA: 0:00:00Downloading GEOSFP.20160501.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstC.4x5.nc:   0%|         |  ETA: N/ADownloading GEOSFP.20160502.A3mstC.4x5.nc:  61%|█████▌   |  ETA: 0:00:00Downloading GEOSFP.20160502.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstC.4x5.nc:   1%|▏        |  ETA: 0:00:33Downloading GEOSFP.20160503.A3mstC.4x5.nc:  71%|██████▍  |  ETA: 0:00:00Downloading GEOSFP.20160503.A3mstC.4x5.nc:  88%|████████ |  ETA: 0:00:00Downloading GEOSFP.20160503.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstC.4x5.nc:   0%|         |  ETA: 0:01:46Downloading GEOSFP.20160504.A3mstC.4x5.nc:  50%|████▌    |  ETA: 0:00:00Downloading GEOSFP.20160504.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstC.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3mstE.4x5.nc:   1%|         |  ETA: 0:00:44Downloading GEOSFP.20160430.A3mstE.4x5.nc:  52%|████▋    |  ETA: 0:00:00Downloading GEOSFP.20160430.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstE.4x5.nc:   1%|         |  ETA: 0:00:40Downloading GEOSFP.20160501.A3mstE.4x5.nc:  52%|████▋    |  ETA: 0:00:00Downloading GEOSFP.20160501.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160501.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstE.4x5.nc:   0%|         |  ETA: 0:01:42Downloading GEOSFP.20160502.A3mstE.4x5.nc:  65%|█████▊   |  ETA: 0:00:00Downloading GEOSFP.20160502.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160502.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstE.4x5.nc:   0%|         |  ETA: N/ADownloading GEOSFP.20160503.A3mstE.4x5.nc:  52%|████▋    |  ETA: 0:00:00Downloading GEOSFP.20160503.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160503.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstE.4x5.nc:   1%|▏        |  ETA: 0:00:31Downloading GEOSFP.20160504.A3mstE.4x5.nc:  52%|████▋    |  ETA: 0:00:00Downloading GEOSFP.20160504.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160504.A3mstE.4x5.nc: 100%|█████████| Time: 0:00:00
Downloading GEOSFP.20160430.I3.4x5.nc:   0%|             |  ETA: 0:01:10Downloading GEOSFP.20160430.I3.4x5.nc:  30%|███▉         |  ETA: 0:00:01Downloading GEOSFP.20160430.I3.4x5.nc:  44%|█████▊       |  ETA: 0:00:01Downloading GEOSFP.20160430.I3.4x5.nc:  66%|████████▋    |  ETA: 0:00:00Downloading GEOSFP.20160430.I3.4x5.nc:  88%|███████████▌ |  ETA: 0:00:00Downloading GEOSFP.20160430.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160430.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160430.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160430.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160501.I3.4x5.nc:   0%|             |  ETA: N/ADownloading GEOSFP.20160501.I3.4x5.nc:  26%|███▍         |  ETA: 0:00:01Downloading GEOSFP.20160501.I3.4x5.nc:  45%|█████▊       |  ETA: 0:00:01Downloading GEOSFP.20160501.I3.4x5.nc:  62%|████████▏    |  ETA: 0:00:00Downloading GEOSFP.20160501.I3.4x5.nc:  81%|██████████▌  |  ETA: 0:00:00Downloading GEOSFP.20160501.I3.4x5.nc:  88%|███████████▌ |  ETA: 0:00:00Downloading GEOSFP.20160501.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160501.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160501.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160501.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160502.I3.4x5.nc:   0%|             |  ETA: N/ADownloading GEOSFP.20160502.I3.4x5.nc:  25%|███▎         |  ETA: 0:00:01Downloading GEOSFP.20160502.I3.4x5.nc:  37%|████▊        |  ETA: 0:00:01Downloading GEOSFP.20160502.I3.4x5.nc:  44%|█████▊       |  ETA: 0:00:01Downloading GEOSFP.20160502.I3.4x5.nc:  60%|███████▉     |  ETA: 0:00:01Downloading GEOSFP.20160502.I3.4x5.nc:  82%|██████████▋  |  ETA: 0:00:00Downloading GEOSFP.20160502.I3.4x5.nc:  97%|████████████▌|  ETA: 0:00:00Downloading GEOSFP.20160502.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160502.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160502.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160502.I3.4x5.nc: 100%|█████████████| Time: 0:00:01
Downloading GEOSFP.20160503.I3.4x5.nc:   0%|             |  ETA: 0:04:28Downloading GEOSFP.20160503.I3.4x5.nc:  25%|███▎         |  ETA: 0:00:01Downloading GEOSFP.20160503.I3.4x5.nc:  44%|█████▊       |  ETA: 0:00:01Downloading GEOSFP.20160503.I3.4x5.nc:  65%|████████▌    |  ETA: 0:00:00Downloading GEOSFP.20160503.I3.4x5.nc:  87%|███████████▍ |  ETA: 0:00:00Downloading GEOSFP.20160503.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160503.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160503.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160503.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.I3.4x5.nc:   0%|             |  ETA: N/ADownloading GEOSFP.20160504.I3.4x5.nc:  30%|███▉         |  ETA: 0:00:01Downloading GEOSFP.20160504.I3.4x5.nc:  37%|████▊        |  ETA: 0:00:01Downloading GEOSFP.20160504.I3.4x5.nc:  44%|█████▊       |  ETA: 0:00:01Downloading GEOSFP.20160504.I3.4x5.nc:  67%|████████▋    |  ETA: 0:00:00Downloading GEOSFP.20160504.I3.4x5.nc:  88%|███████████▌ |  ETA: 0:00:00Downloading GEOSFP.20160504.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.I3.4x5.nc: 100%|█████████████| Time: 0:00:00
Downloading GEOSFP.20160504.I3.4x5.nc: 100%|█████████████| Time: 0:00:00</code></pre><h4 id="Coupling-Equations"><a class="docs-heading-anchor" href="#Coupling-Equations">Coupling Equations</a><a id="Coupling-Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Coupling-Equations" title="Permalink"></a></h4><p>The coupling creates observed equations that map GEOS-FP meteorological variables to the <code>UrbanCanopyModel</code> forcing parameters. Below we extract the top-level coupling equations showing how each GEOS-FP field drives the urban canopy model.</p><pre><code class="language-julia hljs">obs = observed(coupled_sys)

# Extract the top-level coupling equations (UrbanCanopyModel parameters driven by GEOS-FP)
coupling_terms = [&quot;S_atm&quot;, &quot;T_atm&quot;, &quot;P_atm&quot;, &quot;q_atm&quot;, &quot;W_atm&quot;, &quot;P_precip&quot;, &quot;ζ_in&quot;, &quot;μ_zen&quot;]
coupling_eqs = filter(obs) do eq
    lhs_str = string(eq.lhs)
    occursin(&quot;UrbanCanopyModel&quot;, lhs_str) &amp;&amp;
        count(&quot;₊&quot;, lhs_str) == 1 &amp;&amp;
        any(term -&gt; occursin(term, lhs_str), coupling_terms)
end

for eq in coupling_eqs
    println(eq)
end</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">UrbanCanopyModel₊μ_zen(t) ~ one_rad_cpl*acos(max(sin((-obliquity*cos((6.283185307179586(10 + mod((GEOSFP₊t_ref + t) / sec_per_day, days_per_year))) / days_per_year)) / one_rad_cpl)*sin(GEOSFP₊lat / one_rad_cpl) + cos(GEOSFP₊lat / one_rad_cpl)*cos((-obliquity*cos((6.283185307179586(10 + mod((GEOSFP₊t_ref + t) / sec_per_day, days_per_year))) / days_per_year)) / one_rad_cpl)*cos(-3.141592653589793 + GEOSFP₊lon / one_rad_cpl + 6.283185307179586mod((GEOSFP₊t_ref + t) / sec_per_day, 1.0)), 0.01))
UrbanCanopyModel₊P_precip(t) ~ one_s_precip*GEOSFP₊A1₊PRECTOT(t)
UrbanCanopyModel₊q_atm(t) ~ GEOSFP₊A1₊QV2M(t)
UrbanCanopyModel₊T_atm(t) ~ GEOSFP₊A1₊T2M(t)
UrbanCanopyModel₊P_atm(t) ~ GEOSFP₊I3₊PS(t)
UrbanCanopyModel₊ζ_in(t) ~ (-R_d_cpl*(z_ref_cpl - UrbanCanopyModel₊H_canyon*(1 + (-1 + UrbanCanopyModel₊W_roof)*(α_cpl^(-UrbanCanopyModel₊W_roof))))*g_cpl*ifelse(abs(GEOSFP₊A1₊HFLUX(t)) &gt; ε_flux, GEOSFP₊A1₊HFLUX(t), ε_flux)*κ_cpl) / (C_p_cpl*(GEOSFP₊A1₊USTAR(t)^3)*GEOSFP₊I3₊PS(t))
UrbanCanopyModel₊S_atm(t) ~ GEOSFP₊A1₊SWGDN(t)
UrbanCanopyModel₊W_atm(t) ~ sqrt(GEOSFP₊A1₊U10M(t)^2 + GEOSFP₊A1₊V10M(t)^2)</code></pre><h4 id="Coupled-System-Variables"><a class="docs-heading-anchor" href="#Coupled-System-Variables">Coupled System Variables</a><a id="Coupled-System-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#Coupled-System-Variables" title="Permalink"></a></h4><pre><code class="language-julia hljs">coupled_vars = unknowns(coupled_sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape=false)) for v in coupled_vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in coupled_vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in coupled_vars]
)</code></pre><div><div style = "float: left;"><span>0×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "Any" style = "text-align: left;">Any</th><th title = "Any" style = "text-align: left;">Any</th><th title = "Any" style = "text-align: left;">Any</th></tr></thead></table></div></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../hydrology/">« Hydrology</a><a class="docs-footer-nextpage" href="../api/">API »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.17.0 on <span class="colophon-date" title="Tuesday 24 February 2026 23:59">Tuesday 24 February 2026</span>. Using Julia version 1.12.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
