<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>CLMU Introduction · UrbanCanopy.jl</title><meta name="title" content="CLMU Introduction · UrbanCanopy.jl"/><meta property="og:title" content="CLMU Introduction · UrbanCanopy.jl"/><meta property="twitter:title" content="CLMU Introduction · UrbanCanopy.jl"/><meta name="description" content="Documentation for UrbanCanopy.jl."/><meta property="og:description" content="Documentation for UrbanCanopy.jl."/><meta property="twitter:description" content="Documentation for UrbanCanopy.jl."/><meta property="og:url" content="https://urbancanopy.earthsci.dev/clmu_introduction/"/><meta property="twitter:url" content="https://urbancanopy.earthsci.dev/clmu_introduction/"/><link rel="canonical" href="https://urbancanopy.earthsci.dev/clmu_introduction/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">UrbanCanopy.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>CLMU Introduction</a><ul class="internal"><li><a class="tocitem" href="#Overview"><span>Overview</span></a></li><li><a class="tocitem" href="#Implementation"><span>Implementation</span></a></li><li><a class="tocitem" href="#Analysis"><span>Analysis</span></a></li></ul></li><li><a class="tocitem" href="../albedos_radiative_fluxes/">Albedos and Radiative Fluxes</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>CLMU Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>CLMU Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/main/docs/src/clmu_introduction.md#" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CLMU-Introduction:-Atmospheric-Interface"><a class="docs-heading-anchor" href="#CLMU-Introduction:-Atmospheric-Interface">CLMU Introduction: Atmospheric Interface</a><a id="CLMU-Introduction:-Atmospheric-Interface-1"></a><a class="docs-heading-anchor-permalink" href="#CLMU-Introduction:-Atmospheric-Interface" title="Permalink"></a></h1><h2 id="Overview"><a class="docs-heading-anchor" href="#Overview">Overview</a><a id="Overview-1"></a><a class="docs-heading-anchor-permalink" href="#Overview" title="Permalink"></a></h2><p>The Community Land Model Urban (CLMU) parameterization provides a physically-based representation of urban surfaces for use within the Community Land Model (CLM4). Chapter 1 of the technical note introduces the model structure and defines the atmospheric interface: the forcing variables provided by the atmospheric model, the diagnostic equations for air density and vapor pressure, and the reference height computation.</p><p>The urban surface is represented using the canyon concept (Oke, 1987), where the considerable complexity of the urban surface is reduced to a single urban canyon consisting of a canyon floor of width W bordered by two facing buildings of height H. The urban canyon is divided into five columns: roof, sunlit wall, shaded wall, pervious road, and impervious road.</p><p><strong>Reference</strong>: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp.</p><article><details class="docstring" open="true"><summary id="UrbanCanopy.CLMUAtmosphere"><a class="docstring-binding" href="#UrbanCanopy.CLMUAtmosphere"><code>UrbanCanopy.CLMUAtmosphere</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">CLMUAtmosphere(; name=:CLMUAtmosphere)</code></pre><p>Atmospheric interface for the Community Land Model Urban (CLMU) parameterization. Computes atmospheric density, vapor pressure, and reference height from atmospheric forcing variables, following Chapter 1 of Oleson et al. (2010).</p><p>The CLMU represents the urban surface using a canyon concept (Oke, 1987) consisting of a canyon floor of width W bordered by two facing buildings of height H. The urban canyon is divided into five columns: roof, sunlit wall, shaded wall, pervious road, and impervious road. This component defines the atmospheric forcing interface and the diagnostic equations that connect atmospheric model variables to the urban canopy model.</p><p><strong>Reference</strong>: Oleson, K.W., G.B. Bonan, J.J. Feddema, M. Vertenstein, and E. Kluzek, 2010: Technical Description of an Urban Parameterization for the Community Land Model (CLMU). NCAR Technical Note NCAR/TN-480+STR, National Center for Atmospheric Research, Boulder, CO, 168 pp.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/EarthSciML/UrbanCanopy.jl/blob/d3c09cb3118e074d1bc63313649647d96c1d74ce/src/clmu_introduction.jl#L3-L21">source</a></section></details></article><h2 id="Implementation"><a class="docs-heading-anchor" href="#Implementation">Implementation</a><a id="Implementation-1"></a><a class="docs-heading-anchor-permalink" href="#Implementation" title="Permalink"></a></h2><p>The <code>CLMUAtmosphere</code> component implements three diagnostic equations from Chapter 1:</p><ol><li><strong>Atmospheric vapor pressure</strong> from specific humidity and pressure</li><li><strong>Air density</strong> from pressure, vapor pressure, and temperature</li><li><strong>Reference height</strong> for flux computations</li></ol><h3 id="State-Variables"><a class="docs-heading-anchor" href="#State-Variables">State Variables</a><a id="State-Variables-1"></a><a class="docs-heading-anchor-permalink" href="#State-Variables" title="Permalink"></a></h3><pre><code class="language-julia hljs">using DataFrames, ModelingToolkit, Symbolics, DynamicQuantities
using UrbanCanopy

sys = CLMUAtmosphere()

vars = unknowns(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(v, escape = false)) for v in vars],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(v)) for v in vars],
    :Description =&gt; [ModelingToolkit.getdescription(v) for v in vars]
)</code></pre><div><div style = "float: left;"><span>3×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">e_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric vapor pressure</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">ρ_atm</td><td style = "text-align: left;">m⁻³ kg</td><td style = "text-align: left;">Atmospheric air density</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">z_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Reference height for flux computations</td></tr></tbody></table></div><h3 id="Parameters"><a class="docs-heading-anchor" href="#Parameters">Parameters</a><a id="Parameters-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters" title="Permalink"></a></h3><pre><code class="language-julia hljs">params = parameters(sys)
DataFrame(
    :Name =&gt; [string(Symbolics.tosymbol(p, escape = false)) for p in params],
    :Units =&gt; [dimension(ModelingToolkit.get_unit(p)) for p in params],
    :Description =&gt; [ModelingToolkit.getdescription(p) for p in params]
)</code></pre><div><div style = "float: left;"><span>13×3 DataFrame</span></div><div style = "clear: both;"></div></div><div class = "data-frame" style = "overflow-x: scroll;"><table class = "data-frame" style = "margin-bottom: 6px;"><thead><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;">Row</th><th style = "text-align: left;">Name</th><th style = "text-align: left;">Units</th><th style = "text-align: left;">Description</th></tr><tr class = "columnLabelRow"><th class = "stubheadLabel" style = "font-weight: bold; text-align: right;"></th><th title = "String" style = "text-align: left;">String</th><th title = "DynamicQuantities.Dimensions{DynamicQuantities.FRInt32}" style = "text-align: left;">Dimensio…</th><th title = "String" style = "text-align: left;">String</th></tr></thead><tbody><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">1</td><td style = "text-align: left;">R_da</td><td style = "text-align: left;">m² s⁻² K⁻¹</td><td style = "text-align: left;">Dry air gas constant R_da = R_gas / MW_da (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">2</td><td style = "text-align: left;">P_atm</td><td style = "text-align: left;">m⁻¹ kg s⁻²</td><td style = "text-align: left;">Atmospheric pressure at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">3</td><td style = "text-align: left;">MW_wv</td><td style = "text-align: left;">kg mol⁻¹</td><td style = "text-align: left;">Molecular weight of water vapor (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">4</td><td style = "text-align: left;">z_0</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Roughness length</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">5</td><td style = "text-align: left;">ε_ratio</td><td style = "text-align: left;"></td><td style = "text-align: left;">Ratio of molecular weights MW_wv/MW_da, ε = 0.622 (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">6</td><td style = "text-align: left;">N_A</td><td style = "text-align: left;">mol⁻¹</td><td style = "text-align: left;">Avogadro&apos;s number (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">7</td><td style = "text-align: left;">one_minus_ε</td><td style = "text-align: left;"></td><td style = "text-align: left;">1 - MW_wv/MW_da = 0.378 (dimensionless)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">8</td><td style = "text-align: left;">z_d</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Displacement height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">9</td><td style = "text-align: left;">q_atm</td><td style = "text-align: left;"></td><td style = "text-align: left;">Specific humidity at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">10</td><td style = "text-align: left;">κ_boltz</td><td style = "text-align: left;">m² kg s⁻² K⁻¹</td><td style = "text-align: left;">Boltzmann constant (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">11</td><td style = "text-align: left;">MW_da</td><td style = "text-align: left;">kg mol⁻¹</td><td style = "text-align: left;">Molecular weight of dry air (Table 1.4)</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">12</td><td style = "text-align: left;">T_atm</td><td style = "text-align: left;">K</td><td style = "text-align: left;">Atmospheric temperature at reference height</td></tr><tr class = "dataRow"><td class = "rowLabel" style = "font-weight: bold; text-align: right;">13</td><td style = "text-align: left;">z_prime_atm</td><td style = "text-align: left;">m</td><td style = "text-align: left;">Atmospheric reference height from atmospheric model</td></tr></tbody></table></div><h3 id="Equations"><a class="docs-heading-anchor" href="#Equations">Equations</a><a id="Equations-1"></a><a class="docs-heading-anchor-permalink" href="#Equations" title="Permalink"></a></h3><pre><code class="language-julia hljs">eqs = equations(sys)</code></pre><p class="math-container">\[ \begin{align}
\mathtt{e\_atm}\left( t \right) &amp;= \frac{\mathtt{P\_atm} \mathtt{q\_atm}}{\mathtt{\varepsilon\_ratio} + \mathtt{one\_minus\_\varepsilon} \mathtt{q\_atm}} \\
\mathtt{\rho\_atm}\left( t \right) &amp;= \frac{\mathtt{P\_atm} - \mathtt{one\_minus\_\varepsilon} \mathtt{e\_atm}\left( t \right)}{\mathtt{R\_da} \mathtt{T\_atm}} \\
\mathtt{z\_atm}\left( t \right) &amp;= \mathtt{z\_0} + \mathtt{z\_d} + \mathtt{z\_prime\_atm}
\end{align}
 \]</p><h3 id="Table-1.1:-Atmospheric-Input-to-Urban-Model"><a class="docs-heading-anchor" href="#Table-1.1:-Atmospheric-Input-to-Urban-Model">Table 1.1: Atmospheric Input to Urban Model</a><a id="Table-1.1:-Atmospheric-Input-to-Urban-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Table-1.1:-Atmospheric-Input-to-Urban-Model" title="Permalink"></a></h3><p>The atmospheric model provides the following forcing variables to the urban model at each time step (Table 1.1, p. 16). The reference height <span>$z&#39;_{atm}$</span> is the height above the surface defined as the roughness length <span>$z_0$</span> plus displacement height <span>$z_d$</span>, so the reference height used for flux computations is <span>$z_{atm} = z&#39;_{atm} + z_0 + z_d$</span>.</p><table><tr><th style="text-align: right">Variable</th><th style="text-align: right">Symbol</th><th style="text-align: right">Units</th></tr><tr><td style="text-align: right">Reference height</td><td style="text-align: right"><span>$z&#39;_{atm}$</span></td><td style="text-align: right">m</td></tr><tr><td style="text-align: right">Zonal wind at <span>$z_{atm}$</span></td><td style="text-align: right"><span>$u_{atm}$</span></td><td style="text-align: right">m/s</td></tr><tr><td style="text-align: right">Meridional wind at <span>$z_{atm}$</span></td><td style="text-align: right"><span>$v_{atm}$</span></td><td style="text-align: right">m/s</td></tr><tr><td style="text-align: right">Potential temperature</td><td style="text-align: right"><span>$\theta_{atm}$</span></td><td style="text-align: right">K</td></tr><tr><td style="text-align: right">Specific humidity at <span>$z_{atm}$</span></td><td style="text-align: right"><span>$q_{atm}$</span></td><td style="text-align: right">kg/kg</td></tr><tr><td style="text-align: right">Pressure at <span>$z_{atm}$</span></td><td style="text-align: right"><span>$P_{atm}$</span></td><td style="text-align: right">Pa</td></tr><tr><td style="text-align: right">Temperature at <span>$z_{atm}$</span></td><td style="text-align: right"><span>$T_{atm}$</span></td><td style="text-align: right">K</td></tr><tr><td style="text-align: right">Incident longwave radiation</td><td style="text-align: right"><span>$L_{atm}\downarrow$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Liquid precipitation</td><td style="text-align: right"><span>$q_{rain}$</span></td><td style="text-align: right">kg/(m²·s)</td></tr><tr><td style="text-align: right">Solid precipitation</td><td style="text-align: right"><span>$q_{sno}$</span></td><td style="text-align: right">kg/(m²·s)</td></tr><tr><td style="text-align: right">Direct beam visible solar radiation</td><td style="text-align: right"><span>$S_{atm}\downarrow^{\mu}_{vis}$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Direct beam near-infrared solar radiation</td><td style="text-align: right"><span>$S_{atm}\downarrow^{\mu}_{nir}$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Diffuse visible solar radiation</td><td style="text-align: right"><span>$S_{atm}\downarrow_{vis}$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Diffuse near-infrared solar radiation</td><td style="text-align: right"><span>$S_{atm}\downarrow_{nir}$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Carbon dioxide (CO₂) concentration</td><td style="text-align: right"><span>$c_a$</span></td><td style="text-align: right">ppmv</td></tr><tr><td style="text-align: right">Aerosol deposition rate</td><td style="text-align: right"><span>$D_{sp}$</span></td><td style="text-align: right">kg/(m²·s)</td></tr><tr><td style="text-align: right">Nitrogen deposition rate</td><td style="text-align: right"><span>$NF_{ndep\_sminn}$</span></td><td style="text-align: right">g(N)/(m²·yr)</td></tr></table><p>Note: CO₂ concentration, aerosol deposition rate, and nitrogen deposition rate are provided by the atmospheric model but not used by the urban model.</p><h3 id="Table-1.2:-Urban-Model-Output-to-Atmospheric-Model"><a class="docs-heading-anchor" href="#Table-1.2:-Urban-Model-Output-to-Atmospheric-Model">Table 1.2: Urban Model Output to Atmospheric Model</a><a id="Table-1.2:-Urban-Model-Output-to-Atmospheric-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Table-1.2:-Urban-Model-Output-to-Atmospheric-Model" title="Permalink"></a></h3><p>The urban model provides the following area-averaged fluxes to the atmospheric model (Table 1.2, p. 18).</p><table><tr><th style="text-align: right">Variable</th><th style="text-align: right">Symbol</th><th style="text-align: right">Units</th></tr><tr><td style="text-align: right">Latent heat flux</td><td style="text-align: right"><span>$\lambda E$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Sensible heat flux</td><td style="text-align: right"><span>$H$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Water vapor flux</td><td style="text-align: right"><span>$E$</span></td><td style="text-align: right">mm/s</td></tr><tr><td style="text-align: right">Zonal momentum flux</td><td style="text-align: right"><span>$\tau_x$</span></td><td style="text-align: right">kg/(m·s²)</td></tr><tr><td style="text-align: right">Meridional momentum flux</td><td style="text-align: right"><span>$\tau_y$</span></td><td style="text-align: right">kg/(m·s²)</td></tr><tr><td style="text-align: right">Emitted longwave radiation</td><td style="text-align: right"><span>$L\uparrow$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Direct beam visible albedo</td><td style="text-align: right"><span>$I\uparrow^{\mu}_{vis}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Direct beam near-infrared albedo</td><td style="text-align: right"><span>$I\uparrow^{\mu}_{nir}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Diffuse visible albedo</td><td style="text-align: right"><span>$I\uparrow_{vis}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Diffuse near-infrared albedo</td><td style="text-align: right"><span>$I\uparrow_{nir}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Absorbed solar radiation</td><td style="text-align: right"><span>$\vec{S}$</span></td><td style="text-align: right">W/m²</td></tr><tr><td style="text-align: right">Radiative temperature</td><td style="text-align: right"><span>$T_{rad}$</span></td><td style="text-align: right">K</td></tr><tr><td style="text-align: right">Temperature at 2 meter height</td><td style="text-align: right"><span>$T_{2m}$</span></td><td style="text-align: right">K</td></tr><tr><td style="text-align: right">Specific humidity at 2 meter height</td><td style="text-align: right"><span>$q_{2m}$</span></td><td style="text-align: right">kg/kg</td></tr><tr><td style="text-align: right">Snow water equivalent</td><td style="text-align: right"><span>$W_{sno}$</span></td><td style="text-align: right">m</td></tr><tr><td style="text-align: right">Aerodynamic resistance</td><td style="text-align: right"><span>$r_{am}$</span></td><td style="text-align: right">s/m</td></tr><tr><td style="text-align: right">Friction velocity</td><td style="text-align: right"><span>$u_*$</span></td><td style="text-align: right">m/s</td></tr><tr><td style="text-align: right">Dust flux</td><td style="text-align: right"><span>$F_j$</span></td><td style="text-align: right">kg/(m²·s)</td></tr><tr><td style="text-align: right">Net ecosystem exchange</td><td style="text-align: right"><span>$NEE$</span></td><td style="text-align: right">kgCO₂/(m²·s)</td></tr></table><p>Note: <span>$\lambda$</span> is either the latent heat of vaporization <span>$\lambda_{vap}$</span> or latent heat of sublimation <span>$\lambda_{sub}$</span> (Table 1.4) depending on the thermal state of surface water on the roof, pervious and impervious road. Dust flux and net ecosystem exchange are set to zero for urban areas.</p><h3 id="Table-1.3:-Input-Data-Required-for-the-Urban-Model"><a class="docs-heading-anchor" href="#Table-1.3:-Input-Data-Required-for-the-Urban-Model">Table 1.3: Input Data Required for the Urban Model</a><a id="Table-1.3:-Input-Data-Required-for-the-Urban-Model-1"></a><a class="docs-heading-anchor-permalink" href="#Table-1.3:-Input-Data-Required-for-the-Urban-Model" title="Permalink"></a></h3><p>Required input data for urban landunits are listed in Table 1.3 (p. 23). This data is provided by the surface dataset at the required spatial resolution.</p><table><tr><th style="text-align: right">Data</th><th style="text-align: right">Symbol</th><th style="text-align: right">Units</th></tr><tr><td style="text-align: right">Percent urban</td><td style="text-align: right">-</td><td style="text-align: right">%</td></tr><tr><td style="text-align: right">Canyon height to width ratio</td><td style="text-align: right"><span>$H/W$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Roof fraction</td><td style="text-align: right"><span>$W_{roof}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Pervious road fraction</td><td style="text-align: right"><span>$f_{prvrd}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Emissivity of roof</td><td style="text-align: right"><span>$\varepsilon_{roof}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Emissivity of impervious road</td><td style="text-align: right"><span>$\varepsilon_{imprvrd}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Emissivity of pervious road</td><td style="text-align: right"><span>$\varepsilon_{prvrd}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Emissivity of walls</td><td style="text-align: right"><span>$\varepsilon_{wall}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Building height</td><td style="text-align: right"><span>$H$</span></td><td style="text-align: right">m</td></tr><tr><td style="text-align: right">Roof albedo (visible direct/diffuse, near-infrared direct/diffuse)</td><td style="text-align: right"><span>$\alpha_{roof}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Wall albedo (visible direct/diffuse, near-infrared direct/diffuse)</td><td style="text-align: right"><span>$\alpha_{walls}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Impervious road albedo (visible direct/diffuse, near-infrared direct/diffuse)</td><td style="text-align: right"><span>$\alpha_{imprvrd}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Pervious road albedo (visible direct/diffuse, near-infrared direct/diffuse)</td><td style="text-align: right"><span>$\alpha_{prvrd}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Roof thermal conductivity</td><td style="text-align: right"><span>$\lambda_{roof,i}$</span></td><td style="text-align: right">W/(m·K)</td></tr><tr><td style="text-align: right">Wall thermal conductivity</td><td style="text-align: right"><span>$\lambda_{wall,i}$</span></td><td style="text-align: right">W/(m·K)</td></tr><tr><td style="text-align: right">Impervious road thermal conductivity</td><td style="text-align: right"><span>$\lambda_{imprvrd,i}$</span></td><td style="text-align: right">W/(m·K)</td></tr><tr><td style="text-align: right">Pervious road thermal conductivity</td><td style="text-align: right"><span>$\lambda_{prvrd,i}$</span></td><td style="text-align: right">W/(m·K)</td></tr><tr><td style="text-align: right">Roof volumetric heat capacity</td><td style="text-align: right"><span>$c_{roof,i}$</span></td><td style="text-align: right">J/(m³·K)</td></tr><tr><td style="text-align: right">Wall volumetric heat capacity</td><td style="text-align: right"><span>$c_{wall,i}$</span></td><td style="text-align: right">J/(m³·K)</td></tr><tr><td style="text-align: right">Impervious road volumetric heat capacity</td><td style="text-align: right"><span>$c_{imprvrd,i}$</span></td><td style="text-align: right">J/(m³·K)</td></tr><tr><td style="text-align: right">Pervious road volumetric heat capacity</td><td style="text-align: right"><span>$c_{prvrd,i}$</span></td><td style="text-align: right">J/(m³·K)</td></tr><tr><td style="text-align: right">Maximum interior building temperature</td><td style="text-align: right"><span>$T_{iB,max}$</span></td><td style="text-align: right">K</td></tr><tr><td style="text-align: right">Minimum interior building temperature</td><td style="text-align: right"><span>$T_{iB,min}$</span></td><td style="text-align: right">K</td></tr><tr><td style="text-align: right">Height of wind source in canyon</td><td style="text-align: right"><span>$H_w$</span></td><td style="text-align: right">m</td></tr><tr><td style="text-align: right">Number of impervious road layers</td><td style="text-align: right"><span>$N_{imprvrd}$</span></td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Wall thickness</td><td style="text-align: right"><span>$\Delta z_{wall}$</span></td><td style="text-align: right">m</td></tr><tr><td style="text-align: right">Roof thickness</td><td style="text-align: right"><span>$\Delta z_{roof}$</span></td><td style="text-align: right">m</td></tr><tr><td style="text-align: right">Percent sand, percent clay of pervious road (soil)</td><td style="text-align: right">%sand, %clay</td><td style="text-align: right">%</td></tr><tr><td style="text-align: right">Grid cell latitude and longitude</td><td style="text-align: right"><span>$\phi, \theta$</span></td><td style="text-align: right">degrees</td></tr></table><h3 id="Table-1.4:-Physical-Constants"><a class="docs-heading-anchor" href="#Table-1.4:-Physical-Constants">Table 1.4: Physical Constants</a><a id="Table-1.4:-Physical-Constants-1"></a><a class="docs-heading-anchor-permalink" href="#Table-1.4:-Physical-Constants" title="Permalink"></a></h3><p>Physical constants used by the CLMU, shared by all components of CCSM (Table 1.4, p. 25).</p><table><tr><th style="text-align: right">Constant</th><th style="text-align: right">Symbol</th><th style="text-align: right">Value</th><th style="text-align: right">Units</th></tr><tr><td style="text-align: right">Pi</td><td style="text-align: right"><span>$\pi$</span></td><td style="text-align: right">3.14159265358979323846</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Acceleration of gravity</td><td style="text-align: right"><span>$g$</span></td><td style="text-align: right">9.80616</td><td style="text-align: right">m/s²</td></tr><tr><td style="text-align: right">Standard pressure</td><td style="text-align: right"><span>$P_{std}$</span></td><td style="text-align: right">101325</td><td style="text-align: right">Pa</td></tr><tr><td style="text-align: right">Stefan-Boltzmann constant</td><td style="text-align: right"><span>$\sigma$</span></td><td style="text-align: right">5.67 × 10⁻⁸</td><td style="text-align: right">W/(m²·K⁴)</td></tr><tr><td style="text-align: right">Boltzmann constant</td><td style="text-align: right"><span>$\kappa$</span></td><td style="text-align: right">1.38065 × 10⁻²³</td><td style="text-align: right">J/K</td></tr><tr><td style="text-align: right">Avogadro&#39;s number</td><td style="text-align: right"><span>$N_A$</span></td><td style="text-align: right">6.02214 × 10²⁶</td><td style="text-align: right">molecule/kmol</td></tr><tr><td style="text-align: right">Universal gas constant</td><td style="text-align: right"><span>$R_{gas}$</span></td><td style="text-align: right"><span>$N_A \kappa$</span></td><td style="text-align: right">J/(K·kmol)</td></tr><tr><td style="text-align: right">Molecular weight of dry air</td><td style="text-align: right"><span>$MW_{da}$</span></td><td style="text-align: right">28.966</td><td style="text-align: right">kg/kmol</td></tr><tr><td style="text-align: right">Dry air gas constant</td><td style="text-align: right"><span>$R_{da}$</span></td><td style="text-align: right"><span>$R_{gas}/MW_{da}$</span></td><td style="text-align: right">J/(K·kg)</td></tr><tr><td style="text-align: right">Molecular weight of water vapor</td><td style="text-align: right"><span>$MW_{wv}$</span></td><td style="text-align: right">18.016</td><td style="text-align: right">kg/kmol</td></tr><tr><td style="text-align: right">Water vapor gas constant</td><td style="text-align: right"><span>$R_{wv}$</span></td><td style="text-align: right"><span>$R_{gas}/MW_{wv}$</span></td><td style="text-align: right">J/(K·kg)</td></tr><tr><td style="text-align: right">Von Karman constant</td><td style="text-align: right"><span>$k$</span></td><td style="text-align: right">0.4</td><td style="text-align: right">-</td></tr><tr><td style="text-align: right">Freezing temperature of fresh water</td><td style="text-align: right"><span>$T_f$</span></td><td style="text-align: right">273.15</td><td style="text-align: right">K</td></tr><tr><td style="text-align: right">Density of liquid water</td><td style="text-align: right"><span>$\rho_{liq}$</span></td><td style="text-align: right">1000</td><td style="text-align: right">kg/m³</td></tr><tr><td style="text-align: right">Density of ice</td><td style="text-align: right"><span>$\rho_{ice}$</span></td><td style="text-align: right">917</td><td style="text-align: right">kg/m³</td></tr><tr><td style="text-align: right">Specific heat capacity of dry air</td><td style="text-align: right"><span>$C_p$</span></td><td style="text-align: right">1.00464 × 10³</td><td style="text-align: right">J/(kg·K)</td></tr><tr><td style="text-align: right">Specific heat capacity of water</td><td style="text-align: right"><span>$C_{liq}$</span></td><td style="text-align: right">4.188 × 10³</td><td style="text-align: right">J/(kg·K)</td></tr><tr><td style="text-align: right">Specific heat capacity of ice</td><td style="text-align: right"><span>$C_{ice}$</span></td><td style="text-align: right">2.11727 × 10³</td><td style="text-align: right">J/(kg·K)</td></tr><tr><td style="text-align: right">Latent heat of vaporization</td><td style="text-align: right"><span>$\lambda_{vap}$</span></td><td style="text-align: right">2.501 × 10⁶</td><td style="text-align: right">J/kg</td></tr><tr><td style="text-align: right">Latent heat of fusion</td><td style="text-align: right"><span>$L_f$</span></td><td style="text-align: right">3.337 × 10⁵</td><td style="text-align: right">J/kg</td></tr><tr><td style="text-align: right">Latent heat of sublimation</td><td style="text-align: right"><span>$\lambda_{sub}$</span></td><td style="text-align: right"><span>$\lambda_{vap} + L_f$</span></td><td style="text-align: right">J/kg</td></tr><tr><td style="text-align: right">Thermal conductivity of water</td><td style="text-align: right"><span>$\lambda_{liq}$</span></td><td style="text-align: right">0.6</td><td style="text-align: right">W/(m·K)</td></tr><tr><td style="text-align: right">Thermal conductivity of ice</td><td style="text-align: right"><span>$\lambda_{ice}$</span></td><td style="text-align: right">2.29</td><td style="text-align: right">W/(m·K)</td></tr><tr><td style="text-align: right">Thermal conductivity of air</td><td style="text-align: right"><span>$\lambda_{air}$</span></td><td style="text-align: right">0.023</td><td style="text-align: right">W/(m·K)</td></tr><tr><td style="text-align: right">Radius of the earth</td><td style="text-align: right"><span>$R_e$</span></td><td style="text-align: right">6.37122 × 10⁶</td><td style="text-align: right">m</td></tr></table><h2 id="Analysis"><a class="docs-heading-anchor" href="#Analysis">Analysis</a><a id="Analysis-1"></a><a class="docs-heading-anchor-permalink" href="#Analysis" title="Permalink"></a></h2><h3 id="Air-Density-vs.-Temperature"><a class="docs-heading-anchor" href="#Air-Density-vs.-Temperature">Air Density vs. Temperature</a><a id="Air-Density-vs.-Temperature-1"></a><a class="docs-heading-anchor-permalink" href="#Air-Density-vs.-Temperature" title="Permalink"></a></h3><p>The air density equation from Chapter 1 (p. 17) computes atmospheric density as a function of pressure, temperature, and vapor pressure. For dry air, this reduces to the ideal gas law: <span>$\rho = P / (R_{da} T)$</span>. The following figure shows how air density varies with temperature at standard pressure for both dry and moist air.</p><pre><code class="language-julia hljs">using OrdinaryDiffEqDefault
using Plots

compiled = mtkcompile(sys)

T_range = 250.0:5.0:320.0
ρ_dry = Float64[]
ρ_moist = Float64[]

for T_val in T_range
    prob = ODEProblem(
        compiled,
        Dict(
            compiled.q_atm =&gt; 0.0,
            compiled.P_atm =&gt; 101325.0,
            compiled.T_atm =&gt; T_val,
            compiled.z_prime_atm =&gt; 30.0,
            compiled.z_0 =&gt; 1.0,
            compiled.z_d =&gt; 5.0,
        ),
        (0.0, 1.0),
    )
    sol = solve(prob)
    push!(ρ_dry, sol[compiled.ρ_atm][end])

    prob_m = ODEProblem(
        compiled,
        Dict(
            compiled.q_atm =&gt; 0.015,
            compiled.P_atm =&gt; 101325.0,
            compiled.T_atm =&gt; T_val,
            compiled.z_prime_atm =&gt; 30.0,
            compiled.z_0 =&gt; 1.0,
            compiled.z_d =&gt; 5.0,
        ),
        (0.0, 1.0),
    )
    sol_m = solve(prob_m)
    push!(ρ_moist, sol_m[compiled.ρ_atm][end])
end

p = plot(T_range, ρ_dry, label=&quot;Dry air (q=0)&quot;, xlabel=&quot;Temperature (K)&quot;,
    ylabel=&quot;Air density (kg/m³)&quot;, title=&quot;Air Density vs Temperature at P=101325 Pa&quot;,
    linewidth=2, legend=:topright)
plot!(p, T_range, ρ_moist, label=&quot;Moist air (q=0.015 kg/kg)&quot;, linewidth=2, linestyle=:dash)
p</code></pre><img src="9692a5f2.svg" alt="Example block output"/><p>At all temperatures, moist air is less dense than dry air at the same pressure, consistent with the lower molecular weight of water vapor (18.016 kg/kmol) compared to dry air (28.966 kg/kmol).</p><h3 id="Vapor-Pressure-vs.-Specific-Humidity"><a class="docs-heading-anchor" href="#Vapor-Pressure-vs.-Specific-Humidity">Vapor Pressure vs. Specific Humidity</a><a id="Vapor-Pressure-vs.-Specific-Humidity-1"></a><a class="docs-heading-anchor-permalink" href="#Vapor-Pressure-vs.-Specific-Humidity" title="Permalink"></a></h3><p>The vapor pressure equation relates the atmospheric vapor pressure to specific humidity and total pressure. This relationship is approximately linear for small specific humidities but becomes nonlinear at higher moisture content.</p><pre><code class="language-julia hljs">q_range = 0.0:0.001:0.03
e_vals = Float64[]

for q_val in q_range
    prob = ODEProblem(
        compiled,
        Dict(
            compiled.q_atm =&gt; q_val,
            compiled.P_atm =&gt; 101325.0,
            compiled.T_atm =&gt; 293.15,
            compiled.z_prime_atm =&gt; 30.0,
            compiled.z_0 =&gt; 1.0,
            compiled.z_d =&gt; 5.0,
        ),
        (0.0, 1.0),
    )
    sol = solve(prob)
    push!(e_vals, sol[compiled.e_atm][end])
end

p = plot(q_range .* 1000, e_vals, xlabel=&quot;Specific humidity (g/kg)&quot;,
    ylabel=&quot;Vapor pressure (Pa)&quot;,
    title=&quot;Atmospheric Vapor Pressure vs Specific Humidity\nat P=101325 Pa&quot;,
    linewidth=2, legend=false)
p</code></pre><img src="d04503d8.svg" alt="Example block output"/></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../albedos_radiative_fluxes/">Albedos and Radiative Fluxes »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Saturday 7 February 2026 05:22">Saturday 7 February 2026</span>. Using Julia version 1.12.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
